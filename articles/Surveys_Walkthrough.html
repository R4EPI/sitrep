<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>{sitrep} surveys template vignette • sitrep</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="{sitrep} surveys template vignette">
<meta property="og:description" content="sitrep">
<meta property="og:image" content="https://r4epi.github.io/sitrep/logo.png">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--><!-- Global site tag (gtag.js) - Google Analytics --><script async src="https://www.googletagmanager.com/gtag/js?id=UA-149766533-1"></script><script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-149766533-1');
</script>
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">sitrep</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.2.3</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="https://r4epis.netlify.com" class="external-link">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/Background.html">Origin Story</a>
    </li>
    <li>
      <a href="../articles/Outbreaks_Walkthrough.html">{sitrep} outbreaks template vignette</a>
    </li>
    <li>
      <a href="../articles/Surveys_Walkthrough.html">{sitrep} surveys template vignette</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/R4EPI/sitrep" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="Surveys_Walkthrough_files/accessible-code-block-0.0.1/empty-anchor.js"></script><script src="Surveys_Walkthrough_files/htmlwidgets-1.5.4/htmlwidgets.js"></script><link href="Surveys_Walkthrough_files/datatables-css-0.0.0/datatables-crosstalk.css" rel="stylesheet">
<script src="Surveys_Walkthrough_files/datatables-binding-0.25/datatables.js"></script><link href="Surveys_Walkthrough_files/dt-core-1.11.3/css/jquery.dataTables.min.css" rel="stylesheet">
<link href="Surveys_Walkthrough_files/dt-core-1.11.3/css/jquery.dataTables.extra.css" rel="stylesheet">
<script src="Surveys_Walkthrough_files/dt-core-1.11.3/js/jquery.dataTables.min.js"></script><link href="Surveys_Walkthrough_files/nouislider-7.0.10/jquery.nouislider.min.css" rel="stylesheet">
<script src="Surveys_Walkthrough_files/nouislider-7.0.10/jquery.nouislider.min.js"></script><link href="Surveys_Walkthrough_files/selectize-0.12.0/selectize.bootstrap3.css" rel="stylesheet">
<script src="Surveys_Walkthrough_files/selectize-0.12.0/selectize.min.js"></script><link href="Surveys_Walkthrough_files/crosstalk-1.2.0/css/crosstalk.min.css" rel="stylesheet">
<script src="Surveys_Walkthrough_files/crosstalk-1.2.0/js/crosstalk.min.js"></script><link href="Surveys_Walkthrough_files/tabwid-1.1.0/tabwid.css" rel="stylesheet">
<link href="Surveys_Walkthrough_files/tabwid-1.1.0/scrool.css" rel="stylesheet">
<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>{sitrep} surveys template vignette</h1>
            <h3 data-toc-skip class="subtitle">A guided example of how to use the R Markdown template to analyse a stratified cluster survey</h3>
            
      
      <small class="dont-index">Source: <a href="https://github.com/R4EPI/sitrep/blob/HEAD/vignettes/Surveys_Walkthrough.Rmd" class="external-link"><code>vignettes/Surveys_Walkthrough.Rmd</code></a></small>
      <div class="hidden name"><code>Surveys_Walkthrough.Rmd</code></div>

    </div>

    
    
<div class="section level2">
<h2 id="overview">Overview<a class="anchor" aria-label="anchor" href="#overview"></a>
</h2>
<p>This page demonstrate use of the {sitrep} R Markdown template for analysis of a retrospective mortality survey, using data that was produced using Kobo, a common survey and data collection tool in settings where MSF works. The data do not use the standard MSF EBB-approved data dictionary, and therefore represent a challenging use case for data cleaning.</p>
</div>
<div class="section level2">
<h2 id="getting-started">Getting started<a class="anchor" aria-label="anchor" href="#getting-started"></a>
</h2>
<div class="section level3">
<h3 id="software-installations">Software installations<a class="anchor" aria-label="anchor" href="#software-installations"></a>
</h3>
<p>To begin using R, ensure you have the following free software installed:</p>
<ol style="list-style-type: decimal">
<li>
<a href="https://cran.r-project.org/bin/windows/base/" class="external-link">R</a> (the free statistical software)</li>
<li>
<a href="https://www.rstudio.com/products/rstudio/download/#download" class="external-link">RStudio</a> (the free user interface)</li>
<li>
<a href="https://cran.r-project.org/bin/windows/Rtools/" class="external-link">RTools</a> (only needed for Windows computers)</li>
</ol>
<p>If you are a new R user, we highly suggest doing the following before beginning to use these templates:</p>
<ol style="list-style-type: decimal">
<li>Complete our 5 free online introductory <a href="www.appliedepi.org/tutorial">R tutorials</a>. To begin, create your free Applied Epi account, as explained in the linked page</li>
<li>Review the <a href="https://epirhandbook.com/en/r-basics.html#r-basics" class="external-link">R basics chapter</a> of our Epidemiologist R Handbook</li>
<li>Review the <a href="https://epirhandbook.com/en/reports-with-r-markdown.html" class="external-link">Reports with R Markdown chapter</a> of the Epidemiologist R Handbook</li>
</ol>
<p>Once you have an understanding of how R and RStudio work, know how to run basic commands, have practiced running R code on your computer, and have read about R Markdown reports, then you are ready to use our {sitrep} R Markdown templates to produce situation reports.</p>
</div>
<div class="section level3">
<h3 id="install-the-sitrep-r-package">Install the {sitrep} R package<a class="anchor" aria-label="anchor" href="#install-the-sitrep-r-package"></a>
</h3>
<p>To access the templates, you must install the “sitrep” R package. R packages are often written in text with curly brackets, like this: {sitrep}</p>
<ol style="list-style-type: decimal">
<li>Open RStudio</li>
<li>Run the following command in the R Console pane:</li>
</ol>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># install the {remotes} package, which is used to install the {sitrep} package</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html" class="external-link">install.packages</a></span><span class="op">(</span><span class="st">"remotes"</span><span class="op">)</span></span></code></pre></div>
<ol start="3" style="list-style-type: decimal">
<li>Now run this command, also in the R Console pane. The {sitrep} package is currently available from a location on Github, a site to store and share code.</li>
</ol>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># use {remotes} to install {sitrep} from Github</span></span>
<span><span class="fu">remotes</span><span class="fu">::</span><span class="fu"><a href="https://remotes.r-lib.org/reference/install_github.html" class="external-link">install_github</a></span><span class="op">(</span><span class="st">"R4EPI/sitrep"</span>, dependencies <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="open-a-new-rstudio-project">Open a new RStudio project<a class="anchor" aria-label="anchor" href="#open-a-new-rstudio-project"></a>
</h3>
<p>Working in R is best done from within an “RStudio project” that contains all the datasets, R scripts, and outputs for a single analytical project.</p>
<p>You should review the Epidemiologist R Handbook chapters on <a href="https://epirhandbook.com/en/r-projects.html" class="external-link">RStudio projects</a>. Below are brief instructions on how to create a new RStudio project:</p>
<blockquote>
<p>Select <em>File -&gt; New Project</em> from the top RStudio menu.</p>
</blockquote>
<blockquote>
<p>Creating a new RStudio project will create:</p>
</blockquote>
<blockquote>
<ul>
<li>A new project directory (folder)<br>
</li>
<li>A R project file (.Rproj) in the project folder that serves as a shortcut to open the project via RStudio</li>
</ul>
</blockquote>
<blockquote>
<p>Note:</p>
</blockquote>
<blockquote>
<ul>
<li>You can make sub-folders for data, scripts, etc.<br>
</li>
<li>All files produced by R scripts saved to the project will also save into the project folder<br>
</li>
<li>Navigate and open project files, such as scripts, using the Files tab of the lower-right RStudio pane.<br>
*For an RMarkdown to produce the final report correctly, you must have read/write permissions for the location of the R project folder. On an MSF computer this is generally the c:/temp folder.</li>
</ul>
</blockquote>
<p>One significant benefit of working within an R project is that all associated files (datasets, etc.) are located within the same folder. Thus, to send the project to someone else, <strong>simply zip the folder and send</strong>. All files referenced in the scripts are included and if you utilized the {here} package, no file paths are unique to your computer.</p>
</div>
</div>
<div class="section level2">
<h2 id="open-a-sitrep-r-markdown-template">Open a {sitrep} R Markdown template<a class="anchor" aria-label="anchor" href="#open-a-sitrep-r-markdown-template"></a>
</h2>
<p>For this vignette, you will need to open the template “Mortality survey”. See the instructions and GIF below.</p>
<div class="section level3">
<h3 id="opening-a-template">Opening a template<a class="anchor" aria-label="anchor" href="#opening-a-template"></a>
</h3>
<ol style="list-style-type: decimal">
<li>Ensure you have installed the {sitrep} package as detailed above<br>
</li>
<li>Go to the File menu, select “New File”, and select “R Markdown”<br>
</li>
<li>In the pop-up window, select “From template”</li>
<li>From the list of templates, select “AJS Outbreak Report” - the template will open in RStudio<br>
</li>
<li>Go to File, “Save”, and write a name for this R Markdown script; save it into your RStudio Project folder</li>
</ol>
<p><img src="images/opening_template.gif" width="549" alt="This above GIF shows how to open one of the templates, after having installed the {sitrep} R package"> ### Folder structure</p>
<p>It is highly recommended that you store your R Markdown script and any data used in the same folder (the RStudio project). You should review the Epidemiologist R Handbook chapters on <a href="https://epirhandbook.com/en/r-projects.html" class="external-link">RStudio projects</a>.</p>
</div>
</div>
<div class="section level2">
<h2 id="basic-concepts-of-survey-data-analysis">Basic concepts of survey data analysis<a class="anchor" aria-label="anchor" href="#basic-concepts-of-survey-data-analysis"></a>
</h2>
<div class="section level3">
<h3 id="other-resources">Other resources<a class="anchor" aria-label="anchor" href="#other-resources"></a>
</h3>
<p>This website will not cover the detailed aspects of designing, implementing and analysing a survey in MSF contexts. There are many other training and briefing materials that address this aspect. We will cover a few crucial concepts which are required for the understanding and use of the templates for your survey analysis.</p>
<p>For further survey methodology resources please see:</p>
<ul>
<li><a href="https://fieldresearch.msf.org/" class="external-link">MSF Field Research site</a></li>
<li>
<a href="https://smartmethodology.org/about-smart/?doing_wp_cron=1569090491.1568140983581542968750" class="external-link">SMART Methodology</a> (Standardized Monitoring and Assessment of Relief and Transitions)</li>
<li>This site on <a href="http://conflict.lshtm.ac.uk/page_02.htm" class="external-link">the use of epidemiological tools in conflict-affected populations</a> from the London School of Hygiene and Tropical Medicine (LSHTM).</li>
</ul>
</div>
<div class="section level3">
<h3 id="sampling-strategy">Sampling strategy<a class="anchor" aria-label="anchor" href="#sampling-strategy"></a>
</h3>
<p>There are different ways to sample populations for surveys. The most commonly used in MSF settings are:</p>
<ol style="list-style-type: decimal">
<li>
<strong>Simple random sampling (SRS)</strong>: requires a comprehensive sampling frame (i.e. total list of households inside a refugee camp or GPS based sampling in a known area).</li>
<li>
<strong>Cluster based sampling</strong>: most commonly used in combination with sampling villages proportional to population size.</li>
<li>
<strong>Stratified samples</strong>: uses either SRS or cluster based sampling but in two different administrative areas in order to obtain precise prevalence estimates for them.</li>
</ol>
<p>The templates can accommodate analysis of data from all of these sampling designs.</p>
</div>
<div class="section level3">
<h3 id="sample-size">Sample size<a class="anchor" aria-label="anchor" href="#sample-size"></a>
</h3>
<p>Before implementing a survey you will need to calculate the sample size for that survey. Note that a chapter on samples size is anticipated to be in the <a href="www.epiRhandbook.com">Epidemiologist R Handbook</a> soon.</p>
<p>When calculating a sample size for your survey you take the below parameters into consideration:</p>
<ul>
<li><strong>Estimate of prevalence</strong></li>
<li><strong>Design effect or intraclass coefficient</strong></li>
<li><strong>Precision required around your estimate of prevalence</strong></li>
</ul>
</div>
<div class="section level3">
<h3 id="estimate-of-prevalence">Estimate of prevalence<a class="anchor" aria-label="anchor" href="#estimate-of-prevalence"></a>
</h3>
<p>You will need to use an estimate of the prevalence/coverage of the your main outcome of interest in your to-be-surveyed population (prevalence of malnutrition, measles vaccination coverage, etc.). You will use published or grey literature to determine a logical estimate of this parameter.</p>
<p>The largest sample size you will need will be that which is calculated using an estimate of prevalence of 50%. The closer to 0% or 100% prevalence you set your estimate, the smaller your sample size will be. Therefore, if you have no idea what your estimate of prevalence is, try and use 50% and the largest possible sample size.</p>
</div>
<div class="section level3">
<h3 id="design-effect">Design effect<a class="anchor" aria-label="anchor" href="#design-effect"></a>
</h3>
<p>The easiest way to remember the design effect (which we usually refer to as DEFF), is that it is a measure of the variability of the outcome of interest within your clusters (if you are conducting a cluster based survey) and between your clusters.</p>
<p>The higher the DEFF, the higher the variability between clusters and the higher the probability that subjects within a cluster are similar.</p>
<p>In a well designed survey, you will aim to have a calculated DEFF for your outcome of interest as close as possible to 1. This is because a DEFF of 1 means that your survey design has approached Simple Random Sampling (SRS) for your outcome of interest. SRS is the gold standard in survey design, but often not possible in MSF contexts. In general, in two-stage cluster sampling surveys, we would assume a DEFF of 2.</p>
<p>Mathematically DEFF is calculated as:</p>
<blockquote>
<p><strong>DEFF=1+(1-n) * rho</strong> where n=sample size of your survey and rho=intraclass coefficient</p>
</blockquote>
<p>When analysing your survey data, we often recalculate the DEFF for the main outcomes of interest. This because the DEFF will give you a good estimate on whether the survey design and sampling approach made sense in your survey for your outcome of interest.</p>
</div>
<div class="section level3">
<h3 id="precision-around-your-estimate">Precision around your estimate<a class="anchor" aria-label="anchor" href="#precision-around-your-estimate"></a>
</h3>
<p>The precision around your estimate stipulates how close to the your estimate you would like the 95% confidence interval of your prevalence estimate to fall.</p>
<blockquote>
<p><strong>For example</strong>: you have calculated a 72% measles vaccination coverage in your study population. You would like to ensure that the 95% confidence interval is narrow (between 70-74%); thus you would set your precision at 2% (2% above and below 72%).</p>
</blockquote>
<p>The lower your precision, the higher your sample size calculation will be.</p>
<p>You only use the estimate of the precision when calculating a sample size before your survey.</p>
</div>
<div class="section level3">
<h3 id="data-collection-and-databases">Data collection and databases<a class="anchor" aria-label="anchor" href="#data-collection-and-databases"></a>
</h3>
<p>The templates assume that data will have been collected using mobile data collection or will have been entered into an electronic database (Excel, Epi Data, Redcap etc.).</p>
<p>We recommend that you try and establish generic data dictionaries for mobile data collection (through template questionnaires) or through template databases. This will improve the consistency of the naming of your variables and will facilitate the frequent and systematic use of the Survey Templates.</p>
</div>
<div class="section level3">
<h3 id="overview-of-survey-template-parts">Overview of survey template parts<a class="anchor" aria-label="anchor" href="#overview-of-survey-template-parts"></a>
</h3>
<p>We have designed the templates to run through a similar series of analytical questions in the same order:</p>
<ol style="list-style-type: decimal">
<li>
<strong>Description of your survey</strong> sample and population in that survey sample</li>
<li>
<strong>Comparison of your survey sample</strong> to the population breakdown of that area (this will help you understand how biased your data is)</li>
<li>
<strong>Calculation of the main outcomes of interest</strong> (including DEFF):</li>
</ol>
<ul>
<li>Mortality survey template: crude mortality rate (CMR) and under 5 year mortality rate (U5MR)</li>
<li>Vaccination coverage: vaccination coverage of vaccines of interest</li>
<li>Malnutrition: prevalence of malnutrition in target population through MUAC and Weight for Height Scores<br>
</li>
</ul>
<ol start="4" style="list-style-type: decimal">
<li>Calculation of <strong>secondary outcomes of interest</strong>
</li>
</ol>
<p>The sampling strategy <strong>MUST</strong> be considered by the epidemiologist using the templates in order to ensure an appropriate weighting is applied to the analysis.</p>
</div>
</div>
<div class="section level2">
<h2 id="become-familiar-with-the-r-markdown-template">Become familiar with the R Markdown template<a class="anchor" aria-label="anchor" href="#become-familiar-with-the-r-markdown-template"></a>
</h2>
<div class="section level3">
<h3 id="header">Header<a class="anchor" aria-label="anchor" href="#header"></a>
</h3>
<p>The very top of the R Markdown template consists of a header surrounded by <code>---</code> lines. This is called the “YAML” header, in which you can edit the title of your document. The other settings in the header define the default document type produced (Microsoft Word) when the RMarkdown is “knit”.</p>
<p><img src="images/mort_header.png"></p>
</div>
<div class="section level3">
<h3 id="introduction-to-the-template">Introduction to the template<a class="anchor" aria-label="anchor" href="#introduction-to-the-template"></a>
</h3>
<p>This text just below the header is for your reference only. If left alone it will appear at the beginning of your report, so you should replace it with a more relevant introduction. Any text you write here can be formatted with <em>italics</em>, <strong>bold</strong>, bullets, numbers, tables, and in-line code. See this <a href="/images/rmarkdown_cheatsheet_2.0.pdf">RMarkdown cheatsheet</a> for tips on formatting.</p>
</div>
<div class="section level3">
<h3 id="explanatory-text">Explanatory text<a class="anchor" aria-label="anchor" href="#explanatory-text"></a>
</h3>
<p>Green text located between these special characters (<code>&lt;!--</code> and <code>--&gt;</code>), is for your information only. This text will <strong>not</strong> appear in the final Word document report.</p>
</div>
</div>
<div class="section level2">
<h2 id="installing-and-loading-packages">Installing and loading packages<a class="anchor" aria-label="anchor" href="#installing-and-loading-packages"></a>
</h2>
<p><strong>The first code chunk, <code>setup</code>, is very important and must be kept.</strong> When the final report is knit, this chunk will run without producing any output, but it is required for the template to work correctly.</p>
<p>This <code>setup</code> code chunk does the following:</p>
<ul>
<li><p>Set default settings for tables such as size, error handling, and display of missing values</p></li>
<li><p>Run a command using the {pacman} package to install and load the R packages that are used in this template.</p></li>
<li><p>Set default text size in graphic plots</p></li>
<li><p>Establish visual theme settings for epidemic curve plots</p></li>
</ul>
<div class="section level3">
<h3 id="about-the-packages-used-in-this-template">About the packages used in this template<a class="anchor" aria-label="anchor" href="#about-the-packages-used-in-this-template"></a>
</h3>
<div class="section level4">
<h4 id="generic-packages">Generic packages<a class="anchor" aria-label="anchor" href="#generic-packages"></a>
</h4>
<table class="table">
<colgroup>
<col width="20%">
<col width="79%">
</colgroup>
<thead><tr class="header">
<th>R package</th>
<th>Use</th>
</tr></thead>
<tbody>
<tr class="odd">
<td>{knitr}</td>
<td>to create the output document (pdf, doc, html)</td>
</tr>
<tr class="even">
<td>{here}</td>
<td>to locate files within the RStudio project</td>
</tr>
<tr class="odd">
<td>{rio}</td>
<td>to import data from various formats (csv, xlsx, tsv, etc.)</td>
</tr>
<tr class="even">
<td>{janitor}</td>
<td>to clean and summarise data</td>
</tr>
<tr class="odd">
<td>{dplyr}</td>
<td>to clean and handle data</td>
</tr>
<tr class="even">
<td>{tidyr}</td>
<td>to handle and clean data</td>
</tr>
<tr class="odd">
<td>{forcats}</td>
<td>to clean the data and create ordinal columns (“factors”)</td>
</tr>
<tr class="even">
<td>{stringr}</td>
<td>to clean and handle text/characters (known as “strings”)</td>
</tr>
<tr class="odd">
<td>{ggplot2}</td>
<td>to visualise your data in plots</td>
</tr>
<tr class="even">
<td>{lubridate}</td>
<td>to handle dates and times</td>
</tr>
<tr class="odd">
<td>{gtsummary}</td>
<td>to produce summary tables</td>
</tr>
<tr class="even">
<td>{flextable}</td>
<td>to format summary tables for presentation</td>
</tr>
<tr class="odd">
<td>{purrr}</td>
<td>to iterate processes - repeating the same process many times with small variations</td>
</tr>
</tbody>
</table>
</div>
<div class="section level4">
<h4 id="more-epidemiology--and-survey-specific-packages">More epidemiology- and survey-specific packages<a class="anchor" aria-label="anchor" href="#more-epidemiology--and-survey-specific-packages"></a>
</h4>
<table class="table">
<colgroup>
<col width="25%">
<col width="74%">
</colgroup>
<thead><tr class="header">
<th>R package</th>
<th>Use</th>
</tr></thead>
<tbody>
<tr class="odd">
<td>{sitrep}</td>
<td>includes the templates and functions useful for field epidemiology</td>
</tr>
<tr class="even">
<td>{ggalluvial}</td>
<td>to make alluvial flow diagrams/plots</td>
</tr>
<tr class="odd">
<td>{apyramid}</td>
<td>to make demographic pyramid plots</td>
</tr>
<tr class="even">
<td>{parsedate}</td>
<td>to interpret “messy” date formats</td>
</tr>
<tr class="odd">
<td>{survey}</td>
<td>to provide survey analysis functions</td>
</tr>
<tr class="even">
<td>{srvyr}</td>
<td>to make the {survey} package easier to use</td>
</tr>
<tr class="odd">
<td>{matchmaker}</td>
<td>to clean data using data dictionaries</td>
</tr>
<tr class="even">
<td>{labelled}</td>
<td>to add labels to columns</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Install and load required packages for this template</span></span>
<span><span class="fu">pacman</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/pacman/man/p_load.html" class="external-link">p_load</a></span><span class="op">(</span></span>
<span>  <span class="va">knitr</span>,       <span class="co"># create output docs</span></span>
<span>  <span class="va">here</span>,        <span class="co"># find your files</span></span>
<span>  <span class="va">rio</span>,         <span class="co"># for importing data</span></span>
<span>  <span class="va">janitor</span>,     <span class="co"># clean/shape data</span></span>
<span>  <span class="va">dplyr</span>,       <span class="co"># clean/shape data</span></span>
<span>  <span class="va">tidyr</span>,       <span class="co"># clean/shape data</span></span>
<span>  <span class="va">forcats</span>,     <span class="co"># manipulate and rearrange factors</span></span>
<span>  <span class="va">stringr</span>,     <span class="co"># manipulate texts</span></span>
<span>  <span class="va">ggplot2</span>,     <span class="co"># create plots and charts</span></span>
<span>  <span class="va">ggalluvial</span>,  <span class="co"># for visualising population flows</span></span>
<span>  <span class="va">apyramid</span>,    <span class="co"># plotting age pyramids</span></span>
<span>  <span class="va">sitrep</span>,      <span class="co"># MSF field epi functions</span></span>
<span>  <span class="va">survey</span>,      <span class="co"># for survey functions</span></span>
<span>  <span class="va">srvyr</span>,       <span class="co"># dplyr wrapper for survey package</span></span>
<span>  <span class="va">gtsummary</span>,   <span class="co"># produce tables</span></span>
<span>  <span class="va">flextable</span>,   <span class="co"># for styling output tables</span></span>
<span>  <span class="va">labelled</span>,    <span class="co"># add labels to variables</span></span>
<span>  <span class="va">matchmaker</span>,  <span class="co"># recode datasets with dictionaries</span></span>
<span>  <span class="va">lubridate</span>,   <span class="co"># working with dates</span></span>
<span>  <span class="va">parsedate</span>,   <span class="co"># guessing dates</span></span>
<span>  <span class="va">DT</span>           <span class="co"># interactive tables for this walkthrough</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
</div>
</div>
</div>
<div class="section level2">
<h2 id="survey-data">Survey data<a class="anchor" aria-label="anchor" href="#survey-data"></a>
</h2>
<p>Data used for this template should be in a “linelist” format, with one row for each survey respondent person. You have two options:</p>
<ul>
<li><p>Use data collected with Kobo</p></li>
<li><p>Use data that was not collected with Kobo</p></li>
</ul>
<p>Each of these options will result in the use of different code chunks in the template. <strong>This vignette uses data collected with Kobo</strong>.</p>
<p>You can deactivate (place a # comment symbol to the left of) or delete the code in the code chunk <code>read_fake_data</code>, which is used to generate fake data for the template.</p>
<div class="section level3">
<h3 id="download-data-used-in-this-vignette">Download data used in this vignette<a class="anchor" aria-label="anchor" href="#download-data-used-in-this-vignette"></a>
</h3>
<p><strong>This vignette will demonstrate using <em>data collected with Kobo</em></strong>.</p>
<div class="section level4">
<h4 id="access-the-survey-responses">Access the survey responses<a class="anchor" aria-label="anchor" href="#access-the-survey-responses"></a>
</h4>
<p>For this vignette, the household-level information and the individual-level information are stored in an .xslx spreadsheet with two sheets. The spreadsheet is named “mortality_survey_data.xlsx”, and is stored in the {sitrep} R package. We created the function <code><a href="../reference/download_survey.html">download_survey()</a></code> which will copy this file into a location of your choice on your computer.</p>
<p>Run the commands below. Now look for a pop-up window and use it to select your RStudio project folder (the pop-up may appear <em>behind</em> RStudio out-of-sight).</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># load the sitrep package</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/R4EPI/sitrep" class="external-link">sitrep</a></span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># run the command below as it is (empty parentheses).</span></span>
<span><span class="co"># Look for a pop-up window, and select your RStudio project as the destination</span></span>
<span><span class="fu"><a href="../reference/download_survey.html">download_survey</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p>Now that the data are saved in your RStudio project, you can import them into R using <code>import()</code>, as described in the Epidemiologist R Handbook’s <a href="https://epirhandbook.com/en/import-and-export.html" class="external-link">Import and export</a> chapter.</p>
<p>To import a specific sheet from an xlsx spreadsheet, use the <code>which =</code> argument as shown below. You can also use the <code>na =</code> argument to specify a value that should be converted to <code>NA</code> across the entire sheet (e.g. 99 or “Missing”, or "" which represents an empty space).</p>
<p>Th example command below imports an Excel spreadsheet called “mortality_survey_data.xlsx”, which is not password protected, and is stored in the RStudio project you are using for this analysis. The <code>which =</code> argument of <code>import()</code> specifies that the sheet “Mortality Survey” should be imported. You would edit this command as appropriate for your situation.</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1"></a><span class="co"># example code for importing an Excel file saved in RStudio project</span></span>
<span id="cb6-2"><a href="#cb6-2"></a></span>
<span id="cb6-3"><a href="#cb6-3"></a><span class="co"># Import the sheet containing household responses</span></span>
<span id="cb6-4"><a href="#cb6-4"></a>survey_data_hh &lt;-<span class="st"> </span><span class="kw">import</span>(<span class="st">"mortality_survey_data.xlsx"</span>), which =<span class="st"> "Mortality Survey"</span>, na =<span class="st"> ""</span><span class="er">)</span></span>
<span id="cb6-5"><a href="#cb6-5"></a></span>
<span id="cb6-6"><a href="#cb6-6"></a><span class="co"># import the sheet containing individual responses</span></span>
<span id="cb6-7"><a href="#cb6-7"></a>survey_data_ind &lt;-<span class="st"> </span><span class="kw">import</span>(<span class="st">"mortality_survey_data.xlsx"</span>), which =<span class="st"> "hh_member"</span>, na =<span class="st"> ""</span><span class="er">)</span></span></code></pre></div>
<p>Here is a preview of the first 25 entries with household information:</p>
<div id="htmlwidget-cdae1fcf7b1ede9bbecc" style="width:100%;height:auto;" class="datatables html-widget"></div>
<script type="application/json" data-for="htmlwidget-cdae1fcf7b1ede9bbecc">{"x":{"filter":"top","vertical":false,"filterHTML":"<tr>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\" disabled=\"\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\" disabled=\"\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\" disabled=\"\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\" disabled=\"\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"logical\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\" disabled=\"\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"width: 100%; display: none;\">\n      <select multiple=\"multiple\" style=\"width: 100%;\" data-options=\"[&quot;true&quot;,&quot;false&quot;,&quot;na&quot;]\"><\/select>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n<\/tr>","data":[["2021-07-18T11:57:58.968+03:00","2021-07-24T09:36:47.779+03:00","2021-07-18T10:57:37.964+03:00","2021-07-12T14:42:29.643+02:00","2021-07-24T11:45:02.845+03:00","2021-07-24T13:41:42.161+03:00","2021-07-24T14:50:23.941+03:00","2021-07-24T12:01:55.021+03:00","2021-07-18T10:00:39.598+03:00","2021-07-23T11:08:44.129+03:00","2021-07-23T13:59:00.499+03:00","2021-07-24T11:49:25.683+03:00","2021-07-17T16:30:12.642+03:00","2021-07-23T16:36:41.365+03:00","2021-07-12T11:07:53.683+02:00","2021-07-24T09:17:26.406+03:00","2021-07-24T11:42:40.080+03:00","2021-07-23T15:05:50.656+03:00","2021-07-18T14:30:33.762+03:00","2021-07-24T09:42:11.463+03:00","2021-07-24T11:46:46.938+03:00","2021-07-24T12:01:50.819+03:00","2021-07-23T16:47:31.823+03:00","2021-07-24T12:15:16.641+03:00","2021-07-23T14:44:33.294+03:00"],["2021-07-24T09:26:56.432+03:00","2021-07-12T15:11:37.180+02:00","2021-07-22T22:05:58.557+03:00","2021-07-18T15:51:07.752+03:00","2021-07-23T14:03:25.497+03:00","2021-07-18T12:14:09.367+03:00","2021-07-14T14:53:37.129+02:00","2021-07-12T15:06:51.663+02:00","2021-07-23T12:39:46.749+03:00","2021-07-17T16:14:57.525+03:00","2021-07-24T10:45:56.521+03:00","2021-07-23T15:22:16.008+03:00","2021-07-24T11:17:38.835+03:00","2021-07-23T11:32:25.425+03:00","2021-07-18T10:00:28.233+03:00","2021-07-23T00:44:02.260+03:00","2021-07-23T14:49:26.958+03:00","2021-07-24T14:35:25.668+03:00","2021-07-24T11:23:45.490+03:00","2021-07-15T10:10:18.625+02:00","2021-07-24T14:55:39.856+03:00","2021-07-24T12:31:11.353+03:00","2021-07-24T11:42:02.832+03:00","2021-07-23T16:25:38.625+03:00","2021-07-23T15:00:14.942+03:00"],["2021-07-12","2021-07-14","2021-07-14","2021-07-12","2021-07-13","2021-07-17","2021-07-12","2021-07-18","2021-07-14","2021-07-18","2021-07-17","2021-07-11","2021-07-10","2021-07-18","2021-07-12","2021-07-10","2021-07-10","2021-07-11","2021-07-10","2021-07-14","2021-07-13","2021-07-18","2021-07-18","2021-07-14","2021-07-11"],["Town A","Town A","Town A","Town A","Town A","Town A","Town A","Town A","Town A","Town A","Town A","Town A","Town A","Town A","Town A","Town A","Town A","Town A","Town A","Town A","Town A","Town A","Town A","Town A","Town A"],["1","1","1","1","1","1","1","1","1","1","1","1","1","1","2","2","2","2","2","2","2","2","2","2","2"],["1","2","3","4","5","6","7","8","9","10","11","12","13","14","1","2","3","4","5","6","7","8","9","10","11"],["Yes","Yes","Yes","Yes","Yes","Yes","Yes","Yes","Yes","Yes","Yes","Yes","Yes","Yes","Yes","Yes","Yes","Yes","Yes","Yes","Yes","Yes","Yes","Yes","Yes"],["Yes","Yes","Yes","Yes","Yes","Yes","Yes","Yes","Yes","Yes","Yes","Yes","Yes","Yes","Yes","Yes","Yes","Yes","Yes","Yes","Yes","Yes","Yes","Yes","Yes"],[null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null],["City water network piped to household","City water network piped to household","City water network piped to household","City water network piped to household","City water network piped to household","City water network piped to household","Tank filled by a truck transporting untreated water","City water network piped to household","City water network piped to household","City water network piped to household","City water network piped to household","City water network piped to household","City water network piped to household","City water network piped to household","Other (specify)","City water network piped to household","City water network piped to household","City water network piped to household","City water network piped to household","City water network piped to household","City water network piped to household","City water network piped to household","City water network piped to household","City water network piped to household","City water network piped to household"],[null,null,null,null,null,null,null,null,null,null,null,null,null,null,"Buying purified water",null,null,null,null,null,null,null,null,null,null],["6","9","9","7","2","3","4","13","8","7","6","10","9","5","6","13","4","6","8","7","6","10","6","6","8"],["500001","500002","500003","500004","500005","500006","500007","500008","500009","500010","500011","500012","500013","500014","500015","500016","500017","500018","500019","500020","500021","500022","500023","500024","500025"],["cf874aad79e14b401a4c86954a596fa5","e8647dce263d505d7b0d605a5d6c2d1b","28102e526765b0ac82736c2c205b94ab","ad702a3ec1e6317dfdc06ececcc03d2e","0392818b32472a09b84f2b13908c1243","576226389b62628b5a757e044e3c6a24","705e5b6b317d091229d9699f2d616df2","49cc492aec9039819fc2b7a1a138a9fb","17065b3b2fe15f5c974a4065b18e030c","67478479ad1213a3e9341881175ee3b6","26621877e74d60fabed43cea37a77651","23cd9e0ce513fa08ed79fc876db1d25d","674186b8c66a85578d54f339a58ca3cf","7df5523bb26e62f32b12cf0cebe3297d","771e8cf06fa57452133bbb588d63bb9e","0693aaee5f362b197b367da78759603c","29827ae18c4badba450e393e6a8675f4","50ffcd261f2347a7dabcb04d0ebc64d4","2e82c593988864af55a34586892be0c1","9032629378f478b12aedd374816aa2f5","f0c89cc1c12dbfe8b1b664799f1939ba","1a025f481ea3486278e9e00c31e440ec","36783e63ea087c714c376b843863e3bf","64c9eec187276475779434ec212147eb","df85c0fe203c709bedbbfa875f9872a1"],[null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null],["1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19","20","21","22","23","24","25"]],"container":"<table class=\"white-space: nowrap\">\n  <thead>\n    <tr>\n      <th>start<\/th>\n      <th>end<\/th>\n      <th>date<\/th>\n      <th>location<\/th>\n      <th>cluster_number<\/th>\n      <th>household_number<\/th>\n      <th>is_the_household_present<\/th>\n      <th>household_consents_to_particip<\/th>\n      <th>what_was_the_reason_for_refusal<\/th>\n      <th>where_do_take_drinking_water_f<\/th>\n      <th>please_specify_other_source_of_water<\/th>\n      <th>no_household<\/th>\n      <th>_id<\/th>\n      <th>_uuid<\/th>\n      <th>_validation_status<\/th>\n      <th>_index<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"pageLength":5,"scrollX":true,"columnDefs":[],"order":[],"autoWidth":false,"orderClasses":false,"orderCellsTop":true,"lengthMenu":[5,10,25,50,100]}},"evals":[],"jsHooks":[]}</script><p></p>
<p>And here is a look at the first 25 individual responses:</p>
<div id="htmlwidget-d26755af6ee016aa7722" style="width:100%;height:auto;" class="datatables html-widget"></div>
<script type="application/json" data-for="htmlwidget-d26755af6ee016aa7722">{"x":{"filter":"top","vertical":false,"filterHTML":"<tr>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\" disabled=\"\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\" disabled=\"\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\" disabled=\"\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\" disabled=\"\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\" disabled=\"\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\" disabled=\"\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\" disabled=\"\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\" disabled=\"\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"logical\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\" disabled=\"\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"width: 100%; display: none;\">\n      <select multiple=\"multiple\" style=\"width: 100%;\" data-options=\"[&quot;true&quot;,&quot;false&quot;,&quot;na&quot;]\"><\/select>\n    <\/div>\n  <\/td>\n<\/tr>","data":[["Male","Male","Female","Male","Female","Female","Female","Male","Female","Male","Female","Male","Female","Male","Female","Female","Male","Female","Male","Male","Male","Female","Male","Male","Female"],["No","No","No","No","No","No","No","No","No","No","No","No","No","No","No","No","No","No","No","No","No","Yes","No","No","No"],[null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,"2",null,null,null],["82","6","14","6","15","3","34","22","11","33","7","4","27","15","16","13","23","9","41","19","11",null,"20","2","16"],[null,null,null,null,null,"No",null,null,null,null,null,"No",null,null,null,null,null,null,null,null,null,"Yes, fever and rash",null,"Yes, watery diarrhoea",null],[null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null],[null,null,null,null,null,"No",null,null,null,null,null,"No",null,null,null,null,null,null,null,null,null,null,null,"Unknown",null],[null,null,null,null,null,"150",null,null,null,null,null,"145",null,null,null,null,null,null,null,null,null,null,null,"146",null],["No","No","No","No","No","No","No","Yes","No","No","No","No","No","No","No","No","No","No","No","No","No","No","No","No","No"],[null,null,null,null,null,null,null,"2021-03-01",null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null],["No","No","No","No","No","No","No","No","No","No","No","No","No","No","No","No","No","No","No","No","No","No","No","No","No"],[null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null],["No","No","No","No","No","No","No","No","No","No","No","No","No","No","No","No","No","No","No","Yes","No","No","No","No","No"],[null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,"2021-05-29",null,null,null,null,null],["No","No","No","No","No","No","No","No","No","No","No","No","No","No","No","No","No","No","No","No","No","No","No","No","No"],[null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null],[null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null],[null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null],["1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19","20","21","22","23","24","25"],["Mortality Survey","Mortality Survey","Mortality Survey","Mortality Survey","Mortality Survey","Mortality Survey","Mortality Survey","Mortality Survey","Mortality Survey","Mortality Survey","Mortality Survey","Mortality Survey","Mortality Survey","Mortality Survey","Mortality Survey","Mortality Survey","Mortality Survey","Mortality Survey","Mortality Survey","Mortality Survey","Mortality Survey","Mortality Survey","Mortality Survey","Mortality Survey","Mortality Survey"],["1","1","1","1","1","1","2","2","2","2","2","2","2","2","2","3","3","3","3","3","3","3","3","3","4"],["500001","500001","500001","500001","500001","500001","500002","500002","500002","500002","500002","500002","500002","500002","500002","500003","500003","500003","500003","500003","500003","500003","500003","500003","500004"],["cf874aad79e14b401a4c86954a596fa5","cf874aad79e14b401a4c86954a596fa5","cf874aad79e14b401a4c86954a596fa5","cf874aad79e14b401a4c86954a596fa5","cf874aad79e14b401a4c86954a596fa5","cf874aad79e14b401a4c86954a596fa5","e8647dce263d505d7b0d605a5d6c2d1b","e8647dce263d505d7b0d605a5d6c2d1b","e8647dce263d505d7b0d605a5d6c2d1b","e8647dce263d505d7b0d605a5d6c2d1b","e8647dce263d505d7b0d605a5d6c2d1b","e8647dce263d505d7b0d605a5d6c2d1b","e8647dce263d505d7b0d605a5d6c2d1b","e8647dce263d505d7b0d605a5d6c2d1b","e8647dce263d505d7b0d605a5d6c2d1b","28102e526765b0ac82736c2c205b94ab","28102e526765b0ac82736c2c205b94ab","28102e526765b0ac82736c2c205b94ab","28102e526765b0ac82736c2c205b94ab","28102e526765b0ac82736c2c205b94ab","28102e526765b0ac82736c2c205b94ab","28102e526765b0ac82736c2c205b94ab","28102e526765b0ac82736c2c205b94ab","28102e526765b0ac82736c2c205b94ab","ad702a3ec1e6317dfdc06ececcc03d2e"],[null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null]],"container":"<table class=\"white-space: nowrap\">\n  <thead>\n    <tr>\n      <th>sex<\/th>\n      <th>is_this_household_member_aged_<\/th>\n      <th>age_in_months<\/th>\n      <th>age_in_years<\/th>\n      <th>did_this_household_member_expe<\/th>\n      <th>if_other_illness_specify_please<\/th>\n      <th>was_oedema_detected<\/th>\n      <th>muac<\/th>\n      <th>did_this_household_member_arri<\/th>\n      <th>doa<\/th>\n      <th>did_this_household_member_depa<\/th>\n      <th>dod<\/th>\n      <th>was_this_household_member_born<\/th>\n      <th>dob<\/th>\n      <th>died<\/th>\n      <th>dodeath<\/th>\n      <th>cause_of_death<\/th>\n      <th>if_other_cause_of_death_specify_please<\/th>\n      <th>_index<\/th>\n      <th>_parent_table_name<\/th>\n      <th>_parent_index<\/th>\n      <th>_submission___id<\/th>\n      <th>_submission___uuid<\/th>\n      <th>_submission___validation_status<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"pageLength":5,"scrollX":true,"columnDefs":[],"order":[],"autoWidth":false,"orderClasses":false,"orderCellsTop":true,"lengthMenu":[5,10,25,50,100]}},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<div class="section level3">
<h3 id="merge-data-levels">Merge data levels<a class="anchor" aria-label="anchor" href="#merge-data-levels"></a>
</h3>
<p>As we are using a Kobo dataset that has both individual and household data (stored in separate data frames), we will need to combine them using code in the <code>merge_data_levels</code> code chunk.</p>
<p>Uncomment this code, and replace the defaults to reflect our data sets, as below:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="co">## join the individual and household data to form a complete data set</span></span>
<span><span class="va">study_data_raw</span> <span class="op">&lt;-</span> <span class="fu">left_join</span><span class="op">(</span><span class="va">survey_data_hh</span>, <span class="va">survey_data_ind</span>, by <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"_index"</span> <span class="op">=</span> <span class="st">"_parent_index"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>Here are the first 25 rows of this combined data frame <code>study_data_raw</code>. Scroll to the far right side to see the joined columns from <code>survey_data_ind</code>:</p>
<div id="htmlwidget-d8722b948c21d712572f" style="width:100%;height:auto;" class="datatables html-widget"></div>
<script type="application/json" data-for="htmlwidget-d8722b948c21d712572f">{"x":{"filter":"top","vertical":false,"filterHTML":"<tr>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\" disabled=\"\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\" disabled=\"\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\" disabled=\"\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\" disabled=\"\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\" disabled=\"\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\" disabled=\"\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\" disabled=\"\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"logical\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\" disabled=\"\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"width: 100%; display: none;\">\n      <select multiple=\"multiple\" style=\"width: 100%;\" data-options=\"[&quot;true&quot;,&quot;false&quot;,&quot;na&quot;]\"><\/select>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\" disabled=\"\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\" disabled=\"\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\" disabled=\"\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\" disabled=\"\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\" disabled=\"\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\" disabled=\"\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\" disabled=\"\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\" disabled=\"\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"logical\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\" disabled=\"\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"width: 100%; display: none;\">\n      <select multiple=\"multiple\" style=\"width: 100%;\" data-options=\"[&quot;true&quot;,&quot;false&quot;,&quot;na&quot;]\"><\/select>\n    <\/div>\n  <\/td>\n<\/tr>","data":[["2021-07-18T11:57:58.968+03:00","2021-07-18T11:57:58.968+03:00","2021-07-18T11:57:58.968+03:00","2021-07-18T11:57:58.968+03:00","2021-07-18T11:57:58.968+03:00","2021-07-18T11:57:58.968+03:00","2021-07-24T09:36:47.779+03:00","2021-07-24T09:36:47.779+03:00","2021-07-24T09:36:47.779+03:00","2021-07-24T09:36:47.779+03:00","2021-07-24T09:36:47.779+03:00","2021-07-24T09:36:47.779+03:00","2021-07-24T09:36:47.779+03:00","2021-07-24T09:36:47.779+03:00","2021-07-24T09:36:47.779+03:00","2021-07-18T10:57:37.964+03:00","2021-07-18T10:57:37.964+03:00","2021-07-18T10:57:37.964+03:00","2021-07-18T10:57:37.964+03:00","2021-07-18T10:57:37.964+03:00","2021-07-18T10:57:37.964+03:00","2021-07-18T10:57:37.964+03:00","2021-07-18T10:57:37.964+03:00","2021-07-18T10:57:37.964+03:00","2021-07-12T14:42:29.643+02:00"],["2021-07-24T09:26:56.432+03:00","2021-07-24T09:26:56.432+03:00","2021-07-24T09:26:56.432+03:00","2021-07-24T09:26:56.432+03:00","2021-07-24T09:26:56.432+03:00","2021-07-24T09:26:56.432+03:00","2021-07-12T15:11:37.180+02:00","2021-07-12T15:11:37.180+02:00","2021-07-12T15:11:37.180+02:00","2021-07-12T15:11:37.180+02:00","2021-07-12T15:11:37.180+02:00","2021-07-12T15:11:37.180+02:00","2021-07-12T15:11:37.180+02:00","2021-07-12T15:11:37.180+02:00","2021-07-12T15:11:37.180+02:00","2021-07-22T22:05:58.557+03:00","2021-07-22T22:05:58.557+03:00","2021-07-22T22:05:58.557+03:00","2021-07-22T22:05:58.557+03:00","2021-07-22T22:05:58.557+03:00","2021-07-22T22:05:58.557+03:00","2021-07-22T22:05:58.557+03:00","2021-07-22T22:05:58.557+03:00","2021-07-22T22:05:58.557+03:00","2021-07-18T15:51:07.752+03:00"],["2021-07-12","2021-07-12","2021-07-12","2021-07-12","2021-07-12","2021-07-12","2021-07-14","2021-07-14","2021-07-14","2021-07-14","2021-07-14","2021-07-14","2021-07-14","2021-07-14","2021-07-14","2021-07-14","2021-07-14","2021-07-14","2021-07-14","2021-07-14","2021-07-14","2021-07-14","2021-07-14","2021-07-14","2021-07-12"],["Town A","Town A","Town A","Town A","Town A","Town A","Town A","Town A","Town A","Town A","Town A","Town A","Town A","Town A","Town A","Town A","Town A","Town A","Town A","Town A","Town A","Town A","Town A","Town A","Town A"],["1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1"],["1","1","1","1","1","1","2","2","2","2","2","2","2","2","2","3","3","3","3","3","3","3","3","3","4"],["Yes","Yes","Yes","Yes","Yes","Yes","Yes","Yes","Yes","Yes","Yes","Yes","Yes","Yes","Yes","Yes","Yes","Yes","Yes","Yes","Yes","Yes","Yes","Yes","Yes"],["Yes","Yes","Yes","Yes","Yes","Yes","Yes","Yes","Yes","Yes","Yes","Yes","Yes","Yes","Yes","Yes","Yes","Yes","Yes","Yes","Yes","Yes","Yes","Yes","Yes"],[null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null],["City water network piped to household","City water network piped to household","City water network piped to household","City water network piped to household","City water network piped to household","City water network piped to household","City water network piped to household","City water network piped to household","City water network piped to household","City water network piped to household","City water network piped to household","City water network piped to household","City water network piped to household","City water network piped to household","City water network piped to household","City water network piped to household","City water network piped to household","City water network piped to household","City water network piped to household","City water network piped to household","City water network piped to household","City water network piped to household","City water network piped to household","City water network piped to household","City water network piped to household"],[null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null],["6","6","6","6","6","6","9","9","9","9","9","9","9","9","9","9","9","9","9","9","9","9","9","9","7"],["500001","500001","500001","500001","500001","500001","500002","500002","500002","500002","500002","500002","500002","500002","500002","500003","500003","500003","500003","500003","500003","500003","500003","500003","500004"],["cf874aad79e14b401a4c86954a596fa5","cf874aad79e14b401a4c86954a596fa5","cf874aad79e14b401a4c86954a596fa5","cf874aad79e14b401a4c86954a596fa5","cf874aad79e14b401a4c86954a596fa5","cf874aad79e14b401a4c86954a596fa5","e8647dce263d505d7b0d605a5d6c2d1b","e8647dce263d505d7b0d605a5d6c2d1b","e8647dce263d505d7b0d605a5d6c2d1b","e8647dce263d505d7b0d605a5d6c2d1b","e8647dce263d505d7b0d605a5d6c2d1b","e8647dce263d505d7b0d605a5d6c2d1b","e8647dce263d505d7b0d605a5d6c2d1b","e8647dce263d505d7b0d605a5d6c2d1b","e8647dce263d505d7b0d605a5d6c2d1b","28102e526765b0ac82736c2c205b94ab","28102e526765b0ac82736c2c205b94ab","28102e526765b0ac82736c2c205b94ab","28102e526765b0ac82736c2c205b94ab","28102e526765b0ac82736c2c205b94ab","28102e526765b0ac82736c2c205b94ab","28102e526765b0ac82736c2c205b94ab","28102e526765b0ac82736c2c205b94ab","28102e526765b0ac82736c2c205b94ab","ad702a3ec1e6317dfdc06ececcc03d2e"],[null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null],["1","1","1","1","1","1","2","2","2","2","2","2","2","2","2","3","3","3","3","3","3","3","3","3","4"],["Male","Male","Female","Male","Female","Female","Female","Male","Female","Male","Female","Male","Female","Male","Female","Female","Male","Female","Male","Male","Male","Female","Male","Male","Female"],["No","No","No","No","No","No","No","No","No","No","No","No","No","No","No","No","No","No","No","No","No","Yes","No","No","No"],[null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,"2",null,null,null],["82","6","14","6","15","3","34","22","11","33","7","4","27","15","16","13","23","9","41","19","11",null,"20","2","16"],[null,null,null,null,null,"No",null,null,null,null,null,"No",null,null,null,null,null,null,null,null,null,"Yes, fever and rash",null,"Yes, watery diarrhoea",null],[null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null],[null,null,null,null,null,"No",null,null,null,null,null,"No",null,null,null,null,null,null,null,null,null,null,null,"Unknown",null],[null,null,null,null,null,"150",null,null,null,null,null,"145",null,null,null,null,null,null,null,null,null,null,null,"146",null],["No","No","No","No","No","No","No","Yes","No","No","No","No","No","No","No","No","No","No","No","No","No","No","No","No","No"],[null,null,null,null,null,null,null,"2021-03-01",null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null],["No","No","No","No","No","No","No","No","No","No","No","No","No","No","No","No","No","No","No","No","No","No","No","No","No"],[null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null],["No","No","No","No","No","No","No","No","No","No","No","No","No","No","No","No","No","No","No","Yes","No","No","No","No","No"],[null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,"2021-05-29",null,null,null,null,null],["No","No","No","No","No","No","No","No","No","No","No","No","No","No","No","No","No","No","No","No","No","No","No","No","No"],[null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null],[null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null],[null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null],["1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19","20","21","22","23","24","25"],["Mortality Survey","Mortality Survey","Mortality Survey","Mortality Survey","Mortality Survey","Mortality Survey","Mortality Survey","Mortality Survey","Mortality Survey","Mortality Survey","Mortality Survey","Mortality Survey","Mortality Survey","Mortality Survey","Mortality Survey","Mortality Survey","Mortality Survey","Mortality Survey","Mortality Survey","Mortality Survey","Mortality Survey","Mortality Survey","Mortality Survey","Mortality Survey","Mortality Survey"],["500001","500001","500001","500001","500001","500001","500002","500002","500002","500002","500002","500002","500002","500002","500002","500003","500003","500003","500003","500003","500003","500003","500003","500003","500004"],["cf874aad79e14b401a4c86954a596fa5","cf874aad79e14b401a4c86954a596fa5","cf874aad79e14b401a4c86954a596fa5","cf874aad79e14b401a4c86954a596fa5","cf874aad79e14b401a4c86954a596fa5","cf874aad79e14b401a4c86954a596fa5","e8647dce263d505d7b0d605a5d6c2d1b","e8647dce263d505d7b0d605a5d6c2d1b","e8647dce263d505d7b0d605a5d6c2d1b","e8647dce263d505d7b0d605a5d6c2d1b","e8647dce263d505d7b0d605a5d6c2d1b","e8647dce263d505d7b0d605a5d6c2d1b","e8647dce263d505d7b0d605a5d6c2d1b","e8647dce263d505d7b0d605a5d6c2d1b","e8647dce263d505d7b0d605a5d6c2d1b","28102e526765b0ac82736c2c205b94ab","28102e526765b0ac82736c2c205b94ab","28102e526765b0ac82736c2c205b94ab","28102e526765b0ac82736c2c205b94ab","28102e526765b0ac82736c2c205b94ab","28102e526765b0ac82736c2c205b94ab","28102e526765b0ac82736c2c205b94ab","28102e526765b0ac82736c2c205b94ab","28102e526765b0ac82736c2c205b94ab","ad702a3ec1e6317dfdc06ececcc03d2e"],[null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null]],"container":"<table class=\"white-space: nowrap\">\n  <thead>\n    <tr>\n      <th>start<\/th>\n      <th>end<\/th>\n      <th>date<\/th>\n      <th>location<\/th>\n      <th>cluster_number<\/th>\n      <th>household_number<\/th>\n      <th>is_the_household_present<\/th>\n      <th>household_consents_to_particip<\/th>\n      <th>what_was_the_reason_for_refusal<\/th>\n      <th>where_do_take_drinking_water_f<\/th>\n      <th>please_specify_other_source_of_water<\/th>\n      <th>no_household<\/th>\n      <th>_id<\/th>\n      <th>_uuid<\/th>\n      <th>_validation_status<\/th>\n      <th>_index<\/th>\n      <th>sex<\/th>\n      <th>is_this_household_member_aged_<\/th>\n      <th>age_in_months<\/th>\n      <th>age_in_years<\/th>\n      <th>did_this_household_member_expe<\/th>\n      <th>if_other_illness_specify_please<\/th>\n      <th>was_oedema_detected<\/th>\n      <th>muac<\/th>\n      <th>did_this_household_member_arri<\/th>\n      <th>doa<\/th>\n      <th>did_this_household_member_depa<\/th>\n      <th>dod<\/th>\n      <th>was_this_household_member_born<\/th>\n      <th>dob<\/th>\n      <th>died<\/th>\n      <th>dodeath<\/th>\n      <th>cause_of_death<\/th>\n      <th>if_other_cause_of_death_specify_please<\/th>\n      <th>_index.y<\/th>\n      <th>_parent_table_name<\/th>\n      <th>_submission___id<\/th>\n      <th>_submission___uuid<\/th>\n      <th>_submission___validation_status<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"pageLength":5,"scrollX":true,"columnDefs":[],"order":[],"autoWidth":false,"orderClasses":false,"orderCellsTop":true,"lengthMenu":[5,10,25,50,100]}},"evals":[],"jsHooks":[]}</script>
</div>
<div class="section level3">
<h3 id="prep-data">Prep data<a class="anchor" aria-label="anchor" href="#prep-data"></a>
</h3>
<p>This dataset was produced with Kobo, but does not exactly align with the MSF data dictionary for mortality surveys. <strong>Therefore, for this report we must treat it as “non-Kobo” and take actions to align it with the expected column names.</strong></p>
<p>Therefore, to prepare the data you should <strong>comment/deactivate with #</strong> the chunk called <code>prep_kobo_data</code>. Instead, we will use the approach outlined in the code chunk <code>prep_nonkobo_data</code>.</p>
<p>The main activity to prep the data is alignment of the column names to those expected by this R Markdown template.</p>
<p>First, we can un-comment and run the command that creates <code>study_data_cleaned</code> as an exact copy of <code>study_data_raw</code>. This new data frame will be fully cleaned in subsequent sections.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">study_data_cleaned</span> <span class="op">&lt;-</span> <span class="va">study_data_raw</span></span></code></pre></div>
<p>Next, we want to rename some of our columns. Using the command <code>msf_dict_rename_helper("mortality", varnames = "name")</code> we get a “helped” command copied to our clipboard. This contains many more variables than we need, but it is useful to review.</p>
<details><p><summary>Click to see this code chunk&gt;</summary></p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="co">## Add the appropriate column names after the equals signs</span></span>
<span><span class="co"># </span></span>
<span><span class="co"># linelist_cleaned &lt;- rename(linelist_cleaned,</span></span>
<span><span class="co">#   age_months                         =   , # integer         (REQUIRED)</span></span>
<span><span class="co">#   age_years                          =   , # integer         (REQUIRED)</span></span>
<span><span class="co">#   arrived                            =   , # yn              (REQUIRED)</span></span>
<span><span class="co">#   care_fever                         =   , # yndk            (REQUIRED)</span></span>
<span><span class="co">#   care_illness_recent                =   , # yndk            (REQUIRED)</span></span>
<span><span class="co">#   cause                              =   , # cause           (REQUIRED)</span></span>
<span><span class="co">#   cause_illness                      =   , # cause           (REQUIRED)</span></span>
<span><span class="co">#   cluster_number                     =   , # integer         (REQUIRED)</span></span>
<span><span class="co">#   consent                            =   , # yn              (REQUIRED)</span></span>
<span><span class="co">#   date                               =   , # date            (REQUIRED)</span></span>
<span><span class="co">#   date_arrived                       =   , # date            (REQUIRED)</span></span>
<span><span class="co">#   date_birth                         =   , # date            (REQUIRED)</span></span>
<span><span class="co">#   date_death                         =   , # date            (REQUIRED)</span></span>
<span><span class="co">#   date_left                          =   , # date            (REQUIRED)</span></span>
<span><span class="co">#   died                               =   , # yn              (REQUIRED)</span></span>
<span><span class="co">#   end                                =   , # end             (REQUIRED)</span></span>
<span><span class="co">#   fever_now                          =   , # yndk            (REQUIRED)</span></span>
<span><span class="co">#   fever_past_weeks                   =   , # yndk            (REQUIRED)</span></span>
<span><span class="co">#   height                             =   , # integer         (REQUIRED)</span></span>
<span><span class="co">#   household_number                   =   , # integer         (REQUIRED)</span></span>
<span><span class="co">#   ill_hh_number                      =   , # integer         (REQUIRED)</span></span>
<span><span class="co">#   ill_recently                       =   , # yndk            (REQUIRED)</span></span>
<span><span class="co">#   left                               =   , # yn              (REQUIRED)</span></span>
<span><span class="co">#   member_number                      =   , # integer         (REQUIRED)</span></span>
<span><span class="co">#   no_care_illness                    =   , # no_care         (REQUIRED)</span></span>
<span><span class="co">#   no_consent_reason                  =   , # no_consent      (REQUIRED)</span></span>
<span><span class="co">#   place_violence                     =   , # viol_place      (REQUIRED)</span></span>
<span><span class="co">#   pregnant                           =   , # yn              (REQUIRED)</span></span>
<span><span class="co">#   reason_no_care                     =   , # no_care         (REQUIRED)</span></span>
<span><span class="co">#   sex                                =   , # sex             (REQUIRED)</span></span>
<span><span class="co">#   start                              =   , # start           (REQUIRED)</span></span>
<span><span class="co">#   uniform                            =   , # ynnr            (REQUIRED)</span></span>
<span><span class="co">#   village_name                       =   , # village         (REQUIRED)</span></span>
<span><span class="co">#   violence_nature                    =   , # violence_nature (REQUIRED)</span></span>
<span><span class="co">#   violence_nature_other              =   , # text            (REQUIRED)</span></span>
<span><span class="co">#   violent_episode                    =   , # ynnr            (REQUIRED)</span></span>
<span><span class="co">#   violent_episodes_number            =   , # integer         (REQUIRED)</span></span>
<span><span class="co">#   weight                             =   , # integer         (REQUIRED)</span></span>
<span><span class="co">#   after_leaving_hf                   =   , # text            (optional)</span></span>
<span><span class="co">#   anc_bednet                         =   , # yndk            (optional)</span></span>
<span><span class="co">#   anti_malarials                     =   , # yndk            (optional)</span></span>
<span><span class="co">#   anti_malarials_listed              =   , # anti_malarials  (optional)</span></span>
<span><span class="co">#   axiliary_temp                      =   , # integer         (optional)</span></span>
<span><span class="co">#   bednet                             =   , # yn              (optional)</span></span>
<span><span class="co">#   born                               =   , # yn              (optional)</span></span>
<span><span class="co">#   born_later                         =   , # yn              (optional)</span></span>
<span><span class="co">#   care_dying                         =   , # yndk            (optional)</span></span>
<span><span class="co">#   care_illness_df                    =   , # yndk            (optional)</span></span>
<span><span class="co">#   care_illness_last                  =   , # yndk            (optional)</span></span>
<span><span class="co">#   cause_illness_df                   =   , # illness         (optional)</span></span>
<span><span class="co">#   cause_illness_last                 =   , # cause           (optional)</span></span>
<span><span class="co">#   cause_illness_last_other           =   , # text            (optional)</span></span>
<span><span class="co">#   cause_illness_other                =   , # text            (optional)</span></span>
<span><span class="co">#   cause_other                        =   , # text            (optional)</span></span>
<span><span class="co">#   cost_consultation                  =   , # integer         (optional)</span></span>
<span><span class="co">#   cost_consultation_df               =   , # integer         (optional)</span></span>
<span><span class="co">#   cost_consultation_last             =   , # integer         (optional)</span></span>
<span><span class="co">#   cost_treatment                     =   , # integer         (optional)</span></span>
<span><span class="co">#   cost_treatment_df                  =   , # integer         (optional)</span></span>
<span><span class="co">#   cost_treatment_last                =   , # integer         (optional)</span></span>
<span><span class="co">#   current_status                     =   , # status          (optional)</span></span>
<span><span class="co">#   date_death_alt                     =   , # date            (optional)</span></span>
<span><span class="co">#   date_violence                      =   , # date            (optional)</span></span>
<span><span class="co">#   deviceid                           =   , # deviceid        (optional)</span></span>
<span><span class="co">#   diarrhoea_fever_2weeks             =   , # yndk            (optional)</span></span>
<span><span class="co">#   education_level                    =   , # education_level (optional)</span></span>
<span><span class="co">#   height_mal                         =   , # integer         (optional)</span></span>
<span><span class="co">#   hemocue                            =   , # integer         (optional)</span></span>
<span><span class="co">#   herbal_medicines                   =   , # herbs           (optional)</span></span>
<span><span class="co">#   households_building                =   , # integer         (optional)</span></span>
<span><span class="co">#   last_person_ill                    =   , # yndk            (optional)</span></span>
<span><span class="co">#   malaria_episodes                   =   , # integer         (optional)</span></span>
<span><span class="co">#   malaria_test                       =   , # test            (optional)</span></span>
<span><span class="co">#   malaria_treatment                  =   , # yn              (optional)</span></span>
<span><span class="co">#   malaria_treatment_infant           =   , # treatment       (optional)</span></span>
<span><span class="co">#   malaria_treatment_preg             =   , # treatment       (optional)</span></span>
<span><span class="co">#   measles_vaccination                =   , # yn              (optional)</span></span>
<span><span class="co">#   muac                               =   , # integer         (optional)</span></span>
<span><span class="co">#   muac_mal                           =   , # integer         (optional)</span></span>
<span><span class="co">#   n1                                 =   , # note            (optional)</span></span>
<span><span class="co">#   n10                                =   , # note            (optional)</span></span>
<span><span class="co">#   n11                                =   , # note            (optional)</span></span>
<span><span class="co">#   n12                                =   , # note            (optional)</span></span>
<span><span class="co">#   n13                                =   , # note            (optional)</span></span>
<span><span class="co">#   n2                                 =   , # note            (optional)</span></span>
<span><span class="co">#   n3                                 =   , # note            (optional)</span></span>
<span><span class="co">#   n4                                 =   , # note            (optional)</span></span>
<span><span class="co">#   n5                                 =   , # note            (optional)</span></span>
<span><span class="co">#   n6                                 =   , # note            (optional)</span></span>
<span><span class="co">#   n7                                 =   , # note            (optional)</span></span>
<span><span class="co">#   n8                                 =   , # note            (optional)</span></span>
<span><span class="co">#   n9                                 =   , # note            (optional)</span></span>
<span><span class="co">#   no_care_illness_df                 =   , # no_care         (optional)</span></span>
<span><span class="co">#   no_care_illness_df_other           =   , # text            (optional)</span></span>
<span><span class="co">#   no_care_illness_last               =   , # no_care         (optional)</span></span>
<span><span class="co">#   no_care_illness_last_other         =   , # text            (optional)</span></span>
<span><span class="co">#   no_care_illness_other              =   , # text            (optional)</span></span>
<span><span class="co">#   no_consent_other                   =   , # text            (optional)</span></span>
<span><span class="co">#   oedema                             =   , # measure         (optional)</span></span>
<span><span class="co">#   oedema_mal                         =   , # measure         (optional)</span></span>
<span><span class="co">#   period_illness_hsb                 =   , # period          (optional)</span></span>
<span><span class="co">#   period_illness_hsb_number          =   , # integer         (optional)</span></span>
<span><span class="co">#   period_illness_viol                =   , # period          (optional)</span></span>
<span><span class="co">#   period_illness_viol_number         =   , # integer         (optional)</span></span>
<span><span class="co">#   place_care_dying                   =   , # place_death     (optional)</span></span>
<span><span class="co">#   place_care_illness                 =   , # place_hf        (optional)</span></span>
<span><span class="co">#   place_care_illness_other           =   , # text            (optional)</span></span>
<span><span class="co">#   place_death                        =   , # place_death     (optional)</span></span>
<span><span class="co">#   place_death_hsb                    =   , # place_death     (optional)</span></span>
<span><span class="co">#   place_death_hsb_other              =   , # text            (optional)</span></span>
<span><span class="co">#   place_death_other                  =   , # text            (optional)</span></span>
<span><span class="co">#   place_death_viol                   =   , # place_death     (optional)</span></span>
<span><span class="co">#   place_death_viol_other             =   , # text            (optional)</span></span>
<span><span class="co">#   place_first_hf                     =   , # place_hf        (optional)</span></span>
<span><span class="co">#   place_first_hf_df                  =   , # place_hf        (optional)</span></span>
<span><span class="co">#   place_first_hf_df_other            =   , # text            (optional)</span></span>
<span><span class="co">#   place_first_hf_other               =   , # text            (optional)</span></span>
<span><span class="co">#   place_healthcare                   =   , # place_treatment (optional)</span></span>
<span><span class="co">#   place_healthcare_other             =   , # text            (optional)</span></span>
<span><span class="co">#   place_second_hf                    =   , # place_hf        (optional)</span></span>
<span><span class="co">#   place_second_hf_df                 =   , # place_hf        (optional)</span></span>
<span><span class="co">#   place_second_hf_df_other           =   , # text            (optional)</span></span>
<span><span class="co">#   place_second_hf_other              =   , # text            (optional)</span></span>
<span><span class="co">#   place_violence_other               =   , # text            (optional)</span></span>
<span><span class="co">#   present_start                      =   , # yn              (optional)</span></span>
<span><span class="co">#   present_today                      =   , # yn              (optional)</span></span>
<span><span class="co">#   random_hh                          =   , # calculate       (optional)</span></span>
<span><span class="co">#   random_hh_note                     =   , # note            (optional)</span></span>
<span><span class="co">#   rdt                                =   , # test2           (optional)</span></span>
<span><span class="co">#   read_write                         =   , # yn              (optional)</span></span>
<span><span class="co">#   reason_first_hf_selected           =   , # reason_hf       (optional)</span></span>
<span><span class="co">#   reason_first_hf_selected_df        =   , # reason_hf       (optional)</span></span>
<span><span class="co">#   reason_first_hf_selected_df_other  =   , # text            (optional)</span></span>
<span><span class="co">#   reason_first_hf_selected_other     =   , # text            (optional)</span></span>
<span><span class="co">#   reason_no_care_hsb                 =   , # no_care         (optional)</span></span>
<span><span class="co">#   reason_no_care_hsb_other           =   , # text            (optional)</span></span>
<span><span class="co">#   reason_no_care_other               =   , # text            (optional)</span></span>
<span><span class="co">#   reason_not_present                 =   , # reason_absent   (optional)</span></span>
<span><span class="co">#   reason_second_hf_selected          =   , # reason_hf       (optional)</span></span>
<span><span class="co">#   reason_second_hf_selected_df       =   , # reason_hf       (optional)</span></span>
<span><span class="co">#   reason_second_hf_selected_df_other =   , # text            (optional)</span></span>
<span><span class="co">#   reason_second_hf_selected_other    =   , # text            (optional)</span></span>
<span><span class="co">#   remember_arrival                   =   , # yn              (optional)</span></span>
<span><span class="co">#   remember_death                     =   , # yn              (optional)</span></span>
<span><span class="co">#   remember_departure                 =   , # yn              (optional)</span></span>
<span><span class="co">#   remember_dob                       =   , # yn              (optional)</span></span>
<span><span class="co">#   remember_violence_date             =   , # yn              (optional)</span></span>
<span><span class="co">#   source_date_death_hsb              =   , # date            (optional)</span></span>
<span><span class="co">#   source_date_death_viol             =   , # date            (optional)</span></span>
<span><span class="co">#   source_death_hsb                   =   , # source          (optional)</span></span>
<span><span class="co">#   source_death_viol                  =   , # source          (optional)</span></span>
<span><span class="co">#   source_money_df                    =   , # money_source    (optional)</span></span>
<span><span class="co">#   source_money_df_other              =   , # text            (optional)</span></span>
<span><span class="co">#   source_money_last                  =   , # money_source    (optional)</span></span>
<span><span class="co">#   source_money_last_other            =   , # text            (optional)</span></span>
<span><span class="co">#   source_written_death_hsb           =   , # text            (optional)</span></span>
<span><span class="co">#   source_written_death_viol          =   , # text            (optional)</span></span>
<span><span class="co">#   source_written_hsb                 =   , # text            (optional)</span></span>
<span><span class="co">#   source_written_viol                =   , # text            (optional)</span></span>
<span><span class="co">#   spleen                             =   , # integer         (optional)</span></span>
<span><span class="co">#   start_illness                      =   , # period          (optional)</span></span>
<span><span class="co">#   start_illness_number               =   , # integer         (optional)</span></span>
<span><span class="co">#   status_df                          =   , # status          (optional)</span></span>
<span><span class="co">#   team_number                        =   , # integer         (optional)</span></span>
<span><span class="co">#   thick_smear                        =   , # yn              (optional)</span></span>
<span><span class="co">#   thin_smear                         =   , # yn              (optional)</span></span>
<span><span class="co">#   today                              =   , # today           (optional)</span></span>
<span><span class="co">#   treatment_delay                    =   , # time            (optional)</span></span>
<span><span class="co">#   treatment_delay_df                 =   , # time            (optional)</span></span>
<span><span class="co">#   vaccination_card                   =   , # yn              (optional)</span></span>
<span><span class="co">#   village_other                      =   , # text            (optional)</span></span>
<span><span class="co">#   visit_second_hf                    =   , # yndk            (optional)</span></span>
<span><span class="co">#   visit_second_hf_df                 =   , # yndk            (optional)</span></span>
<span><span class="co">#   weight_mal                         =     # integer         (optional)</span></span>
<span><span class="co"># )</span></span>
<span><span class="co"># </span></span></code></pre></div>
</details><p>We can edit the above, or simply refer to it to construct our <code>rename()</code> command, as below:</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">study_data_cleaned</span> <span class="op">&lt;-</span> <span class="fu">rename</span><span class="op">(</span><span class="va">study_data_cleaned</span>,</span>
<span>  <span class="co"># pattern is NEW name = OLD name</span></span>
<span>  uid <span class="op">=</span> <span class="va">`_index.y`</span>,</span>
<span>  consent <span class="op">=</span> <span class="va">household_consents_to_particip</span>,</span>
<span>  age_years <span class="op">=</span> <span class="va">age_in_years</span>,       </span>
<span>  age_months <span class="op">=</span> <span class="va">age_in_months</span>,</span>
<span>  date_arrived <span class="op">=</span> <span class="va">doa</span>,</span>
<span>  date_birth <span class="op">=</span> <span class="va">dob</span>,</span>
<span>  date_left <span class="op">=</span> <span class="va">dod</span>,</span>
<span>  date_death <span class="op">=</span> <span class="va">dodeath</span>,</span>
<span>  member_number <span class="op">=</span> <span class="va">no_household</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
<p>In the template, there is a command that creates the column <code>health_district</code>. For us, this information is already stored in the column <code>location</code>. So we run this command to re-name <code>location</code> as <code>health_district</code>.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">study_data_cleaned</span> <span class="op">&lt;-</span> <span class="fu">rename</span><span class="op">(</span><span class="va">study_data_cleaned</span>,</span>
<span>  health_district <span class="op">=</span> <span class="va">location</span><span class="op">)</span></span></code></pre></div>
<p>Finally, we run the command to clean the column names. The <code>clean_names()</code> function from the {janitor} package will standardise the syntax of all the column names (headers) by converting all to lowercase, replacing spaces and special characters with underscores, etc.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## define clean variable names using clean_names from the janitor package. </span></span>
<span><span class="va">study_data_cleaned</span> <span class="op">&lt;-</span> <span class="fu">clean_names</span><span class="op">(</span><span class="va">study_data_cleaned</span><span class="op">)</span></span></code></pre></div>
<p>Further data cleaning will occur in later data cleaning chunks.</p>
</div>
</div>
<div class="section level2">
<h2 id="convert-kobo-data-dictionary">Convert Kobo data dictionary<a class="anchor" aria-label="anchor" href="#convert-kobo-data-dictionary"></a>
</h2>
<div class="section level4">
<h4 id="kobo-data-dictionary">Kobo data dictionary<a class="anchor" aria-label="anchor" href="#kobo-data-dictionary"></a>
</h4>
<p>Surveys conducted with Kobo produce a data dictionary file, in which information about the variables are stored in one sheet, and information about the values (“choices”) are stored in an adjacent sheet in the same Excel workbook. For this example, this file is named “mortality_survey_dict.xlsx”, and is stored in the {sitrep} R package. We created the function <code><a href="../reference/download_kobo.html">download_kobo()</a></code> which will copy this file into a location of your choice on your computer.</p>
<p>Run the commands below. Now look for a pop-up window and use it to select your RStudio project folder (the pop-up may appear <em>behind</em> RStudio out-of-sight).</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># load the sitrep package</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/R4EPI/sitrep" class="external-link">sitrep</a></span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># run the command below as it is (empty parentheses).</span></span>
<span><span class="co"># Look for a pop-up window, and select your RStudio project as the destination</span></span>
<span><span class="fu"><a href="../reference/download_kobo.html">download_kobo</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="format-data-dictionary">Format data dictionary<a class="anchor" aria-label="anchor" href="#format-data-dictionary"></a>
</h3>
<p>The {sitrep} package contains a function to import the Kobo data dictionary into R and format it to facilitate further data cleaning. You can uncomment this code in the chunk <code>prep_kobo_data</code>, modify it such that the <code>name =</code> argument points to the location of your Kobo dictionary xlsx file, and run it. We also add the arguement <code>compact = FALSE</code> so that the dictionary is displayed to us as a more readable format, with each option having its own row.</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Import Kobo data dictionary into R and re-format to support data cleaning</span></span>
<span><span class="va">study_data_dict</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/msf_dict.html">msf_dict_survey</a></span><span class="op">(</span>name <span class="op">=</span> <span class="st">"mortality_survey_dict.xlsx"</span>,</span>
<span>                            template <span class="op">=</span> <span class="cn">FALSE</span>, </span>
<span>                            compact <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
<p>You can skip the code chunk <code>prep_nonkobo_data</code>.</p>
</div>
</div>
<div class="section level2">
<h2 id="population-data">Population data<a class="anchor" aria-label="anchor" href="#population-data"></a>
</h2>
<p>This vignette does not include population data, so in the chunk <code>read_population_data</code> we will use the code that is uncommented by default - estimating populations using the proportions for sub-Saharan Africa in 2019 from the Doctors without Borders (MSF) OCBA population denominators tool v1.</p>
<ul>
<li>We set the total population as 10,000, as a default assumption.<br>
</li>
<li>We leave the proportion estimates as written<br>
</li>
<li>We have observations from “Town A” and “Town B”, so we edit the inputs to the <code>health_district</code> column as written in the final line of each command (see below).</li>
</ul>
<p>We run all the uncommented code provided in the template to generate the population estimates and combine them into one data frame.</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">population_data_age_district_a</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/epikit-exports.html">gen_population</a></span><span class="op">(</span>total_pop <span class="op">=</span> <span class="fl">10000</span>, <span class="co"># set total population </span></span>
<span>  groups      <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"0-2"</span>, <span class="st">"3-14"</span>, <span class="st">"15-29"</span>, <span class="st">"30-44"</span>, <span class="st">"45+"</span><span class="op">)</span>, <span class="co"># set groups</span></span>
<span>  proportions <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.0340</span>, <span class="fl">0.1811</span>, <span class="fl">0.1380</span>, <span class="fl">0.0808</span>, <span class="fl">0.0661</span><span class="op">)</span>, <span class="co"># set proportions for each group</span></span>
<span>  strata      <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Male"</span>, <span class="st">"Female"</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span>           <span class="co"># stratify by gender</span></span>
<span>  <span class="fu">rename</span><span class="op">(</span>age_group  <span class="op">=</span> <span class="va">groups</span>,                      <span class="co"># rename columns (NEW NAME = OLD NAME)</span></span>
<span>         sex        <span class="op">=</span> <span class="va">strata</span>,</span>
<span>         population <span class="op">=</span> <span class="va">n</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">mutate</span><span class="op">(</span>health_district <span class="op">=</span> <span class="st">"Town A"</span><span class="op">)</span>           <span class="co"># add a column to identify region </span></span>
<span></span>
<span></span>
<span><span class="co">## generate population data by age groups in years for district B</span></span>
<span><span class="va">population_data_age_district_b</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/epikit-exports.html">gen_population</a></span><span class="op">(</span>total_pop <span class="op">=</span> <span class="fl">10000</span>, <span class="co"># set total population </span></span>
<span>  groups      <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"0-2"</span>, <span class="st">"3-14"</span>, <span class="st">"15-29"</span>, <span class="st">"30-44"</span>, <span class="st">"45+"</span><span class="op">)</span>, <span class="co"># set groups</span></span>
<span>  proportions <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.0340</span>, <span class="fl">0.1811</span>, <span class="fl">0.1380</span>, <span class="fl">0.0808</span>, <span class="fl">0.0661</span><span class="op">)</span>, <span class="co"># set proportions for each group</span></span>
<span>  strata      <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Male"</span>, <span class="st">"Female"</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span>           <span class="co"># stratify by gender</span></span>
<span>  <span class="fu">rename</span><span class="op">(</span>age_group  <span class="op">=</span> <span class="va">groups</span>,                      <span class="co"># rename columns (NEW NAME = OLD NAME)</span></span>
<span>         sex        <span class="op">=</span> <span class="va">strata</span>,</span>
<span>         population <span class="op">=</span> <span class="va">n</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">mutate</span><span class="op">(</span>health_district <span class="op">=</span> <span class="st">"Town B"</span><span class="op">)</span>           <span class="co"># add a column to identify region </span></span>
<span></span>
<span></span>
<span></span>
<span><span class="co">## bind region population data together to get overall population </span></span>
<span><span class="va">population_data_age</span> <span class="op">&lt;-</span> <span class="fu">bind_rows</span><span class="op">(</span><span class="va">population_data_age_district_a</span>, </span>
<span>                                 <span class="va">population_data_age_district_b</span><span class="op">)</span></span></code></pre></div>
<div class="section level3">
<h3 id="cluster-counts">Cluster counts<a class="anchor" aria-label="anchor" href="#cluster-counts"></a>
</h3>
<p>We can see that there are 17 clusters, from each town:</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">study_data_cleaned</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">tabyl</span><span class="op">(</span><span class="va">cluster_number</span>, <span class="va">health_district</span><span class="op">)</span></span>
<span><span class="co">#&gt;  cluster_number Town A Town B</span></span>
<span><span class="co">#&gt;               1     98    111</span></span>
<span><span class="co">#&gt;              10     85    115</span></span>
<span><span class="co">#&gt;              11     85    101</span></span>
<span><span class="co">#&gt;              12     79     95</span></span>
<span><span class="co">#&gt;              13    122     86</span></span>
<span><span class="co">#&gt;              14     83     98</span></span>
<span><span class="co">#&gt;              15     95     76</span></span>
<span><span class="co">#&gt;              17    119      0</span></span>
<span><span class="co">#&gt;               2    128     41</span></span>
<span><span class="co">#&gt;               3     89     77</span></span>
<span><span class="co">#&gt;               4      0     91</span></span>
<span><span class="co">#&gt;               5      3    108</span></span>
<span><span class="co">#&gt;               6    292     80</span></span>
<span><span class="co">#&gt;               7      8     77</span></span>
<span><span class="co">#&gt;               8    135     85</span></span>
<span><span class="co">#&gt;               9    126    113</span></span></code></pre></div>
<p>The fact that there are clusters 1-17 in each of the Towns will complicate later analyses. Each cluster should have a unique identification value. So, let us create one. We use the <code>str_glue()</code> function from {stringr} to combine the cluster number and the letter of the town. The letter of the town is extracted from the town name using <code>str_sub()</code>, which is also from the {stringr} package. The -1 extracts the last letter of the village name, and places it into the ID.</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">study_data_cleaned</span> <span class="op">&lt;-</span> <span class="va">study_data_cleaned</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">mutate</span><span class="op">(</span>cluster_number_uid <span class="op">=</span> <span class="fu">str_glue</span><span class="op">(</span></span>
<span>    <span class="st">"{town_letter}_{cluster_number}"</span>,</span>
<span>    town_letter <span class="op">=</span> <span class="fu">str_sub</span><span class="op">(</span><span class="va">health_district</span>, <span class="op">-</span><span class="fl">1</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>We verify:</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">study_data_cleaned</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">tabyl</span><span class="op">(</span><span class="va">cluster_number_uid</span>, <span class="va">health_district</span><span class="op">)</span></span>
<span><span class="co">#&gt;  cluster_number_uid Town A Town B</span></span>
<span><span class="co">#&gt;                 A_1     98      0</span></span>
<span><span class="co">#&gt;                A_10     85      0</span></span>
<span><span class="co">#&gt;                A_11     85      0</span></span>
<span><span class="co">#&gt;                A_12     79      0</span></span>
<span><span class="co">#&gt;                A_13    122      0</span></span>
<span><span class="co">#&gt;                A_14     83      0</span></span>
<span><span class="co">#&gt;                A_15     95      0</span></span>
<span><span class="co">#&gt;                A_17    119      0</span></span>
<span><span class="co">#&gt;                 A_2    128      0</span></span>
<span><span class="co">#&gt;                 A_3     89      0</span></span>
<span><span class="co">#&gt;                 A_5      3      0</span></span>
<span><span class="co">#&gt;                 A_6    292      0</span></span>
<span><span class="co">#&gt;                 A_7      8      0</span></span>
<span><span class="co">#&gt;                 A_8    135      0</span></span>
<span><span class="co">#&gt;                 A_9    126      0</span></span>
<span><span class="co">#&gt;                 B_1      0    111</span></span>
<span><span class="co">#&gt;                B_10      0    115</span></span>
<span><span class="co">#&gt;                B_11      0    101</span></span>
<span><span class="co">#&gt;                B_12      0     95</span></span>
<span><span class="co">#&gt;                B_13      0     86</span></span>
<span><span class="co">#&gt;                B_14      0     98</span></span>
<span><span class="co">#&gt;                B_15      0     76</span></span>
<span><span class="co">#&gt;                 B_2      0     41</span></span>
<span><span class="co">#&gt;                 B_3      0     77</span></span>
<span><span class="co">#&gt;                 B_4      0     91</span></span>
<span><span class="co">#&gt;                 B_5      0    108</span></span>
<span><span class="co">#&gt;                 B_6      0     80</span></span>
<span><span class="co">#&gt;                 B_7      0     77</span></span>
<span><span class="co">#&gt;                 B_8      0     85</span></span>
<span><span class="co">#&gt;                 B_9      0    113</span></span></code></pre></div>
<p>Now, our task is to create a <em>new</em> data frame that contains the number of households in each cluster. This is not the number of households chosen to be interviewed, but the universe of <em>possible</em> households that could have been chosen in each cluster.</p>
<p>To create a <em>new</em> dataframe, the R Markdown template uses the <code>tibble()</code> function for your to manually input the names of the clusters, and the number of households. Below, we use a slight adaptation for ease of use: we use the <code>tribble()</code> function (note the “r”) so that we can type this information in “rows” that look like a normal data frame. Note how the columns are specified at the top with tildes (~).</p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="va">cluster_counts</span> <span class="op">&lt;-</span> <span class="fu">tribble</span><span class="op">(</span></span>
<span>  <span class="op">~</span><span class="va">cluster</span>, <span class="op">~</span><span class="va">households</span>,</span>
<span>  <span class="st">"A_1"</span>,     <span class="fl">100</span>,</span>
<span>  <span class="st">"A_2"</span>, <span class="fl">100</span>, </span>
<span>  <span class="st">"A_3"</span>, <span class="fl">100</span>, </span>
<span>  <span class="st">"A_4"</span>, <span class="fl">100</span>,</span>
<span>  <span class="st">"A_5"</span>, <span class="fl">100</span>,</span>
<span>  <span class="st">"A_6"</span>, <span class="fl">100</span>, </span>
<span>  <span class="st">"A_7"</span>, <span class="fl">100</span>,</span>
<span>  <span class="st">"A_8"</span>, <span class="fl">100</span>, </span>
<span>  <span class="st">"A_9"</span>, <span class="fl">100</span>, </span>
<span>  <span class="st">"A_10"</span>, <span class="fl">100</span>, </span>
<span>  <span class="st">"A_11"</span>, <span class="fl">100</span>, </span>
<span>  <span class="st">"A_12"</span>, <span class="fl">100</span>, </span>
<span>  <span class="st">"A_13"</span>, <span class="fl">100</span>,</span>
<span>  <span class="st">"A_14"</span>, <span class="fl">100</span>, </span>
<span>  <span class="st">"A_15"</span>, <span class="fl">100</span>, </span>
<span>  <span class="st">"A_16"</span>, <span class="fl">100</span>, </span>
<span>  <span class="st">"A_17"</span>, <span class="fl">100</span>, </span>
<span>  </span>
<span>  <span class="st">"B_1"</span>, <span class="fl">100</span>,</span>
<span>  <span class="st">"B_2"</span>, <span class="fl">100</span>, </span>
<span>  <span class="st">"B_3"</span>, <span class="fl">100</span>, </span>
<span>  <span class="st">"B_4"</span>, <span class="fl">100</span>,</span>
<span>  <span class="st">"B_5"</span>, <span class="fl">100</span>,</span>
<span>  <span class="st">"B_6"</span>, <span class="fl">100</span>, </span>
<span>  <span class="st">"B_7"</span>, <span class="fl">100</span>,</span>
<span>  <span class="st">"B_8"</span>, <span class="fl">100</span>, </span>
<span>  <span class="st">"B_9"</span>, <span class="fl">100</span>, </span>
<span>  <span class="st">"B_10"</span>, <span class="fl">100</span>, </span>
<span>  <span class="st">"B_11"</span>, <span class="fl">100</span>, </span>
<span>  <span class="st">"B_12"</span>, <span class="fl">100</span>, </span>
<span>  <span class="st">"B_13"</span>, <span class="fl">100</span>,</span>
<span>  <span class="st">"B_14"</span>, <span class="fl">100</span>, </span>
<span>  <span class="st">"B_15"</span>, <span class="fl">100</span>, </span>
<span>  <span class="st">"B_16"</span>, <span class="fl">100</span>, </span>
<span>  <span class="st">"B_17"</span>, <span class="fl">100</span><span class="op">)</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="browse-data">Browse data<a class="anchor" aria-label="anchor" href="#browse-data"></a>
</h2>
<p>This chunk includes R commands to help you familiarise yourself with your dataset.</p>
</div>
<div class="section level2">
<h2 id="data-cleaning">Data cleaning<a class="anchor" aria-label="anchor" href="#data-cleaning"></a>
</h2>
<div class="section level3">
<h3 id="standardise-dates">Standardise dates<a class="anchor" aria-label="anchor" href="#standardise-dates"></a>
</h3>
<p>The goal with this code chunk is to convert all date columns to Date class so that R can handle them correctly. Here, again, we need to follow the instructions for “non-Kobo” because our data dictionary is not standard for MSF.</p>
<p>The default code uses the data dictionary to create a <code>DATEVARS</code> object, but we will comment that section to deactivate it, and instead use the “non-Kobo” method which searches for all columns that contain the word “date” or “Date”, and converts them to class Date.</p>
<p>To convert the dates to class “Date” we use the function <code>parse_date()</code> from the {parsedate} package. This function does not assume a standard format to the dates, and evaluates every data frame cell individually, using intelligent guessing to decide whether the date is written as Month-Day-Year, Day-Month-Year, or Year-Month-Day, etc.</p>
<p>The result of <code>parse_date()</code> is actually class “POSIXct” (a specific type of date class), so the result is piped to <code><a href="https://rdrr.io/r/base/as.Date.html" class="external-link">as.Date()</a></code> to convert it to a class that is more easily accepted by subsequent functions.</p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="co">## Kobo standard data --------------------------------------------------------</span></span>
<span><span class="co">## If you got your data from Kobo, use this portion of the code.</span></span>
<span><span class="co">## If not, comment this section out and use the below.</span></span>
<span></span>
<span><span class="co">## make sure all date variables are formatted as dates </span></span>
<span><span class="co">## get the names of variables which are dates</span></span>
<span><span class="co"># DATEVARS &lt;- study_data_dict %&gt;% </span></span>
<span><span class="co">#   filter(type == "date") %&gt;% </span></span>
<span><span class="co">#   filter(name %in% names(study_data_cleaned)) %&gt;% </span></span>
<span><span class="co">#   ## filter to match the column names of your data</span></span>
<span><span class="co">#   pull(name) # select date vars</span></span>
<span><span class="co"># </span></span>
<span><span class="co"># ## find if there are date variables which are completely empty</span></span>
<span><span class="co"># EMPTY_DATEVARS &lt;- purrr::map(DATEVARS, ~all(</span></span>
<span><span class="co">#   is.na(study_data_cleaned[[.x]])</span></span>
<span><span class="co">#   )) %&gt;% </span></span>
<span><span class="co">#   unlist() %&gt;% </span></span>
<span><span class="co">#   which()</span></span>
<span><span class="co"># </span></span>
<span><span class="co"># ## remove exclude the names of variables which are completely emptys</span></span>
<span><span class="co"># DATEVARS &lt;- DATEVARS[-EMPTY_DATEVARS]</span></span>
<span><span class="co"># </span></span>
<span><span class="co"># ## change to dates </span></span>
<span><span class="co"># ## use the parse_date() function to make a first pass at date variables.</span></span>
<span><span class="co"># ## parse_date() produces a complicated format - so we use as.Date() to simplify</span></span>
<span><span class="co"># study_data_cleaned &lt;- study_data_cleaned %&gt;%</span></span>
<span><span class="co">#   mutate(</span></span>
<span><span class="co">#     across(.cols = all_of(DATEVARS),</span></span>
<span><span class="co">#            .fns = ~parsedate::parse_date(.x) %&gt;% as.Date()))</span></span>
<span></span>
<span></span>
<span><span class="co">## Non-Kobo data -------------------------------------------------------------</span></span>
<span><span class="co">## Use this section if you did not have Kobo data. </span></span>
<span></span>
<span><span class="co"># use the parse_date() function to make a first pass at date variables.</span></span>
<span><span class="co"># parse_date() produces a complicated format - so we use as.Date() to simplify</span></span>
<span><span class="va">study_data_cleaned</span> <span class="op">&lt;-</span> <span class="va">study_data_cleaned</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">mutate</span><span class="op">(</span></span>
<span>    <span class="fu">across</span><span class="op">(</span>.cols <span class="op">=</span> <span class="fu">matches</span><span class="op">(</span><span class="st">"date|Date"</span><span class="op">)</span>,</span>
<span>           .fns  <span class="op">=</span> <span class="op">~</span><span class="fu">parsedate</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/parsedate/man/parse_date.html" class="external-link">parse_date</a></span><span class="op">(</span><span class="va">.x</span><span class="op">)</span> <span class="op">%&gt;%</span> <span class="fu"><a href="https://rdrr.io/r/base/as.Date.html" class="external-link">as.Date</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="define-recall-period">Define recall period<a class="anchor" aria-label="anchor" href="#define-recall-period"></a>
</h3>
<p>The next section of code to run defines the “recall period”.</p>
<p>In this vignette, the recall period is from 15 July 2020 to 15 July 2021, because this is indicated in the data dictionary questions about arrivals, departures, births, and deaths. *Therefore, we adjust the code so that for every entry in <code>study_data_cleaned</code> uses <code>as.Date("2020-07-15)</code> as the value in the new column <code>recall_start</code>, and uses <code>as.Date("2021-07-15")</code> as the value in the new column <code>recall_end</code>.</p>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## set the start/end of recall period</span></span>
<span><span class="co">## can be changed to date variables from dataset </span></span>
<span><span class="co">## (e.g. arrival date &amp; date questionnaire)</span></span>
<span><span class="va">study_data_cleaned</span> <span class="op">&lt;-</span> <span class="va">study_data_cleaned</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">mutate</span><span class="op">(</span>recall_start <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/as.Date.html" class="external-link">as.Date</a></span><span class="op">(</span><span class="st">"2020-07-15"</span><span class="op">)</span>,  </span>
<span>         recall_end   <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/as.Date.html" class="external-link">as.Date</a></span><span class="op">(</span><span class="st">"2021-07-15"</span><span class="op">)</span>   </span>
<span>  <span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="create-age-groups">Create age groups<a class="anchor" aria-label="anchor" href="#create-age-groups"></a>
</h3>
<p>Information on age is spread across two columns: <code>age_years</code> and <code>age_months</code>.</p>
<p>Unfortunately, the values in these columns have been interpreted by R as class “character” (words), and not as numbers.</p>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/class.html" class="external-link">class</a></span><span class="op">(</span><span class="va">study_data_cleaned</span><span class="op">$</span><span class="va">age_years</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "character"</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/class.html" class="external-link">class</a></span><span class="op">(</span><span class="va">study_data_cleaned</span><span class="op">$</span><span class="va">age_months</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "character"</span></span></code></pre></div>
<p>We can also review the dataset and see that if the age of respondents less than 1 year, the months are given in the <code>age_months</code> column but the <code>age_years</code> value is <code>NA</code> (missing). We will need the <code>age_years</code> column in this circumstance to have the value <code>0</code> for later calculations. So, we write and run the following command:</p>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">study_data_cleaned</span> <span class="op">&lt;-</span> <span class="va">study_data_cleaned</span> <span class="op">%&gt;%</span> </span>
<span>  </span>
<span>  <span class="co"># convert both columns to class integer</span></span>
<span>  <span class="fu">mutate</span><span class="op">(</span>age_years <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/integer.html" class="external-link">as.integer</a></span><span class="op">(</span><span class="va">age_years</span><span class="op">)</span>,</span>
<span>         age_months <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/integer.html" class="external-link">as.integer</a></span><span class="op">(</span><span class="va">age_months</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  </span>
<span>  <span class="co"># convert age_years to 0 if age_months is less than 12</span></span>
<span>  <span class="fu">mutate</span><span class="op">(</span>age_years <span class="op">=</span> <span class="fu">case_when</span><span class="op">(</span></span>
<span>    <span class="va">age_months</span> <span class="op">&lt;</span> <span class="fl">12</span> <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/base/integer.html" class="external-link">as.integer</a></span><span class="op">(</span><span class="fl">0</span><span class="op">)</span>,    <span class="co"># if age is less than 12 months, put 0</span></span>
<span>    <span class="cn">TRUE</span>            <span class="op">~</span> <span class="va">age_years</span>         <span class="co"># otherwise, leave as age_years value</span></span>
<span>  <span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>We can now run the subsequent commands as written, to create age group columns reflecting years and months.</p>
<p>The first command uses <code>mutate()</code> to create a column called <code>age_group</code>, using the function <code><a href="../reference/epikit-exports.html">age_categories()</a></code> from the {sitrep} package. This function can work in several ways, but we provide a list of break point values (“breakers”) for our age groups.</p>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## create an age group variable by specifying categorical breaks (of years)</span></span>
<span><span class="va">study_data_cleaned</span> <span class="op">&lt;-</span> <span class="va">study_data_cleaned</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">mutate</span><span class="op">(</span>age_group <span class="op">=</span> <span class="fu"><a href="../reference/epikit-exports.html">age_categories</a></span><span class="op">(</span><span class="va">age_years</span>, </span>
<span>                                    breakers <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">3</span>, <span class="fl">15</span>, <span class="fl">30</span>, <span class="fl">45</span><span class="op">)</span></span>
<span>                                    <span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>The second command in the template is very similar to the first, but looks at the column <code>age_months</code> and checks whether the age in months is less than 12. If so, it applies the same <code><a href="../reference/epikit-exports.html">age_categories()</a></code> function but uses break points more relevant to the months values (e.g. 6 months, 9 months, and 12 months). If the value in <code>age_months</code> is greater than 12, it is replaced with missing.</p>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## create age group variable for under 2 years based on months</span></span>
<span><span class="va">study_data_cleaned</span> <span class="op">&lt;-</span> <span class="va">study_data_cleaned</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">mutate</span><span class="op">(</span>age_group_mon <span class="op">=</span> <span class="fu">if_else</span><span class="op">(</span></span>
<span>    <span class="co">## if months &lt;= 12 then calculated age groups </span></span>
<span>    <span class="va">age_months</span> <span class="op">&lt;=</span> <span class="fl">12</span>, </span>
<span>    <span class="fu"><a href="../reference/epikit-exports.html">age_categories</a></span><span class="op">(</span><span class="va">study_data_cleaned</span><span class="op">$</span><span class="va">age_months</span>, </span>
<span>                                        breakers <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">6</span>, <span class="fl">9</span>, <span class="fl">12</span><span class="op">)</span>, </span>
<span>                                        ceiling <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>, </span>
<span>    <span class="co">## otherwise set new variable to missing</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="cn">NA</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>Finally, we run the last command in this chunk which creates a column <code>age_category</code> that combines the years groupings and the months groupings into one column, with a specified order.</p>
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## to combine different age categories use the following function </span></span>
<span><span class="co">## this prioritises the smaller unit, meaning:</span></span>
<span><span class="co">## it will order your age_category from smallest to largest unit </span></span>
<span><span class="co">## i.e. days first then months then years (depending on which are given)</span></span>
<span><span class="va">study_data_cleaned</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/epikit-exports.html">group_age_categories</a></span><span class="op">(</span><span class="va">study_data_cleaned</span>, </span>
<span>                                           years  <span class="op">=</span> <span class="va">age_group</span>,</span>
<span>                                           months <span class="op">=</span> <span class="va">age_group_mon</span><span class="op">)</span></span></code></pre></div>
<p>We can see this ordering if we run a quick table of the new column:</p>
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">study_data_cleaned</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">tabyl</span><span class="op">(</span><span class="va">age_category</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">adorn_pct_formatting</span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt;  age_category    n percent valid_percent</span></span>
<span><span class="co">#&gt;    0-5 months   47    1.6%          1.6%</span></span>
<span><span class="co">#&gt;    6-8 months   35    1.2%          1.2%</span></span>
<span><span class="co">#&gt;   9-12 months   36    1.2%          1.3%</span></span>
<span><span class="co">#&gt;     0-2 years  177    6.1%          6.2%</span></span>
<span><span class="co">#&gt;    3-14 years 1118   38.5%         38.9%</span></span>
<span><span class="co">#&gt;   15-29 years  723   24.9%         25.2%</span></span>
<span><span class="co">#&gt;   30-44 years  425   14.7%         14.8%</span></span>
<span><span class="co">#&gt;     45+ years  313   10.8%         10.9%</span></span>
<span><span class="co">#&gt;          &lt;NA&gt;   27    0.9%             -</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="using-a-data-dictionary-to-recode">Using a data dictionary to recode<a class="anchor" aria-label="anchor" href="#using-a-data-dictionary-to-recode"></a>
</h3>
<p>The datasets in this vignette already use the cleaned values, according to its data dictionary. For example, the town is recorded as “Town A” or “Town B”, not as town_a and town_b.</p>
<p>If your dataset contains values that are “raw”, unclean, or not in a display format, you can recode them using the data dictionary and the code in this chunk.</p>
<p>For example, looking in the data dictionary (<code>study_data_dict</code>) we can see that the column <code>option_name</code> contains values such as <code>diarrhoea</code> and <code>respiratory_infection</code> for the cause of death variable. In contrast, the <code>option_label</code> contains the display values “Diarrhoea” and “Respiratory infection”.</p>
<p>A command like the below would revise all the raw option values to their display label version, across the entire dataset. The function <code>match_df()</code> accepts the name of our data frame, and the dictionary, the columns in the data dictionary to guide the value conversion (<code>from =</code> and <code>to =</code>). Note that if provided in the data dictionary, you could also run the code with <code>to = "option_label_french"</code> to convert the values to French.</p>
<p>Again - it is <strong>NOT</strong> necessary to run this code for this vignette because the values are already in display format.</p>
<div class="sourceCode" id="cb29"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## recode values with matchmaker package (value labels cant be used for analysis) </span></span>
<span><span class="va">study_data_cleaned</span> <span class="op">&lt;-</span> <span class="fu">match_df</span><span class="op">(</span><span class="va">study_data_cleaned</span>, </span>
<span>         <span class="va">study_data_dict</span>, </span>
<span>         from <span class="op">=</span> <span class="st">"option_name"</span>, </span>
<span>         to <span class="op">=</span> <span class="st">"option_label"</span>, </span>
<span>         by <span class="op">=</span> <span class="st">"name"</span>, </span>
<span>         order <span class="op">=</span> <span class="st">"option_order_in_set"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="clean-factor-variables">Clean factor variables<a class="anchor" aria-label="anchor" href="#clean-factor-variables"></a>
</h3>
<p>In R, factors are a column class that indicates an ordinal variable - that is, a variable with values that should have an intrinsic order to them. You can read more about factors in this <a href="https://epirhandbook.com/en/factors.html" class="external-link">Epi R Handbook chapter</a></p>
<p>The first R code deals with the column called <code>consent</code>, which is present in our dataset. the code converts it from “Yes” or “No” to <code>TRUE</code> or <code>FALSE</code>. It does this by leveraging a behavior of the <code>mutate()</code> function, that if you provide a logical statement (<code>consent == "Yes"</code>) then it will return <code>TRUE</code> or <code>FALSE</code>.</p>
<div class="sourceCode" id="cb30"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">study_data_cleaned</span> <span class="op">&lt;-</span> <span class="va">study_data_cleaned</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">mutate</span><span class="op">(</span>consent <span class="op">=</span> <span class="va">consent</span> <span class="op">==</span> <span class="st">"Yes"</span><span class="op">)</span></span></code></pre></div>
<p>This change is also applied to the <code>died</code> column:</p>
<div class="sourceCode" id="cb31"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">study_data_cleaned</span> <span class="op">&lt;-</span> <span class="va">study_data_cleaned</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">mutate</span><span class="op">(</span>died <span class="op">=</span> <span class="va">died</span> <span class="op">==</span> <span class="st">"Yes"</span><span class="op">)</span></span></code></pre></div>
<p>Subsequent commands in this code chunk show you how to clean categorical variables that may have a specific order. We do not need to do any of these remaining steps, so you should comment out all the remaining code in this chunk. Nevertheless, below is some text explaining them and guiding you to further resources.</p>
<p>You can recode character values using <code>case_when()</code>. You can read more about this in the Data Cleaning chapter of the Epi R Handbook.</p>
<p>Another command in this code chunk will show you how to use <code>fct_explicit_na()</code> to convert <code>NA</code> to a specific word such as “Not applicable”. You can also read about this in the Factors chapter of the Epidemiologist R Handbook.</p>
<p>The “fix factor levels” command demonstrates how to set the “order” for a specific categorical variable.</p>
</div>
<div class="section level3">
<h3 id="observation-time">Observation time<a class="anchor" aria-label="anchor" href="#observation-time"></a>
</h3>
<p>For rows where it is possible, we need to calculate the observation time. There are several helper functions to assist with this:</p>
<ul>
<li><p><code><a href="../reference/epikit-exports.html">find_start_date()</a></code> below is set to look in columns <code>date_birth</code> (most important) and <code>date_arrived</code> (secondary importance) for dates within the constraints of the columns <code>recall_start</code> and <code>recall_end</code>. The function will create the new columns <code>startdate</code> and <code>startcause</code>.</p></li>
<li><p><code><a href="../reference/epikit-exports.html">find_end_date()</a></code> performs the similar action but for the dates in column <code>date_left</code> and <code>date_death</code>, creating columns <code>enddate</code> and <code>endcause</code>.</p></li>
</ul>
<div class="sourceCode" id="cb32"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="co">## create new variables for start and end dates/causes</span></span>
<span><span class="va">study_data_cleaned</span> <span class="op">&lt;-</span> <span class="va">study_data_cleaned</span> <span class="op">%&gt;%</span></span>
<span>  <span class="co">## choose earliest date entered in survey</span></span>
<span>  <span class="co">## from births, household arrivals, and camp arrivals </span></span>
<span>  <span class="fu"><a href="../reference/epikit-exports.html">find_start_date</a></span><span class="op">(</span><span class="st">"date_birth"</span>,</span>
<span>                  <span class="st">"date_arrived"</span>,</span>
<span>                  <span class="st">"recall_start"</span>,</span>
<span>                  period_start <span class="op">=</span> <span class="st">"recall_start"</span>,</span>
<span>                  period_end   <span class="op">=</span> <span class="st">"recall_end"</span>,</span>
<span>                  datecol      <span class="op">=</span> <span class="st">"startdate"</span>,</span>
<span>                  datereason   <span class="op">=</span> <span class="st">"startcause"</span> </span>
<span>                 <span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="co">## choose latest date entered in survey</span></span>
<span>  <span class="co">## from camp departures, death and end of the study</span></span>
<span>  <span class="fu"><a href="../reference/epikit-exports.html">find_end_date</a></span><span class="op">(</span><span class="st">"date_left"</span>,</span>
<span>                <span class="st">"date_death"</span>,</span>
<span>                <span class="st">"recall_end"</span>,</span>
<span>                period_start <span class="op">=</span> <span class="st">"recall_start"</span>,</span>
<span>                period_end   <span class="op">=</span> <span class="st">"recall_end"</span>,</span>
<span>                datecol      <span class="op">=</span> <span class="st">"enddate"</span>,</span>
<span>                datereason   <span class="op">=</span> <span class="st">"endcause"</span> </span>
<span>               <span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="co">## label those that were present at the start/end (except births/deaths)</span></span>
<span>  <span class="fu">mutate</span><span class="op">(</span>startcause <span class="op">=</span> <span class="fu">if_else</span><span class="op">(</span><span class="va">startdate</span> <span class="op">==</span> <span class="va">recall_start</span> <span class="op">&amp;</span> <span class="va">startcause</span> <span class="op">!=</span> <span class="st">"birthday_date"</span>,</span>
<span>                              <span class="st">"Present at start"</span>, <span class="va">startcause</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">mutate</span><span class="op">(</span>endcause <span class="op">=</span> <span class="fu">if_else</span><span class="op">(</span><span class="va">enddate</span> <span class="op">==</span> <span class="va">recall_end</span> <span class="op">&amp;</span> <span class="va">endcause</span> <span class="op">!=</span> <span class="st">"death_date"</span>, </span>
<span>                            <span class="st">"Present at end"</span>, <span class="va">endcause</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>These <code>fct_recode()</code> functions are changing the values in these “cause” columns to be more human readable.</p>
<div class="sourceCode" id="cb33"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## fix factor levels -----------------------------------------------------------</span></span>
<span></span>
<span><span class="co">## make sure there are the appropriate levels (names)</span></span>
<span><span class="va">study_data_cleaned</span><span class="op">$</span><span class="va">startcause</span> <span class="op">&lt;-</span> <span class="fu">fct_recode</span><span class="op">(</span><span class="va">study_data_cleaned</span><span class="op">$</span><span class="va">startcause</span>,</span>
<span>                                            <span class="st">"Present at start"</span> <span class="op">=</span> <span class="st">"Present at start"</span>,</span>
<span>                                            <span class="st">"Born"</span> <span class="op">=</span> <span class="st">"date_birth"</span>,</span>
<span>                                            <span class="st">"Other arrival"</span> <span class="op">=</span> <span class="st">"date_arrived"</span></span>
<span>                                           <span class="op">)</span></span>
<span></span>
<span><span class="co">## make sure there are the appropriate levels (names)</span></span>
<span><span class="va">study_data_cleaned</span><span class="op">$</span><span class="va">endcause</span> <span class="op">&lt;-</span> <span class="fu">fct_recode</span><span class="op">(</span><span class="va">study_data_cleaned</span><span class="op">$</span><span class="va">endcause</span>,</span>
<span>                                          <span class="st">"Present at end"</span> <span class="op">=</span> <span class="st">"Present at end"</span>,</span>
<span>                                          <span class="st">"Died"</span> <span class="op">=</span> <span class="st">"date_death"</span>,</span>
<span>                                          <span class="st">"Other departure"</span> <span class="op">=</span> <span class="st">"date_left"</span><span class="op">)</span></span></code></pre></div>
<p>This <code>mutate()</code> command creates the column <code>obstime</code> which is the number of days between the start and end dates for each individual.</p>
<div class="sourceCode" id="cb34"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## Define observation time in days</span></span>
<span><span class="va">study_data_cleaned</span> <span class="op">&lt;-</span> <span class="va">study_data_cleaned</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">mutate</span><span class="op">(</span>obstime <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="va">enddate</span> <span class="op">-</span> <span class="va">startdate</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>Running some summary statistics on these data show that most rows did not have births or deaths, and so their observation time reverted to the default of the recall period (1 year).</p>
<div class="sourceCode" id="cb35"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">study_data_cleaned</span><span class="op">$</span><span class="va">obstime</span><span class="op">)</span></span>
<span><span class="co">#&gt;    Min. 1st Qu.  Median    Mean 3rd Qu.    Max. </span></span>
<span><span class="co">#&gt;     0.0   365.0   365.0   350.2   365.0   365.0</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="labelling-columns">Labelling columns<a class="anchor" aria-label="anchor" href="#labelling-columns"></a>
</h3>
<p>Earlier, we used the {matchmaker} package to clean the <em>values</em> in columns, using the data dictionary. In this chunk, we use the {labelled} package to assign labels to the <em>column names (headings)</em>, so that when printed they display names with spaces and other human-readable formatting.</p>
<p>We will use the code for manual labelling, because we have adjusted our columns names so they no longer align with our data dictionary.</p>
<div class="sourceCode" id="cb36"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## it is possible to update individual variables manually too</span></span>
<span><span class="va">study_data_cleaned</span> <span class="op">&lt;-</span> <span class="va">study_data_cleaned</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">set_variable_labels</span><span class="op">(</span></span>
<span>    <span class="co">## variable name = variable label </span></span>
<span>    age_years     <span class="op">=</span> <span class="st">"Age (years)"</span>,</span>
<span>    age_group     <span class="op">=</span> <span class="st">"Age group (years)"</span>,</span>
<span>    age_months    <span class="op">=</span> <span class="st">"Age (months)"</span>, </span>
<span>    age_group_mon <span class="op">=</span> <span class="st">"Age group (months)"</span>,</span>
<span>    age_category  <span class="op">=</span> <span class="st">"Age category"</span>, </span>
<span>    died          <span class="op">=</span> <span class="st">"Died"</span>, </span>
<span>    startcause    <span class="op">=</span> <span class="st">"Observation start"</span>, </span>
<span>    endcause      <span class="op">=</span> <span class="st">"Observation end"</span></span>
<span>    <span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="remove-unused-data">Remove unused data<a class="anchor" aria-label="anchor" href="#remove-unused-data"></a>
</h3>
<p>This chunk contains code to drop and examine rows for which there is no consent, there are missing start or end dates, village name (town A or B) is “Other”, age is missing, or sex is missing. These rows are first saved as <code>dropped</code>. This allows you to inspect them before actually dropping the rows.</p>
<p>In the second command, an <code>anti_join()</code> is used to actually drop the rows from <code>study_data_cleaned</code>. An anti join is a “filtering join” which looks in the <code>dropped</code> data frame and leaves only rows in <code>study_data_cleaned</code> which are <em>not</em> present in <code>dropped</code>. Its a fancy way of doing a filter, but allowing you the opportunity to inspect the rows first.</p>
<div class="sourceCode" id="cb37"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## store the cases that you drop so you can describe them (e.g. non-consenting </span></span>
<span><span class="co">## or wrong village/cluster)</span></span>
<span><span class="va">dropped</span> <span class="op">&lt;-</span> <span class="va">study_data_cleaned</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="op">!</span><span class="va">consent</span> <span class="op">|</span> <span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">startdate</span><span class="op">)</span> <span class="op">|</span> <span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">enddate</span><span class="op">)</span> <span class="op">|</span> </span>
<span>           <span class="co">## note that whatever you use for weights cannot be missing!</span></span>
<span>           <span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">health_district</span><span class="op">)</span> <span class="op">|</span> <span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">age_years</span><span class="op">)</span> <span class="op">|</span> <span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">sex</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## use the dropped cases to remove the unused rows from the survey data set  </span></span>
<span><span class="va">study_data_cleaned</span> <span class="op">&lt;-</span> <span class="fu">anti_join</span><span class="op">(</span><span class="va">study_data_cleaned</span>, <span class="va">dropped</span>, by <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">dropped</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>We can see how many rows were dropped:</p>
<div class="sourceCode" id="cb38"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">dropped</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 27</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="drop-duplicates">Drop duplicates<a class="anchor" aria-label="anchor" href="#drop-duplicates"></a>
</h3>
<p>Deduplication is a complicated topic. We suggest you review the Epi R Handbook chapter on <a href="https://epirhandbook.com/en/de-duplication.html" class="external-link">Deduplication</a> if you want to seriously approach this topic.</p>
<p>In this code chunk, a simple deduplication command is offered using the <code>distinct()</code> function. In this example, for any rows that have identical <code>uid</code>, <code>sex</code>, AND <code>age_group</code>, only the first row is kept. The <code>.keep_all = TRUE</code> refers to the <em>columns</em> and ensures that all columns are kept, not only the ones you used to assess duplicates.</p>
<div class="sourceCode" id="cb39"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## option 1: only keep the first occurrence of duplicate case </span></span>
<span><span class="va">study_data_cleaned</span> <span class="op">&lt;-</span> <span class="va">study_data_cleaned</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="co">## find duplicates based on case number, sex and age group </span></span>
<span>  <span class="co">## only keep the first occurrence </span></span>
<span>  <span class="fu">distinct</span><span class="op">(</span><span class="va">uid</span>, <span class="va">sex</span>, <span class="va">age_group</span>, .keep_all <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span>  </span></code></pre></div>
<p>A second option available to you is commented out. This option allows you to inspect duplicates before they are filtered/removed.</p>
</div>
<div class="section level3">
<h3 id="survey-weights">Survey weights<a class="anchor" aria-label="anchor" href="#survey-weights"></a>
</h3>
<p>These data come from a cluster survey, but because we have population counts for age and sex, we are able to make adjustments to better reflect the population, and therefore produce stratified estimates by age and sex.</p>
<div class="sourceCode" id="cb40"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="co">## create a variable called "surv_weight_strata" </span></span>
<span><span class="co">## contains weights for each individual - by age group, sex and health district</span></span>
<span><span class="va">study_data_cleaned</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/epikit-exports.html">add_weights_strata</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">study_data_cleaned</span>, </span>
<span>                                         p <span class="op">=</span> <span class="va">population_data_age</span>, </span>
<span>                                         surv_weight <span class="op">=</span> <span class="st">"surv_weight_strata"</span>,</span>
<span>                                         surv_weight_ID <span class="op">=</span> <span class="st">"surv_weight_ID_strata"</span>,</span>
<span>                                         <span class="va">age_group</span>, <span class="va">sex</span>, <span class="va">health_district</span><span class="op">)</span></span></code></pre></div>
<p>In the second set of commands:</p>
<ul>
<li>The data frame <code>cluster_counts</code> is referenced, which we created in an earlier step. The arguments that end with <code>_cl</code> should reference columns in this data frame. Use the help documentation for this function by running <code><a href="../reference/epikit-exports.html">?add_weights_cluster</a></code>.</li>
</ul>
<div class="sourceCode" id="cb41"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## cluster ---------------------------------------------------------------------</span></span>
<span></span>
<span><span class="co">## get the number of individuals interviewed per household </span></span>
<span><span class="co">## adds a variable with counts of the household (parent) index variable</span></span>
<span><span class="va">study_data_cleaned</span> <span class="op">&lt;-</span> <span class="va">study_data_cleaned</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">add_count</span><span class="op">(</span><span class="va">index</span>, name <span class="op">=</span> <span class="st">"interviewed"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">study_data_cleaned</span> <span class="op">&lt;-</span> <span class="va">study_data_cleaned</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">mutate</span><span class="op">(</span>member_number <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="va">member_number</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="co">## create cluster weights </span></span>
<span><span class="va">study_data_cleaned</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/epikit-exports.html">add_weights_cluster</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">study_data_cleaned</span>, </span>
<span>                                          cl <span class="op">=</span> <span class="va">cluster_counts</span>, </span>
<span>                                          eligible <span class="op">=</span> <span class="va">member_number</span>, </span>
<span>                                          interviewed <span class="op">=</span> <span class="va">interviewed</span>, </span>
<span>                                          cluster_x <span class="op">=</span> <span class="va">cluster_number_uid</span>, </span>
<span>                                          cluster_cl <span class="op">=</span> <span class="va">cluster</span>, </span>
<span>                                          household_x <span class="op">=</span> <span class="va">id</span>, </span>
<span>                                          household_cl <span class="op">=</span> <span class="va">households</span>, </span>
<span>                                          surv_weight <span class="op">=</span> <span class="st">"surv_weight_cluster"</span>, </span>
<span>                                          surv_weight_ID <span class="op">=</span> <span class="st">"surv_weight_ID_cluster"</span>, </span>
<span>                                          ignore_cluster <span class="op">=</span> <span class="cn">FALSE</span>, </span>
<span>                                          ignore_household <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## stratified and cluster ------------------------------------------------------</span></span>
<span></span>
<span><span class="co">## create a survey weight for cluster and strata </span></span>
<span><span class="va">study_data_cleaned</span> <span class="op">&lt;-</span> <span class="va">study_data_cleaned</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">mutate</span><span class="op">(</span>surv_weight_cluster_strata <span class="op">=</span> <span class="va">surv_weight_strata</span> <span class="op">*</span> <span class="va">surv_weight_cluster</span><span class="op">)</span></span></code></pre></div>
<p>In the next chunk, we use only the “stratified cluster” code:</p>
<ul>
<li>We change <code>village_name</code> to <code>cluster_number_uid</code>, which is our unique cluster ID column.</li>
</ul>
<div class="sourceCode" id="cb42"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="co">## simple random ---------------------------------------------------------------</span></span>
<span><span class="co"># </span></span>
<span><span class="co"># survey_design_simple &lt;- study_data_cleaned %&gt;% </span></span>
<span><span class="co">#   as_survey_design(ids = 1, # 1 for no cluster ids </span></span>
<span><span class="co">#                    weights = NULL, # No weight added</span></span>
<span><span class="co">#                    strata = NULL # sampling was simple (no strata)</span></span>
<span><span class="co">#                   )</span></span>
<span><span class="co"># </span></span>
<span><span class="co"># ## stratified ------------------------------------------------------------------</span></span>
<span><span class="co"># </span></span>
<span><span class="co"># survey_design_strata &lt;- study_data_cleaned %&gt;% </span></span>
<span><span class="co">#   as_survey_design(ids = 1, # 1 for no cluster ids </span></span>
<span><span class="co">#                    weights = surv_weight_strata, # weight variable created above </span></span>
<span><span class="co">#                    strata = health_district # sampling was stratified by district</span></span>
<span><span class="co">#                   )</span></span>
<span><span class="co"># </span></span>
<span><span class="co"># ## cluster ---------------------------------------------------------------------</span></span>
<span><span class="co"># </span></span>
<span><span class="co"># survey_design_cluster &lt;- study_data_cleaned %&gt;% </span></span>
<span><span class="co">#   as_survey_design(ids = village_name, # cluster ids </span></span>
<span><span class="co">#                    weights = surv_weight_cluster, # weight variable created above </span></span>
<span><span class="co">#                    strata = NULL # sampling was simple (no strata)</span></span>
<span><span class="co">#                   )</span></span>
<span></span>
<span><span class="co">## stratified cluster ----------------------------------------------------------</span></span>
<span></span>
<span><span class="va">survey_design</span> <span class="op">&lt;-</span> <span class="va">study_data_cleaned</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">as_survey_design</span><span class="op">(</span>ids <span class="op">=</span> <span class="va">cluster_number_uid</span>, <span class="co"># cluster ids </span></span>
<span>                   weights <span class="op">=</span> <span class="va">surv_weight_cluster_strata</span>, <span class="co"># weight variable created above </span></span>
<span>                   strata <span class="op">=</span> <span class="va">health_district</span> <span class="co"># sampling was stratified by district</span></span>
<span>                  <span class="op">)</span></span></code></pre></div>
<p>Run these to get the number of distinct Again, adapt <code>cluster_number</code> to <code>cluster_number_uid</code>.</p>
<div class="sourceCode" id="cb43"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="co">## get counts of number of clusters </span></span>
<span><span class="va">num_clus</span> <span class="op">&lt;-</span> <span class="va">study_data_cleaned</span> <span class="op">%&gt;%</span></span>
<span>  <span class="co">## trim data to unique clusters</span></span>
<span>  <span class="fu">distinct</span><span class="op">(</span><span class="va">cluster_number_uid</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="co">## get number of rows (count how many unique)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## get counts of number households </span></span>
<span><span class="va">num_hh</span> <span class="op">&lt;-</span> <span class="va">study_data_cleaned</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="co">## get unique houses by cluster</span></span>
<span>  <span class="fu">distinct</span><span class="op">(</span><span class="va">cluster_number</span>, <span class="va">id</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="co">## get number of rounds (count how many unique)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p>Print to view</p>
<div class="sourceCode" id="cb44"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">num_clus</span></span>
<span><span class="co">#&gt; [1] 30</span></span>
<span></span>
<span><span class="va">num_hh</span></span>
<span><span class="co">#&gt; [1] 397</span></span></code></pre></div>
<p>The dynamic text in the report will read as:</p>
<p>We included 397 households across 30 clusters in this survey analysis.</p>
<p>Among the 27 individuals excluded from the survey analysis, 0 (0.0%) individuals were excluded due to missing start- or end-dates and 2 (7.4%) were excluded for lack of consent. The reasons for no consent are shown below.</p>
<p>In our dataset, the reason for refusal was not collected, so the next section is not relevant.</p>
<div class="sourceCode" id="cb45"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="co">## get counts of the number of households per cluster</span></span>
<span><span class="va">clustersize</span> <span class="op">&lt;-</span> <span class="va">study_data_cleaned</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="co">## trim data to only unique households within each cluster</span></span>
<span>  <span class="fu">distinct</span><span class="op">(</span><span class="va">cluster_number_uid</span>, <span class="va">id</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="co">## count the number of households within each cluster</span></span>
<span>  <span class="fu">count</span><span class="op">(</span><span class="va">cluster_number_uid</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">pull</span><span class="op">(</span><span class="va">n</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## get the median number of households per cluster</span></span>
<span><span class="va">clustermed</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/median.html" class="external-link">median</a></span><span class="op">(</span><span class="va">clustersize</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## get the min and max number of households per cluster</span></span>
<span><span class="co">## paste these together seperated by a dash </span></span>
<span><span class="va">clusterrange</span> <span class="op">&lt;-</span> <span class="fu">str_c</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/range.html" class="external-link">range</a></span><span class="op">(</span><span class="va">clustersize</span><span class="op">)</span>, collapse <span class="op">=</span> <span class="st">"--"</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## get counts of children per household </span></span>
<span><span class="co">## do this by cluster as household IDs are only unique within clusters</span></span>
<span><span class="va">hhsize</span> <span class="op">&lt;-</span> <span class="va">study_data_cleaned</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">count</span><span class="op">(</span><span class="va">cluster_number_uid</span>, <span class="va">id</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">pull</span><span class="op">(</span><span class="va">n</span><span class="op">)</span> </span>
<span></span>
<span><span class="co">## get median number of children per household</span></span>
<span><span class="va">hhmed</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/median.html" class="external-link">median</a></span><span class="op">(</span><span class="va">hhsize</span><span class="op">)</span></span>
<span><span class="co">## get the min and max number of children per household</span></span>
<span><span class="co">## paste these together seperated by a dash </span></span>
<span><span class="va">hhrange</span> <span class="op">&lt;-</span> <span class="fu">str_c</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/range.html" class="external-link">range</a></span><span class="op">(</span><span class="va">hhsize</span><span class="op">)</span>, collapse <span class="op">=</span> <span class="st">"--"</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## get standard deviation </span></span>
<span><span class="va">hhsd</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/sd.html" class="external-link">sd</a></span><span class="op">(</span><span class="va">hhsize</span><span class="op">)</span>, digits <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span></code></pre></div>
<p>The median number of households per cluster was 13, with a range of 1–39. The median number of children per household was 7 (range: 2–21, standard deviation: 2.8).</p>
</div>
</div>
<div class="section level2">
<h2 id="demographic-information">Demographic information<a class="anchor" aria-label="anchor" href="#demographic-information"></a>
</h2>
<div class="sourceCode" id="cb46"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## counts and props of the study population</span></span>
<span><span class="va">ag</span> <span class="op">&lt;-</span> <span class="fu">tabyl</span><span class="op">(</span><span class="va">study_data_cleaned</span>, <span class="va">age_group</span>, show_na <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">mutate</span><span class="op">(</span>n_total <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">n</span><span class="op">)</span>, </span>
<span>         age_group <span class="op">=</span> <span class="fu">fct_inorder</span><span class="op">(</span><span class="va">age_group</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="co">## counts and props of the source population</span></span>
<span><span class="va">propcount</span> <span class="op">&lt;-</span> <span class="va">population_data_age</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">group_by</span><span class="op">(</span><span class="va">age_group</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>    <span class="fu">tally</span><span class="op">(</span><span class="va">population</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>    <span class="fu">mutate</span><span class="op">(</span>percent <span class="op">=</span> <span class="va">n</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">n</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## bind together the columns of two tables, group by age, and perform a </span></span>
<span><span class="co">## binomial test to see if n/total is significantly different from population</span></span>
<span><span class="co">## proportion.</span></span>
<span>  <span class="co">## suffix here adds to text to the end of columns in each of the two datasets</span></span>
<span><span class="fu">left_join</span><span class="op">(</span><span class="va">ag</span>, <span class="va">propcount</span>, by <span class="op">=</span> <span class="st">"age_group"</span>, suffix <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">""</span>, <span class="st">"_pop"</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">group_by</span><span class="op">(</span><span class="va">age_group</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span></span>
<span>  <span class="co">## broom::tidy(binom.test()) makes a data frame out of the binomial test and</span></span>
<span>  <span class="co">## will add the variables p.value, parameter, conf.low, conf.high, method, and</span></span>
<span>  <span class="co">## alternative. We will only use p.value here. You can include other</span></span>
<span>  <span class="co">## columns if you want to report confidence intervals</span></span>
<span>  <span class="fu">mutate</span><span class="op">(</span>binom <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fu">broom</span><span class="fu">::</span><span class="fu"><a href="https://generics.r-lib.org/reference/tidy.html" class="external-link">tidy</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/binom.test.html" class="external-link">binom.test</a></span><span class="op">(</span><span class="va">n</span>, <span class="va">n_total</span>, <span class="va">percent_pop</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">unnest</span><span class="op">(</span>cols <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">binom</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span> <span class="co"># important for expanding the binom.test data frame</span></span>
<span>  <span class="fu">mutate</span><span class="op">(</span></span>
<span>    <span class="fu">across</span><span class="op">(</span>.cols <span class="op">=</span> <span class="fu">contains</span><span class="op">(</span><span class="st">"percent"</span><span class="op">)</span>, </span>
<span>            .fns <span class="op">=</span> <span class="op">~</span><span class="va">.x</span> <span class="op">*</span> <span class="fl">100</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span></span>
<span>  <span class="co">## Adjusting the p-values to correct for false positives </span></span>
<span>  <span class="co">## (because testing multiple age groups). This will only make </span></span>
<span>  <span class="co">## a difference if you have many age categories</span></span>
<span>  <span class="fu">mutate</span><span class="op">(</span>p.value <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/p.adjust.html" class="external-link">p.adjust</a></span><span class="op">(</span><span class="va">p.value</span>, method <span class="op">=</span> <span class="st">"holm"</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>                      </span>
<span>  <span class="co">## Only show p-values over 0.001 (those under report as &lt;0.001)</span></span>
<span>  <span class="fu">mutate</span><span class="op">(</span>p.value <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="va">p.value</span> <span class="op">&lt;</span> <span class="fl">0.001</span>, <span class="st">"&lt;0.001"</span>, <span class="fu"><a href="https://rdrr.io/r/base/character.html" class="external-link">as.character</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">p.value</span>, <span class="fl">3</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span></span>
<span>  <span class="co">## rename the columns appropriately</span></span>
<span>  <span class="fu">select</span><span class="op">(</span></span>
<span>    <span class="st">"Age group"</span> <span class="op">=</span> <span class="va">age_group</span>,</span>
<span>    <span class="st">"Study population (n)"</span> <span class="op">=</span> <span class="va">n</span>,</span>
<span>    <span class="st">"Study population (%)"</span> <span class="op">=</span> <span class="va">percent</span>,</span>
<span>    <span class="st">"Source population (n)"</span> <span class="op">=</span> <span class="va">n_pop</span>,</span>
<span>    <span class="st">"Source population (%)"</span> <span class="op">=</span> <span class="va">percent_pop</span>,</span>
<span>    <span class="st">"P-value"</span> <span class="op">=</span> <span class="va">p.value</span></span>
<span>  <span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="co"># produce styled output table with auto-adjusted column widths with {flextable}</span></span>
<span>  <span class="fu">qflextable</span><span class="op">(</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="co"># make header text bold (using {flextable})</span></span>
<span>  <span class="fu">bold</span><span class="op">(</span>part <span class="op">=</span> <span class="st">"header"</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="co"># make your table fit to the maximum width of the word document</span></span>
<span>  <span class="fu">set_table_properties</span><span class="op">(</span>layout <span class="op">=</span> <span class="st">"autofit"</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="co">## set to only show 1 decimal place </span></span>
<span>  <span class="fu">colformat_double</span><span class="op">(</span>digits <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span></code></pre></div>
<template id="1b30d45c-756d-4956-babe-720a27e85e8a"><style>
.tabwid table{
  border-spacing:0px !important;
  border-collapse:collapse;
  line-height:1;
  margin-left:auto;
  margin-right:auto;
  border-width: 0;
  display: table;
  border-color: transparent;
  caption-side: top;
}
.tabwid-caption-bottom table{
  caption-side: bottom;
}
.tabwid_left table{
  margin-left:0;
}
.tabwid_right table{
  margin-right:0;
}
.tabwid td {
    padding: 0;
}
.tabwid a {
  text-decoration: none;
}
.tabwid thead {
    background-color: transparent;
}
.tabwid tfoot {
    background-color: transparent;
}
.tabwid table tr {
background-color: transparent;
}
.katex-display {
    margin: 0 0 !important;
}
</style>
<div class="tabwid">
<style>.cl-16767cc2{table-layout:auto;}.cl-1664a5c4{font-family:'Helvetica';font-size:11pt;font-weight:bold;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-1664a5f6{font-family:'Helvetica';font-size:11pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-166c44b4{margin:0;text-align:left;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-166c44be{margin:0;text-align:right;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-166c64e4{background-color:transparent;vertical-align: middle;border-bottom: 2pt solid rgba(102, 102, 102, 1.00);border-top: 2pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-166c64ee{background-color:transparent;vertical-align: middle;border-bottom: 2pt solid rgba(102, 102, 102, 1.00);border-top: 2pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-166c64f8{background-color:transparent;vertical-align: middle;border-bottom: 2pt solid rgba(102, 102, 102, 1.00);border-top: 2pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-166c64f9{background-color:transparent;vertical-align: middle;border-bottom: 2pt solid rgba(102, 102, 102, 1.00);border-top: 2pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-166c6502{background-color:transparent;vertical-align: middle;border-bottom: 2pt solid rgba(102, 102, 102, 1.00);border-top: 2pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-166c6503{background-color:transparent;vertical-align: middle;border-bottom: 2pt solid rgba(102, 102, 102, 1.00);border-top: 2pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-166c6504{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-166c650c{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-166c650d{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-166c650e{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-166c650f{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-166c6516{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-166c6517{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-166c6520{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-166c6521{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-166c652a{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-166c652b{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-166c652c{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-166c6534{background-color:transparent;vertical-align: middle;border-bottom: 2pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-166c6535{background-color:transparent;vertical-align: middle;border-bottom: 2pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-166c653e{background-color:transparent;vertical-align: middle;border-bottom: 2pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-166c653f{background-color:transparent;vertical-align: middle;border-bottom: 2pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-166c6548{background-color:transparent;vertical-align: middle;border-bottom: 2pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-166c6549{background-color:transparent;vertical-align: middle;border-bottom: 2pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}</style>
<table class="table cl-16767cc2">
<thead><tr style="overflow-wrap:break-word;">
<td class="cl-166c64e4"><p class="cl-166c44b4"><span class="cl-1664a5c4">Age group</span></p></td>
<td class="cl-166c64ee"><p class="cl-166c44be"><span class="cl-1664a5c4">Study population (n)</span></p></td>
<td class="cl-166c64f8"><p class="cl-166c44be"><span class="cl-1664a5c4">Study population (%)</span></p></td>
<td class="cl-166c64f9"><p class="cl-166c44be"><span class="cl-1664a5c4">Source population (n)</span></p></td>
<td class="cl-166c6502"><p class="cl-166c44be"><span class="cl-1664a5c4">Source population (%)</span></p></td>
<td class="cl-166c6503"><p class="cl-166c44b4"><span class="cl-1664a5c4">P-value</span></p></td>
</tr></thead>
<tbody>
<tr style="overflow-wrap:break-word;">
<td class="cl-166c6504"><p class="cl-166c44b4"><span class="cl-1664a5f6">0-2</span></p></td>
<td class="cl-166c650c"><p class="cl-166c44be"><span class="cl-1664a5f6">295</span></p></td>
<td class="cl-166c650d"><p class="cl-166c44be"><span class="cl-1664a5f6">10.3</span></p></td>
<td class="cl-166c650e"><p class="cl-166c44be"><span class="cl-1664a5f6">1,360.0</span></p></td>
<td class="cl-166c650f"><p class="cl-166c44be"><span class="cl-1664a5f6">6.8</span></p></td>
<td class="cl-166c6516"><p class="cl-166c44b4"><span class="cl-1664a5f6">&lt;0.001</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-166c6517"><p class="cl-166c44b4"><span class="cl-1664a5f6">3-14</span></p></td>
<td class="cl-166c6520"><p class="cl-166c44be"><span class="cl-1664a5f6">1,118</span></p></td>
<td class="cl-166c6521"><p class="cl-166c44be"><span class="cl-1664a5f6">38.9</span></p></td>
<td class="cl-166c652a"><p class="cl-166c44be"><span class="cl-1664a5f6">7,244.0</span></p></td>
<td class="cl-166c652b"><p class="cl-166c44be"><span class="cl-1664a5f6">36.2</span></p></td>
<td class="cl-166c652c"><p class="cl-166c44b4"><span class="cl-1664a5f6">0.003</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-166c6517"><p class="cl-166c44b4"><span class="cl-1664a5f6">15-29</span></p></td>
<td class="cl-166c6520"><p class="cl-166c44be"><span class="cl-1664a5f6">723</span></p></td>
<td class="cl-166c6521"><p class="cl-166c44be"><span class="cl-1664a5f6">25.2</span></p></td>
<td class="cl-166c652a"><p class="cl-166c44be"><span class="cl-1664a5f6">5,520.0</span></p></td>
<td class="cl-166c652b"><p class="cl-166c44be"><span class="cl-1664a5f6">27.6</span></p></td>
<td class="cl-166c652c"><p class="cl-166c44b4"><span class="cl-1664a5f6">0.003</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-166c6517"><p class="cl-166c44b4"><span class="cl-1664a5f6">30-44</span></p></td>
<td class="cl-166c6520"><p class="cl-166c44be"><span class="cl-1664a5f6">425</span></p></td>
<td class="cl-166c6521"><p class="cl-166c44be"><span class="cl-1664a5f6">14.8</span></p></td>
<td class="cl-166c652a"><p class="cl-166c44be"><span class="cl-1664a5f6">3,232.0</span></p></td>
<td class="cl-166c652b"><p class="cl-166c44be"><span class="cl-1664a5f6">16.2</span></p></td>
<td class="cl-166c652c"><p class="cl-166c44b4"><span class="cl-1664a5f6">0.045</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-166c6534"><p class="cl-166c44b4"><span class="cl-1664a5f6">45+</span></p></td>
<td class="cl-166c6535"><p class="cl-166c44be"><span class="cl-1664a5f6">313</span></p></td>
<td class="cl-166c653e"><p class="cl-166c44be"><span class="cl-1664a5f6">10.9</span></p></td>
<td class="cl-166c653f"><p class="cl-166c44be"><span class="cl-1664a5f6">2,644.0</span></p></td>
<td class="cl-166c6548"><p class="cl-166c44be"><span class="cl-1664a5f6">13.2</span></p></td>
<td class="cl-166c6549"><p class="cl-166c44b4"><span class="cl-1664a5f6">&lt;0.001</span></p></td>
</tr>
</tbody>
</table>
</div></template><div class="flextable-shadow-host" id="96831d88-2f17-4dd4-a76b-6a073148509e"></div>
<script>
var dest = document.getElementById("96831d88-2f17-4dd4-a76b-6a073148509e");
var template = document.getElementById("1b30d45c-756d-4956-babe-720a27e85e8a");
var caption = template.content.querySelector("caption");
var fantome = dest.attachShadow({mode: 'open'});
var templateContent = template.content;
fantome.appendChild(templateContent);
</script><div class="sourceCode" id="cb47"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## compute the median age </span></span>
<span><span class="va">medage</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/median.html" class="external-link">median</a></span><span class="op">(</span><span class="va">study_data_cleaned</span><span class="op">$</span><span class="va">age_years</span><span class="op">)</span></span>
<span><span class="co">## paste the lower and upper quartile together</span></span>
<span><span class="va">iqr</span> <span class="op">&lt;-</span> <span class="fu">str_c</span><span class="op">(</span>  <span class="co"># basically copy paste together the following</span></span>
<span>  <span class="co">## calculate the 25% and 75% of distribution, with missings removed</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/quantile.html" class="external-link">quantile</a></span><span class="op">(</span>     </span>
<span>    <span class="va">study_data_cleaned</span><span class="op">$</span><span class="va">age_years</span>, </span>
<span>    probs <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.25</span>, <span class="fl">0.75</span><span class="op">)</span>, </span>
<span>    na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>, </span>
<span>  <span class="co">## between lower and upper place an en-dash</span></span>
<span>  collapse <span class="op">=</span> <span class="st">"--"</span><span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="co">## compute overall sex ratio </span></span>
<span><span class="va">sex_ratio</span> <span class="op">&lt;-</span> <span class="va">study_data_cleaned</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">count</span><span class="op">(</span><span class="va">sex</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">pivot_wider</span><span class="op">(</span>names_from <span class="op">=</span> <span class="va">sex</span>, values_from <span class="op">=</span> <span class="va">n</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">mutate</span><span class="op">(</span>ratio <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">Male</span><span class="op">/</span><span class="va">Female</span>, digits <span class="op">=</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">pull</span><span class="op">(</span><span class="va">ratio</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## compute sex ratios by age group </span></span>
<span><span class="va">sex_ratio_age</span> <span class="op">&lt;-</span> <span class="va">study_data_cleaned</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">count</span><span class="op">(</span><span class="va">age_group</span>, <span class="va">sex</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">pivot_wider</span><span class="op">(</span>names_from <span class="op">=</span> <span class="va">sex</span>, values_from <span class="op">=</span> <span class="va">n</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">mutate</span><span class="op">(</span>ratio <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">Male</span><span class="op">/</span><span class="va">Female</span>, digits <span class="op">=</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">select</span><span class="op">(</span><span class="va">age_group</span>, <span class="va">ratio</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## sort table by ascending ratio then select the lowest (first)</span></span>
<span><span class="va">min_sex_ratio_age</span> <span class="op">&lt;-</span> <span class="fu">arrange</span><span class="op">(</span><span class="va">sex_ratio_age</span>, <span class="va">ratio</span><span class="op">)</span> <span class="op">%&gt;%</span> <span class="fu">slice</span><span class="op">(</span><span class="fl">1</span><span class="op">)</span></span></code></pre></div>
<p>Pregnancy was not collected in this survey, so the next section is not relevant and should be commented out. Any of the dynamic text that refers to pregnancy should also be removed.</p>
<p>The paragraph will now look like this:</p>
<p>Among the 2874 surveyed individuals, there were 1475 (51.3%) females and 1399 (48.7%) males (unweighted). The male to female ratio was 0.9 in the surveyed population. The lowest male to female ratio was 0.9 in the 3-14 year age group. The median age of surveyed individuals was 15 years (Q1-Q3 of 6–30 years). Children under five years of age made up 560 (19.5%)of the surveyed individuals. The highest number of surveyed individuals (unweighted) were in the 3-14 year age group.</p>
<div class="sourceCode" id="cb48"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="co"># get cross tabulated counts and proportions</span></span>
<span><span class="va">study_data_cleaned</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">tbl_cross</span><span class="op">(</span> </span>
<span>    row <span class="op">=</span> <span class="va">age_group</span>, </span>
<span>    col <span class="op">=</span> <span class="va">sex</span>, </span>
<span>    percent <span class="op">=</span> <span class="st">"cell"</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="co">## make variable names bold </span></span>
<span>  <span class="fu">bold_labels</span><span class="op">(</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="co"># change to flextable format</span></span>
<span>  <span class="fu">as_flex_table</span><span class="op">(</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="co"># make header text bold (using {flextable})</span></span>
<span>  <span class="fu">bold</span><span class="op">(</span>part <span class="op">=</span> <span class="st">"header"</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="co"># make your table fit to the maximum width of the word document</span></span>
<span>  <span class="fu">set_table_properties</span><span class="op">(</span>layout <span class="op">=</span> <span class="st">"autofit"</span><span class="op">)</span></span></code></pre></div>
<template id="1f6fa9b9-764f-4e51-b130-2dee07b925bb"><style>
.tabwid table{
  border-spacing:0px !important;
  border-collapse:collapse;
  line-height:1;
  margin-left:auto;
  margin-right:auto;
  border-width: 0;
  display: table;
  border-color: transparent;
  caption-side: top;
}
.tabwid-caption-bottom table{
  caption-side: bottom;
}
.tabwid_left table{
  margin-left:0;
}
.tabwid_right table{
  margin-right:0;
}
.tabwid td {
    padding: 0;
}
.tabwid a {
  text-decoration: none;
}
.tabwid thead {
    background-color: transparent;
}
.tabwid tfoot {
    background-color: transparent;
}
.tabwid table tr {
background-color: transparent;
}
.katex-display {
    margin: 0 0 !important;
}
</style>
<div class="tabwid">
<style>.cl-18740986{table-layout:auto;}.cl-1866e6fc{font-family:'Helvetica';font-size:11pt;font-weight:bold;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-1866e706{font-family:'Helvetica';font-size:11pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-186cd3c8{margin:0;text-align:left;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:2pt;padding-top:2pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-186cd3d2{margin:0;text-align:center;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:2pt;padding-top:2pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-186cd3d3{margin:0;text-align:left;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-186cd3dc{margin:0;text-align:center;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-186cd3dd{margin:0;text-align:left;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:15pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-186cef66{background-color:transparent;vertical-align: middle;border-bottom: 1pt solid rgba(0, 0, 0, 1.00);border-top: 1pt solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-186cef70{background-color:transparent;vertical-align: middle;border-bottom: 1pt solid rgba(0, 0, 0, 1.00);border-top: 1pt solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-186cef7a{background-color:transparent;vertical-align: middle;border-bottom: 1pt solid rgba(0, 0, 0, 1.00);border-top: 1pt solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-186cef7b{background-color:transparent;vertical-align: middle;border-bottom: 1pt solid rgba(0, 0, 0, 1.00);border-top: 1pt solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-186cef84{background-color:transparent;vertical-align: middle;border-bottom: 1pt solid rgba(0, 0, 0, 1.00);border-top: 1pt solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-186cef85{background-color:transparent;vertical-align: middle;border-bottom: 1pt solid rgba(0, 0, 0, 1.00);border-top: 1pt solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-186cef86{background-color:transparent;vertical-align: top;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-186cef8e{background-color:transparent;vertical-align: top;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-186cef8f{background-color:transparent;vertical-align: top;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-186cef98{background-color:transparent;vertical-align: top;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-186cef99{background-color:transparent;vertical-align: top;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-186cefa2{background-color:transparent;vertical-align: top;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-186cefa3{background-color:transparent;vertical-align: top;border-bottom: 1pt solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-186cefac{background-color:transparent;vertical-align: top;border-bottom: 1pt solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-186cefb6{background-color:transparent;vertical-align: top;border-bottom: 1pt solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}</style>
<table class="table cl-18740986">
<thead>
<tr style="overflow-wrap:break-word;">
<td class="cl-186cef66"><p class="cl-186cd3c8"><span class="cl-1866e6fc"> </span></p></td>
<td colspan="2" class="cl-186cef70"><p class="cl-186cd3d2"><span class="cl-1866e6fc">sex</span></p></td>
<td class="cl-186cef7a"><p class="cl-186cd3d2"><span class="cl-1866e6fc"> </span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-186cef7b"><p class="cl-186cd3c8"><span class="cl-1866e6fc"></span></p></td>
<td class="cl-186cef84"><p class="cl-186cd3d2"><span class="cl-1866e6fc">Female</span></p></td>
<td class="cl-186cef84"><p class="cl-186cd3d2"><span class="cl-1866e6fc">Male</span></p></td>
<td class="cl-186cef85"><p class="cl-186cd3d2"><span class="cl-1866e6fc">Total</span></p></td>
</tr>
</thead>
<tbody>
<tr style="overflow-wrap:break-word;">
<td class="cl-186cef86"><p class="cl-186cd3d3"><span class="cl-1866e6fc">Age group (years)</span></p></td>
<td class="cl-186cef8e"><p class="cl-186cd3dc"><span class="cl-1866e706"></span></p></td>
<td class="cl-186cef8e"><p class="cl-186cd3dc"><span class="cl-1866e706"></span></p></td>
<td class="cl-186cef8f"><p class="cl-186cd3dc"><span class="cl-1866e706"></span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-186cef98"><p class="cl-186cd3dd"><span class="cl-1866e706">0-2</span></p></td>
<td class="cl-186cef99"><p class="cl-186cd3dc"><span class="cl-1866e706">149 (5.2%)</span></p></td>
<td class="cl-186cef99"><p class="cl-186cd3dc"><span class="cl-1866e706">146 (5.1%)</span></p></td>
<td class="cl-186cefa2"><p class="cl-186cd3dc"><span class="cl-1866e706">295 (10%)</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-186cef98"><p class="cl-186cd3dd"><span class="cl-1866e706">3-14</span></p></td>
<td class="cl-186cef99"><p class="cl-186cd3dc"><span class="cl-1866e706">588 (20%)</span></p></td>
<td class="cl-186cef99"><p class="cl-186cd3dc"><span class="cl-1866e706">530 (18%)</span></p></td>
<td class="cl-186cefa2"><p class="cl-186cd3dc"><span class="cl-1866e706">1,118 (39%)</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-186cef98"><p class="cl-186cd3dd"><span class="cl-1866e706">15-29</span></p></td>
<td class="cl-186cef99"><p class="cl-186cd3dc"><span class="cl-1866e706">355 (12%)</span></p></td>
<td class="cl-186cef99"><p class="cl-186cd3dc"><span class="cl-1866e706">368 (13%)</span></p></td>
<td class="cl-186cefa2"><p class="cl-186cd3dc"><span class="cl-1866e706">723 (25%)</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-186cef98"><p class="cl-186cd3dd"><span class="cl-1866e706">30-44</span></p></td>
<td class="cl-186cef99"><p class="cl-186cd3dc"><span class="cl-1866e706">229 (8.0%)</span></p></td>
<td class="cl-186cef99"><p class="cl-186cd3dc"><span class="cl-1866e706">196 (6.8%)</span></p></td>
<td class="cl-186cefa2"><p class="cl-186cd3dc"><span class="cl-1866e706">425 (15%)</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-186cef98"><p class="cl-186cd3dd"><span class="cl-1866e706">45+</span></p></td>
<td class="cl-186cef99"><p class="cl-186cd3dc"><span class="cl-1866e706">154 (5.4%)</span></p></td>
<td class="cl-186cef99"><p class="cl-186cd3dc"><span class="cl-1866e706">159 (5.5%)</span></p></td>
<td class="cl-186cefa2"><p class="cl-186cd3dc"><span class="cl-1866e706">313 (11%)</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-186cefa3"><p class="cl-186cd3d3"><span class="cl-1866e6fc">Total</span></p></td>
<td class="cl-186cefac"><p class="cl-186cd3dc"><span class="cl-1866e706">1,475 (51%)</span></p></td>
<td class="cl-186cefac"><p class="cl-186cd3dc"><span class="cl-1866e706">1,399 (49%)</span></p></td>
<td class="cl-186cefb6"><p class="cl-186cd3dc"><span class="cl-1866e706">2,874 (100%)</span></p></td>
</tr>
</tbody>
</table>
</div></template><div class="flextable-shadow-host" id="22725eab-bf71-4891-a7b8-1a8a49dad10c"></div>
<script>
var dest = document.getElementById("22725eab-bf71-4891-a7b8-1a8a49dad10c");
var template = document.getElementById("1f6fa9b9-764f-4e51-b130-2dee07b925bb");
var caption = template.content.querySelector("caption");
var fantome = dest.attachShadow({mode: 'open'});
var templateContent = template.content;
fantome.appendChild(templateContent);
</script><div class="sourceCode" id="cb49"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="co"># get cross tabulated counts and proportions</span></span>
<span><span class="va">study_data_cleaned</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">tbl_cross</span><span class="op">(</span> </span>
<span>    row <span class="op">=</span> <span class="va">age_category</span>, </span>
<span>    col <span class="op">=</span> <span class="va">sex</span>, </span>
<span>    percent <span class="op">=</span> <span class="st">"cell"</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="co">## make variable names bold </span></span>
<span>  <span class="fu">bold_labels</span><span class="op">(</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="co"># change to flextable format</span></span>
<span>  <span class="fu">as_flex_table</span><span class="op">(</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="co"># make header text bold (using {flextable})</span></span>
<span>  <span class="fu">bold</span><span class="op">(</span>part <span class="op">=</span> <span class="st">"header"</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="co"># make your table fit to the maximum width of the word document</span></span>
<span>  <span class="fu">set_table_properties</span><span class="op">(</span>layout <span class="op">=</span> <span class="st">"autofit"</span><span class="op">)</span></span></code></pre></div>
<template id="13795233-f567-417d-b33d-072a84b3a436"><style>
.tabwid table{
  border-spacing:0px !important;
  border-collapse:collapse;
  line-height:1;
  margin-left:auto;
  margin-right:auto;
  border-width: 0;
  display: table;
  border-color: transparent;
  caption-side: top;
}
.tabwid-caption-bottom table{
  caption-side: bottom;
}
.tabwid_left table{
  margin-left:0;
}
.tabwid_right table{
  margin-right:0;
}
.tabwid td {
    padding: 0;
}
.tabwid a {
  text-decoration: none;
}
.tabwid thead {
    background-color: transparent;
}
.tabwid tfoot {
    background-color: transparent;
}
.tabwid table tr {
background-color: transparent;
}
.katex-display {
    margin: 0 0 !important;
}
</style>
<div class="tabwid">
<style>.cl-1a958550{table-layout:auto;}.cl-1a83f6be{font-family:'Helvetica';font-size:11pt;font-weight:bold;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-1a83f6d2{font-family:'Helvetica';font-size:11pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-1a8d78d8{margin:0;text-align:left;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:2pt;padding-top:2pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-1a8d78e2{margin:0;text-align:center;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:2pt;padding-top:2pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-1a8d78ec{margin:0;text-align:left;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-1a8d78ed{margin:0;text-align:center;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-1a8d78f6{margin:0;text-align:left;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:15pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-1a8d95de{background-color:transparent;vertical-align: middle;border-bottom: 1pt solid rgba(0, 0, 0, 1.00);border-top: 1pt solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-1a8d95e8{background-color:transparent;vertical-align: middle;border-bottom: 1pt solid rgba(0, 0, 0, 1.00);border-top: 1pt solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-1a8d95e9{background-color:transparent;vertical-align: middle;border-bottom: 1pt solid rgba(0, 0, 0, 1.00);border-top: 1pt solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-1a8d95f2{background-color:transparent;vertical-align: middle;border-bottom: 1pt solid rgba(0, 0, 0, 1.00);border-top: 1pt solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-1a8d95fc{background-color:transparent;vertical-align: middle;border-bottom: 1pt solid rgba(0, 0, 0, 1.00);border-top: 1pt solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-1a8d95fd{background-color:transparent;vertical-align: middle;border-bottom: 1pt solid rgba(0, 0, 0, 1.00);border-top: 1pt solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-1a8d95fe{background-color:transparent;vertical-align: top;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-1a8d9606{background-color:transparent;vertical-align: top;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-1a8d9607{background-color:transparent;vertical-align: top;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-1a8d9608{background-color:transparent;vertical-align: top;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-1a8d9610{background-color:transparent;vertical-align: top;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-1a8d9611{background-color:transparent;vertical-align: top;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-1a8d961a{background-color:transparent;vertical-align: top;border-bottom: 1pt solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-1a8d961b{background-color:transparent;vertical-align: top;border-bottom: 1pt solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-1a8d961c{background-color:transparent;vertical-align: top;border-bottom: 1pt solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}</style>
<table class="table cl-1a958550">
<thead>
<tr style="overflow-wrap:break-word;">
<td class="cl-1a8d95de"><p class="cl-1a8d78d8"><span class="cl-1a83f6be"> </span></p></td>
<td colspan="2" class="cl-1a8d95e8"><p class="cl-1a8d78e2"><span class="cl-1a83f6be">sex</span></p></td>
<td class="cl-1a8d95e9"><p class="cl-1a8d78e2"><span class="cl-1a83f6be"> </span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-1a8d95f2"><p class="cl-1a8d78d8"><span class="cl-1a83f6be"></span></p></td>
<td class="cl-1a8d95fc"><p class="cl-1a8d78e2"><span class="cl-1a83f6be">Female</span></p></td>
<td class="cl-1a8d95fc"><p class="cl-1a8d78e2"><span class="cl-1a83f6be">Male</span></p></td>
<td class="cl-1a8d95fd"><p class="cl-1a8d78e2"><span class="cl-1a83f6be">Total</span></p></td>
</tr>
</thead>
<tbody>
<tr style="overflow-wrap:break-word;">
<td class="cl-1a8d95fe"><p class="cl-1a8d78ec"><span class="cl-1a83f6be">Age category</span></p></td>
<td class="cl-1a8d9606"><p class="cl-1a8d78ed"><span class="cl-1a83f6d2"></span></p></td>
<td class="cl-1a8d9606"><p class="cl-1a8d78ed"><span class="cl-1a83f6d2"></span></p></td>
<td class="cl-1a8d9607"><p class="cl-1a8d78ed"><span class="cl-1a83f6d2"></span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-1a8d9608"><p class="cl-1a8d78f6"><span class="cl-1a83f6d2">0-5 months</span></p></td>
<td class="cl-1a8d9610"><p class="cl-1a8d78ed"><span class="cl-1a83f6d2">23 (0.8%)</span></p></td>
<td class="cl-1a8d9610"><p class="cl-1a8d78ed"><span class="cl-1a83f6d2">24 (0.8%)</span></p></td>
<td class="cl-1a8d9611"><p class="cl-1a8d78ed"><span class="cl-1a83f6d2">47 (1.6%)</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-1a8d9608"><p class="cl-1a8d78f6"><span class="cl-1a83f6d2">6-8 months</span></p></td>
<td class="cl-1a8d9610"><p class="cl-1a8d78ed"><span class="cl-1a83f6d2">17 (0.6%)</span></p></td>
<td class="cl-1a8d9610"><p class="cl-1a8d78ed"><span class="cl-1a83f6d2">18 (0.6%)</span></p></td>
<td class="cl-1a8d9611"><p class="cl-1a8d78ed"><span class="cl-1a83f6d2">35 (1.2%)</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-1a8d9608"><p class="cl-1a8d78f6"><span class="cl-1a83f6d2">9-12 months</span></p></td>
<td class="cl-1a8d9610"><p class="cl-1a8d78ed"><span class="cl-1a83f6d2">19 (0.7%)</span></p></td>
<td class="cl-1a8d9610"><p class="cl-1a8d78ed"><span class="cl-1a83f6d2">17 (0.6%)</span></p></td>
<td class="cl-1a8d9611"><p class="cl-1a8d78ed"><span class="cl-1a83f6d2">36 (1.3%)</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-1a8d9608"><p class="cl-1a8d78f6"><span class="cl-1a83f6d2">0-2 years</span></p></td>
<td class="cl-1a8d9610"><p class="cl-1a8d78ed"><span class="cl-1a83f6d2">90 (3.1%)</span></p></td>
<td class="cl-1a8d9610"><p class="cl-1a8d78ed"><span class="cl-1a83f6d2">87 (3.0%)</span></p></td>
<td class="cl-1a8d9611"><p class="cl-1a8d78ed"><span class="cl-1a83f6d2">177 (6.2%)</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-1a8d9608"><p class="cl-1a8d78f6"><span class="cl-1a83f6d2">3-14 years</span></p></td>
<td class="cl-1a8d9610"><p class="cl-1a8d78ed"><span class="cl-1a83f6d2">588 (20%)</span></p></td>
<td class="cl-1a8d9610"><p class="cl-1a8d78ed"><span class="cl-1a83f6d2">530 (18%)</span></p></td>
<td class="cl-1a8d9611"><p class="cl-1a8d78ed"><span class="cl-1a83f6d2">1,118 (39%)</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-1a8d9608"><p class="cl-1a8d78f6"><span class="cl-1a83f6d2">15-29 years</span></p></td>
<td class="cl-1a8d9610"><p class="cl-1a8d78ed"><span class="cl-1a83f6d2">355 (12%)</span></p></td>
<td class="cl-1a8d9610"><p class="cl-1a8d78ed"><span class="cl-1a83f6d2">368 (13%)</span></p></td>
<td class="cl-1a8d9611"><p class="cl-1a8d78ed"><span class="cl-1a83f6d2">723 (25%)</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-1a8d9608"><p class="cl-1a8d78f6"><span class="cl-1a83f6d2">30-44 years</span></p></td>
<td class="cl-1a8d9610"><p class="cl-1a8d78ed"><span class="cl-1a83f6d2">229 (8.0%)</span></p></td>
<td class="cl-1a8d9610"><p class="cl-1a8d78ed"><span class="cl-1a83f6d2">196 (6.8%)</span></p></td>
<td class="cl-1a8d9611"><p class="cl-1a8d78ed"><span class="cl-1a83f6d2">425 (15%)</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-1a8d9608"><p class="cl-1a8d78f6"><span class="cl-1a83f6d2">45+ years</span></p></td>
<td class="cl-1a8d9610"><p class="cl-1a8d78ed"><span class="cl-1a83f6d2">154 (5.4%)</span></p></td>
<td class="cl-1a8d9610"><p class="cl-1a8d78ed"><span class="cl-1a83f6d2">159 (5.5%)</span></p></td>
<td class="cl-1a8d9611"><p class="cl-1a8d78ed"><span class="cl-1a83f6d2">313 (11%)</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-1a8d961a"><p class="cl-1a8d78ec"><span class="cl-1a83f6be">Total</span></p></td>
<td class="cl-1a8d961b"><p class="cl-1a8d78ed"><span class="cl-1a83f6d2">1,475 (51%)</span></p></td>
<td class="cl-1a8d961b"><p class="cl-1a8d78ed"><span class="cl-1a83f6d2">1,399 (49%)</span></p></td>
<td class="cl-1a8d961c"><p class="cl-1a8d78ed"><span class="cl-1a83f6d2">2,874 (100%)</span></p></td>
</tr>
</tbody>
</table>
</div></template><div class="flextable-shadow-host" id="1687906e-b64f-4314-9069-4bc5a820849e"></div>
<script>
var dest = document.getElementById("1687906e-b64f-4314-9069-4bc5a820849e");
var template = document.getElementById("13795233-f567-417d-b33d-072a84b3a436");
var caption = template.content.querySelector("caption");
var fantome = dest.attachShadow({mode: 'open'});
var templateContent = template.content;
fantome.appendChild(templateContent);
</script><div class="sourceCode" id="cb50"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="fu"><a href="../reference/apyramid.html">age_pyramid</a></span><span class="op">(</span><span class="va">study_data_cleaned</span>, </span>
<span>            <span class="va">age_group</span>, </span>
<span>            split_by <span class="op">=</span> <span class="va">sex</span>, </span>
<span>            proportional <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu">labs</span><span class="op">(</span>y <span class="op">=</span> <span class="st">"Proportion"</span>, x <span class="op">=</span> <span class="st">"Age group (years)"</span><span class="op">)</span> <span class="op">+</span>    <span class="co"># change axis labels</span></span>
<span>  <span class="fu">theme</span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"bottom"</span>,     <span class="co"># move legend to bottom</span></span>
<span>        legend.title <span class="op">=</span> <span class="fu">element_blank</span><span class="op">(</span><span class="op">)</span>, <span class="co"># remove title</span></span>
<span>        text <span class="op">=</span> <span class="fu">element_text</span><span class="op">(</span>size <span class="op">=</span> <span class="fl">18</span><span class="op">)</span>  <span class="co"># change text size</span></span>
<span>       <span class="op">)</span></span></code></pre></div>
<p><img src="Surveys_Walkthrough_files/figure-html/age_pyramid-1.png" width="576"></p>
<div class="sourceCode" id="cb51"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="fu"><a href="../reference/apyramid.html">age_pyramid</a></span><span class="op">(</span><span class="va">study_data_cleaned</span>, </span>
<span>                 <span class="va">age_group</span>, </span>
<span>                 split_by <span class="op">=</span> <span class="va">sex</span>,</span>
<span>                 stack_by <span class="op">=</span> <span class="va">health_district</span>,</span>
<span>                 proportional <span class="op">=</span> <span class="cn">TRUE</span>, </span>
<span>                 pal <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"red"</span>, <span class="st">"blue"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu">labs</span><span class="op">(</span>y <span class="op">=</span> <span class="st">"Proportion"</span>, x <span class="op">=</span> <span class="st">"Age group (years)"</span><span class="op">)</span> <span class="op">+</span>    <span class="co"># change axis labels</span></span>
<span>  <span class="fu">theme</span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"bottom"</span>,     <span class="co"># move legend to bottom</span></span>
<span>        legend.title <span class="op">=</span> <span class="fu">element_blank</span><span class="op">(</span><span class="op">)</span>, <span class="co"># remove title</span></span>
<span>        text <span class="op">=</span> <span class="fu">element_text</span><span class="op">(</span>size <span class="op">=</span> <span class="fl">18</span><span class="op">)</span>  <span class="co"># change text size</span></span>
<span>       <span class="op">)</span></span></code></pre></div>
<p><img src="Surveys_Walkthrough_files/figure-html/age_pyramid_strata-1.png" width="576"></p>
<div class="sourceCode" id="cb52"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="fu"><a href="../reference/apyramid.html">age_pyramid</a></span><span class="op">(</span><span class="va">survey_design</span>,</span>
<span>                 <span class="va">age_group</span>,</span>
<span>                 split_by <span class="op">=</span> <span class="va">sex</span>, </span>
<span>                 proportion <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">labs</span><span class="op">(</span>y <span class="op">=</span> <span class="st">"Proportion (weighted)"</span>, x <span class="op">=</span> <span class="st">"Age group (years)"</span><span class="op">)</span> <span class="op">+</span> <span class="co"># change axis labels</span></span>
<span>  <span class="fu">theme</span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"bottom"</span>,     <span class="co"># move legend to bottom</span></span>
<span>        legend.title <span class="op">=</span> <span class="fu">element_blank</span><span class="op">(</span><span class="op">)</span>, <span class="co"># remove title</span></span>
<span>        text <span class="op">=</span> <span class="fu">element_text</span><span class="op">(</span>size <span class="op">=</span> <span class="fl">18</span><span class="op">)</span>  <span class="co"># change text size</span></span>
<span>       <span class="op">)</span></span></code></pre></div>
<p><img src="Surveys_Walkthrough_files/figure-html/age_pyramid_survey-1.png" width="576"></p>
</div>
<div class="section level2">
<h2 id="mortality">Mortality<a class="anchor" aria-label="anchor" href="#mortality"></a>
</h2>
<div class="sourceCode" id="cb53"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="co">## weighted counts and proportion of dead</span></span>
<span><span class="va">death_props</span> <span class="op">&lt;-</span> <span class="va">survey_design</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">select</span><span class="op">(</span><span class="va">died</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">tbl_svysummary</span><span class="op">(</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="co">## add the weighted total</span></span>
<span>  <span class="fu">add_n</span><span class="op">(</span><span class="op">)</span> <span class="op">%&gt;%</span>   </span>
<span>  <span class="co">## add in confidence intervals</span></span>
<span>  </span>
<span>  <span class="co">## add in deff </span></span>
<span>  </span>
<span>  <span class="co">## modify the column headers</span></span>
<span>  <span class="fu">modify_header</span><span class="op">(</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>      <span class="va">n</span> <span class="op">~</span> <span class="st">"**Weighted total (N)**"</span>,</span>
<span>      <span class="va">stat_0</span> <span class="op">~</span> <span class="st">"**Weighted Count (n)**"</span></span>
<span>    <span class="op">)</span></span>
<span>    <span class="op">)</span></span>
<span></span>
<span><span class="co">## mortality per 10,000 persons/day with CI</span></span>
<span><span class="va">CMR</span> <span class="op">&lt;-</span> <span class="va">survey_design</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="co">## survey ratio used to account for observation time </span></span>
<span>  <span class="fu">summarize</span><span class="op">(</span>mortality <span class="op">=</span> <span class="fu">survey_ratio</span><span class="op">(</span><span class="va">died</span> <span class="op">*</span> <span class="fl">10000</span>, <span class="va">obstime</span>, vartype <span class="op">=</span> <span class="st">"ci"</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="co">## if negative CIs set to zero</span></span>
<span>  <span class="fu">mutate</span><span class="op">(</span>mortality_low <span class="op">=</span> <span class="fu">if_else</span><span class="op">(</span><span class="va">mortality_low</span> <span class="op">&lt;</span> <span class="fl">0</span>, <span class="fl">0</span>, <span class="va">mortality_low</span><span class="op">)</span>, </span>
<span>         mortality_upp <span class="op">=</span> <span class="fu">if_else</span><span class="op">(</span><span class="va">mortality_upp</span> <span class="op">&lt;</span> <span class="fl">0</span>, <span class="fl">0</span>, <span class="va">mortality_upp</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="co">## merge confidence intervals for mortality in to one column (do not change to percent)</span></span>
<span>  <span class="fu"><a href="../reference/epikit-exports.html">unite_ci</a></span><span class="op">(</span><span class="st">"Mortality"</span>, <span class="fu">starts_with</span><span class="op">(</span><span class="st">"mortality"</span><span class="op">)</span>, m100 <span class="op">=</span> <span class="cn">FALSE</span>, percent <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">pull</span><span class="op">(</span><span class="st">"Mortality"</span><span class="op">)</span></span></code></pre></div>
<p>And the paragraph will read as:</p>
<p>During the recall period the weighted number and proportion of deaths in the population was 542 (0.3%), with a weighted confidence interval of , and a design effect of . This is a crude mortality rate of 0.09 (0.03–0.16) deaths per 10000 person-days.</p>
<div class="sourceCode" id="cb54"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="co">## weighted counts and proportion of dead</span></span>
<span><span class="va">death_props_strat</span> <span class="op">&lt;-</span> <span class="va">survey_design</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">select</span><span class="op">(</span><span class="va">died</span>, <span class="va">health_district</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">tbl_svysummary</span><span class="op">(</span>by <span class="op">=</span> <span class="va">health_district</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="co">## add the weighted total</span></span>
<span>  <span class="fu">add_n</span><span class="op">(</span><span class="op">)</span> <span class="op">%&gt;%</span>   </span>
<span>  <span class="co">## add in confidence intervals</span></span>
<span></span>
<span>  <span class="co">## add in deff </span></span>
<span></span>
<span>  <span class="co">## modify the column headers</span></span>
<span>  <span class="fu">modify_header</span><span class="op">(</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>      <span class="va">n</span> <span class="op">~</span> <span class="st">"**Weighted total (N)**"</span>,</span>
<span>      <span class="va">stat_1</span> <span class="op">~</span> <span class="st">"**District A Weighted Count (n)** \n N={n}"</span>, </span>
<span>      <span class="va">stat_2</span> <span class="op">~</span> <span class="st">"**District B Weighted Count (n)** \n N={n}"</span> </span>
<span>    <span class="op">)</span></span>
<span>    <span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="co">## mortality per 10,000 persons/day with CI</span></span>
<span><span class="va">CMR_strat</span> <span class="op">&lt;-</span> <span class="va">survey_design</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">group_by</span><span class="op">(</span><span class="va">health_district</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="co">## survey ratio used to account for observation time </span></span>
<span>  <span class="fu">summarize</span><span class="op">(</span>mortality <span class="op">=</span> <span class="fu">survey_ratio</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="va">died</span><span class="op">)</span> <span class="op">*</span> <span class="fl">10000</span>, <span class="va">obstime</span>, vartype <span class="op">=</span> <span class="st">"ci"</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="co">## if negative CIs set to zero</span></span>
<span>  <span class="fu">mutate</span><span class="op">(</span>mortality_low <span class="op">=</span> <span class="fu">if_else</span><span class="op">(</span><span class="va">mortality_low</span> <span class="op">&lt;</span> <span class="fl">0</span>, <span class="fl">0</span>, <span class="va">mortality_low</span><span class="op">)</span>, </span>
<span>         mortality_upp <span class="op">=</span> <span class="fu">if_else</span><span class="op">(</span><span class="va">mortality_upp</span> <span class="op">&lt;</span> <span class="fl">0</span>, <span class="fl">0</span>, <span class="va">mortality_upp</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="co">## merge confidence intervals for mortality in to one column (do not change to percent)</span></span>
<span>  <span class="fu"><a href="../reference/epikit-exports.html">unite_ci</a></span><span class="op">(</span><span class="st">"Mortality"</span>, <span class="fu">starts_with</span><span class="op">(</span><span class="st">"mortality"</span><span class="op">)</span>, m100 <span class="op">=</span> <span class="cn">FALSE</span>, percent <span class="op">=</span> <span class="cn">FALSE</span>, digits <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span></code></pre></div>
<p>In District A the weighted number of deaths was 195 (0.2%), which gives a weighted proportion of , and a design effect of . In comparison, the weighted number of deaths in District B was 347 (0.4%), the weighted proportion was and the design effect was . The crude mortality rate in District A was 0.1 (0.0–0.1) deaths per 10000 person-days and in District B was 0.1 (0.0–0.2)</p>
<!-- # msf_dict_rename_helper() -->
<!-- # remove district for the stratified code, -->
<!-- # keep both as FALSE -->
<!-- # run all the analyses by age and sex -->
<!-- # (regular cluster survey) -->
<!-- # still weighting it like a stratefied cluster, but it probably is just cluster. -->
<!-- # in survey design chunk, just use stratefied cluster bc survey_design is what's used elsewhere -->
<!-- # counting per household how many people are in the house -->
<!-- # cl = dataset with populaton per cluster -->
<!-- # interviewed is how many people were interviewed in the hourse -->
<!-- # clusterx = tell which variables correspond -->
<!-- # the creating variables telling which are in each -->
<!-- # Include both hoursehold and cluster -->
<!-- # Docker -->
<!-- # build yourself a docker container and test locally -->
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Alexander Spina, Zhian N. Kamvar, Dirk Schumacher, Kate Doyle, Chris Jarvis, Lukas Richter.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.6.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
