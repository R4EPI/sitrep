<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Guide: Meningitis outbreak report • sitrep</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="48x48" href="../favicon-48x48.png">
<link rel="icon" type="”image/svg+xml”" href="../favicon.svg">
<link rel="apple-touch-icon" sizes="180x180" href="../apple-touch-icon.png">
<link rel="icon" sizes="any" href="../favicon.ico">
<link rel="manifest" href="../site.webmanifest">
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Guide: Meningitis outbreak report">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--><!-- Global site tag (gtag.js) - Google Analytics --><script async src="https://www.googletagmanager.com/gtag/js?id=UA-149766533-1"></script><script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-149766533-1');
</script>
</head>
<body data-spy="scroll" data-target="#toc">


    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">sitrep</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.4.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../r4epi.github.io/sitrep/">
    <span class="fas fa-home fa-lg"></span>

  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles

    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/ajs_intersectional_outbreak_guide.html">Guide: AJS outbreak report</a>
    </li>
    <li>
      <a href="../articles/Background.html">Origin Story</a>
    </li>
    <li>
      <a href="../articles/cholera_intersectional_outbreak_guide.html">Guide: Cholera outbreak report</a>
    </li>
    <li>
      <a href="../articles/diphtheria_intersectional_outbreak_guide.html">Guide: Diphtheria outbreak report</a>
    </li>
    <li>
      <a href="../articles/intersectional_outbreak_recode_guide.html">Guide: Intersectional Outbreak Data Recode</a>
    </li>
    <li>
      <a href="../articles/measles_intersectional_outbreak_guide.html">Guide: Measles outbreak report</a>
    </li>
    <li>
      <a href="../articles/meningitis_intersectional_outbreak_guide.html">Guide: Meningitis outbreak report</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/R4EPI/sitrep/" class="external-link">
    <span class="fab fa-github fa-lg"></span>

  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->



      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Guide: Meningitis outbreak report</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/R4EPI/sitrep/blob/master/vignettes/meningitis_intersectional_outbreak_guide.Rmd" class="external-link"><code>vignettes/meningitis_intersectional_outbreak_guide.Rmd</code></a></small>
      <div class="hidden name"><code>meningitis_intersectional_outbreak_guide.Rmd</code></div>

    </div>

    
    
<style>
  h1:not(.title) {
    background-color: #b4e1f0;
    border-radius: 5px;
  }
</style>
<p><em>This guide was written by Applied Epi. Feedback and suggestions
are welcome at the <a href="https://github.com/R4EPI/sitrep/issues/" class="external-link">GitHub issues
page</a></em></p>
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<div class="section level3">
<h3 id="purpose-of-this-guide">Purpose of this guide<a class="anchor" aria-label="anchor" href="#purpose-of-this-guide"></a>
</h3>
<p>This guide accompanies the <strong>Meningitis outbreak
report</strong> .Rmd file, which can be used to create an automated
outbreak report for meningitis.</p>
</div>
<div class="section level3">
<h3 id="who-this-guide-is-for">Who this guide is for<a class="anchor" aria-label="anchor" href="#who-this-guide-is-for"></a>
</h3>
<p>This guide and the sitrep code is intended for <strong>individuals
who already have some familiarity with R</strong> but want ready-made
code to make the report production process faster. You need to be able
to edit and troubleshoot code.</p>
</div>
<div class="section level3">
<h3 id="outbreak-report-contents">Outbreak report contents<a class="anchor" aria-label="anchor" href="#outbreak-report-contents"></a>
</h3>
<p>The report will contain basic information on person, place, and time,
specifically:</p>
<ul>
<li>An overall epi summary with bullet points and epicurve</li>
<li>Age and sex distribution</li>
<li>Symptoms and underlying conditions</li>
<li>Attack rates and case fatality ratios by age group and geographical
areas</li>
<li>Vaccination history</li>
<li>Test results</li>
<li>Outcomes</li>
<li>Test results</li>
<li>Maps and more detailed geographical breakdowns</li>
</ul>
</div>
</div>
<div class="section level2">
<h2 id="instructions">Instructions<a class="anchor" aria-label="anchor" href="#instructions"></a>
</h2>
<div class="section level3">
<h3 id="structure-of-the-outbreak-report-rmd">Structure of the outbreak report Rmd<a class="anchor" aria-label="anchor" href="#structure-of-the-outbreak-report-rmd"></a>
</h3>
<p>The outbreak report Rmd is split up into sections with chunks which
relate to:</p>
<ol style="list-style-type: decimal">
<li>Report set-up including package installation and setting
definitions</li>
<li>Importing data</li>
<li>Cleaning data including standardising categorical values, removing
illogical values, removing unnecessary rows and columns, and creating
columns needed for analysis</li>
<li>Analysis</li>
</ol>
<p>Only the outputs from the fourth section on analysis will be visible
in the report when rendering it.</p>
<p>Note there are comments throughout the Rmd file which refer to the
relevant sections in this guide. The comments look like this:</p>
<pre><code>&lt;!-- ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~   
Comments are shown in the code between these special lines  They will not appear in the report output   
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ --&gt;</code></pre>
</div>
<div class="section level3">
<h3 id="how-to-produce-the-report">How to produce the report<a class="anchor" aria-label="anchor" href="#how-to-produce-the-report"></a>
</h3>
<p>With the help of this guide (specifically section 3), you should
produce the report via the following steps:</p>
<ol style="list-style-type: decimal">
<li>
<strong>Go through the outbreak template .Rmd in detail and make
edits as needed</strong>. Make sure you <strong>run the code within
chunks and inspect the data as you go</strong>, to make sure you
correctly and appropriately edit the code. There are several sections
where code edits are required (highlighted in this guide in <span style="background-color:#FFC04D">yellow</span>) or expected (highlighted
in this guide in <span style="background-color:#c6f3a6">green</span>):
<ol style="list-style-type: upper-alpha">
<li>⚠️<span style="background-color:#FFC04D">Required:</span>
<strong>The YAML</strong>, to specify the title, location, MSF office,
and date of report.</li>
<li>⚠️<span style="background-color:#FFC04D">Required:</span>
<strong>The <code>definitions</code> chunk</strong>, to correctly define
the reporting date and other key objects. Make sure the date here
matches the one in the YAML.</li>
<li>⚠️<span style="background-color:#FFC04D">Required:</span>
<strong>The data import section</strong>, to import the correct
data</li>
<li>⚠️<span style="background-color:#FFC04D">Required:</span>
<strong>The recommendations chunk,</strong> to add text based on the
results.</li>
<li>⚠️<span style="background-color:#c6f3a6">Expected:</span>
<strong>The various data cleaning chunks</strong>, to ensure that data
is appropriate for the report.</li>
<li>⚠️<span style="background-color:#c6f3a6">Expected:</span>
<strong>The analysis chunks</strong>, to ensure the analysis or
presentation is appropriate for the data. In particular:
<ol style="list-style-type: lower-roman">
<li>Make sure you use the <strong>correct date for epicurves and other
temporal analyses</strong>. The default uses a column that prioritises
onset date if available and substitutes with notification date if onset
is not available. It may be more appropriate to use only onset date or
only notification date, depending on your data e.g. completeness and
reliability of both.</li>
<li>Ensure that <strong>missing values are correctly used.</strong> The
default is that “Unknown” or missing (NA) values are presented as
“[Missing]” in tables and are excluded from denominators.</li>
<li>Ensure the <strong>correct geography columns</strong> are being
used. The data has three levels (adm1, adm2, and adm3). By default, most
geographical breakdowns in this report (tables and maps) use adm2 level,
there is a detailed table for cases by adm3 level at the end, and adm1
is not used.</li>
<li>
<strong>Adjust the map legend</strong> as needed so that the
categories are appropriate (explained further in relevant section)</li>
<li>
<strong>Adjust other presentation features</strong>, such as column
widths in tables, the space between date labels in the epicurve x axis,
or the <code>fig.height</code> option in chunk labels to change the
height of figures.</li>
</ol>
</li>
</ol>
</li>
<li>
<strong>When you are happy with the Rmd code, click “knit” at the
top</strong>, which will produce the outbreak report.</li>
<li>
<strong>Take extra steps in MS Word to activate the table of
contents:</strong> When opening the produced word document, click “Yes”
in the popup asking “Do you want to update the fields in this
document?”. Then click on “Update Table…” at the top left of the table
of contents and update the page numbers, so that they accurately
represent the location of each section. See below:</li>
</ol>
<p><img src="images/toc_screenshot.png" style="width:85.0%"></p>
</div>
<div class="section level3">
<h3 id="requirements-for-report-generation">Requirements for report generation<a class="anchor" aria-label="anchor" href="#requirements-for-report-generation"></a>
</h3>
<p>You will need:</p>
<ul>
<li>A meningitis linelist, with the following requirements:
<ul>
<li>One row per case</li>
<li>Information on: sex, age, geographic location, date of notification,
symptom onset date, status of vaccination against <em>Neisseria</em>,
outcome, symptoms (vomiting, altered consciousness, purpura),
malnutrition, test results, and outcome.</li>
<li>Column names and categorical values that align with the MSF
intersectional linelist</li>
</ul>
</li>
<li>Population data for age groups and geographic areas of interest, if
you want to create the case rates per area.</li>
</ul>
<p><strong>If you need to change your data into this format, do so with
the outbreak report recode Rmd file first</strong></p>
</div>
</div>
<div class="section level2">
<h2 id="detailed-guide">Detailed guide<a class="anchor" aria-label="anchor" href="#detailed-guide"></a>
</h2>
<div style="background-color: #edf3f5;  border-radius: 5px;">
<div class="section level3">
<h3 id="yaml">YAML<a class="anchor" aria-label="anchor" href="#yaml"></a>
</h3>
<p>At the very top of the Rmd file, make sure you specify the following
by changing the “XXX” content within the quotations marks: - The title
(default is “meningitis outbreak report”) - The location/area that the
outbreak report concerns - The MSF office - The date of the report</p>
<p>Make sure you do not remove the quotation marks or make edits outside
of the quotation marks.</p>
</div>
<div class="section level3">
<h3 id="set-up-and-load-data">Set up and load data<a class="anchor" aria-label="anchor" href="#set-up-and-load-data"></a>
</h3>
<div class="section level4">
<h4 id="setup-chunk">
<code>setup</code> chunk<a class="anchor" aria-label="anchor" href="#setup-chunk"></a>
</h4>
<p>⚠️ <span style="background-color: #FFC04D;">You will need to edit
this chunk</span>.</p>
<p>This chunk first sets up key preferences for this R Markdown file, in
<code>opts_chunk$set()</code>. By default it is set to not show code, to
show errors, or warning messages in the output.</p>
<p>This chunk also installs/loads packages. Several packages are
required for different aspects of analysis with R. You will need to
install these before starting.</p>
</div>
<div class="section level4">
<h4 id="definitions-chunk">
<code>definitions</code> chunk<a class="anchor" aria-label="anchor" href="#definitions-chunk"></a>
</h4>
<p>⚠️ <span style="background-color: #FFC04D;">You will need to edit
this chunk</span>.</p>
<p>This chunk is for inputting information so that the report is suited
to this dataset.</p>
<ol style="list-style-type: decimal">
<li><p>Set what the three geographical objects
<code>adm1_residence_name</code>, <code>adm2_residence_name</code>,
<code>adm3_residence_name</code>, mean. For example, they may represent
the province, district, and village of each case respectively, but this
will differ depending on the data.</p></li>
<li>
<p>Set the date of the report, assuming the report is updated on a
weekly basis.</p>
<ol style="list-style-type: upper-alpha">
<li>Provide the actual date of report in YYYY-MM-DD format.</li>
<li>Edit the <code>yearweek</code> function if necessary, so that it
correctly defines the week that this sitrep is reporting on, e.g. “2024
W52”. The default argument for week start inside <code>yearweek</code>
is 1, which means it assumes reporting weeks start on Mondays. You can
change it to 2 for Tuesday, 3 for Wednesday etc.</li>
</ol>
</li>
</ol>
</div>
<div class="section level4">
<h4 id="set_plot_defaults-chunk">
<code>set_plot_defaults</code> chunk<a class="anchor" aria-label="anchor" href="#set_plot_defaults-chunk"></a>
</h4>
<p>This code set the defaults for epicurve plots, such as the base text
size, the text angle, legend title, gridline color (grey), and x and y
labels. It also standardises the labels of epicurves.</p>
</div>
</div>
<div class="section level3">
<h3 id="import-data">Import data<a class="anchor" aria-label="anchor" href="#import-data"></a>
</h3>
<div class="section level4">
<h4 id="read_population_data-chunk">
<code>read_population_data</code> chunk<a class="anchor" aria-label="anchor" href="#read_population_data-chunk"></a>
</h4>
<p>⚠️ <span style="background-color: #FFC04D;">You will need to edit
this chunk</span>.</p>
<p>This report template uses population data to calculate attack
rates.</p>
<p>This chunk creates two objects that are used later in the code:</p>
<ul>
<li><strong>population_data_age</strong></li>
<li>
<strong>population_data_adm2</strong> *</li>
</ul>
<p>For each object, there are three options to create these objects:</p>
<ol style="list-style-type: decimal">
<li>If you have files that contain denominator information, read them in
(note the code is reading in excel files as default)</li>
<li>If you have counts per subgroup, use the
<code>gen_population()</code> function from the <a href="https://github.com/R4EPI/sitrep/" class="external-link">sitrep</a>
package to combine into a table.</li>
<li>If you have the total populations and population distributions, use
the <code>gen_population()</code> function to generate sub-group
specific counts.</li>
</ol>
<p>Comment out or delete the options you are not using, and edit the one
you will use.</p>
<p>* Note this is for calculating rates for the adm2 level. If you need
rates for adm1 or adm3 geographic levels, load the relevant population
data in the appropriate way, and change the object name for clarity
(e.g. to <code>population_data_adm3</code>), or create an additional
appropriately named denominator data objects.</p>
</div>
<div class="section level4">
<h4 id="read_data-chunk">
<code>read_data</code> chunk<a class="anchor" aria-label="anchor" href="#read_data-chunk"></a>
</h4>
<p>⚠️ <span style="background-color: #FFC04D;">You will need to edit
this chunk</span>.</p>
<p>This chunk loads linelist data into RStudio. There are seven options
you can pick between to load data. Delete or comment out the code that
you do not need, and edit the code you do need by specifying the correct
file name and location:</p>
<ol style="list-style-type: decimal">
<li>Load an example clean linelist in intersectional data format using
the <code>gen_data()</code> function from the <a href="https://github.com/R4EPI/sitrep/" class="external-link">sitrep</a>
package. Do this if you want to see what the clean data should look
like, or if you want to test the outbreak template</li>
<li>Load data from an excel file within a specific sheet</li>
<li>Load data from an excel file with macros (this requires
read_excel)</li>
<li>Load data from an excel file with a particular range of cells</li>
<li>Load data from an excel file within a particular sheet but also with
a password. Note this needs the installation of some additional
packages</li>
<li>Load data from a csv file</li>
<li>Load data from a stata file</li>
</ol>
</div>
<div class="section level4">
<h4 id="browse_data-chunk">
<code>browse_data</code> chunk<a class="anchor" aria-label="anchor" href="#browse_data-chunk"></a>
</h4>
<p>You’ll want to look at your data.</p>
<p>This chunk shows you a few ways you can explore, including printing
out a table which shows all values in your columns (excluding the case
ID or health facility IDs which would be too many to tabulate) so that
you can identify non-standardised or incorrect values.</p>
<p>It is recommended you check other detail more comprehensively as
well.</p>
<p>Note that these tables will not be printed when you run the
report.</p>
</div>
</div>
<div class="section level3">
<h3 id="clean-linelist-data">Clean linelist data<a class="anchor" aria-label="anchor" href="#clean-linelist-data"></a>
</h3>
<p>All your cleaning and variable creation should happen in these
chunks:</p>
<table class="table">
<colgroup>
<col width="50%">
<col width="50%">
</colgroup>
<thead><tr class="header">
<th>Step</th>
<th>Description</th>
</tr></thead>
<tbody>
<tr class="odd">
<td><code>standardise_dates</code></td>
<td>Sets up and cleans dates, and creates new columns on reporting
weeks. This includes creating a <strong>new data_combined
column</strong> which prioritises onset date and uses notification date
if onset date is not available</td>
</tr>
<tr class="even">
<td><code>create_age_group</code></td>
<td>Creates the age group column from age (and some intermediary
columns). For meningitis, two age group columns are created for a choice
of table outputs in the analysis section</td>
</tr>
<tr class="odd">
<td><code>standardise_values</code></td>
<td>Cleans the values of categorical variables (e.g., typo correction)
and removes illogical values.</td>
</tr>
<tr class="even">
<td><code>create_vars</code></td>
<td>Creates additional columns based on other columns, and converts
categorical columns into ordered factors so that all values are
presented in the correct order in table outputs</td>
</tr>
<tr class="odd">
<td><code>duplicates</code></td>
<td>Removes duplicate rows.</td>
</tr>
<tr class="even">
<td><code>remove_unused_data</code></td>
<td>Removes rows (and columns) that are not required for analysis.</td>
</tr>
<tr class="odd">
<td><code>save_cleaned_data</code></td>
<td>Saves the clean data as a back-up.</td>
</tr>
</tbody>
</table>
<p>⚠️ <span style="background-color: #c6f3a6;">You will likely need to
edit some of these chunks</span>.</p>
<div class="section level4">
<h4 id="standardise_dates-chunk">
<code>standardise_dates</code> chunk<a class="anchor" aria-label="anchor" href="#standardise_dates-chunk"></a>
</h4>
<p>As the data should already be in the right format, you should not
need to change this section. If you have imported an RDS file, this code
might not be needed, but it will be useful for excel files and csv files
etc.</p>
<p>The code does the following:</p>
<ol style="list-style-type: decimal">
<li><p>Changes all columns starting with the word ‘date’ (i.e. the
<code>date_notification</code>, <code>date_symptom_start</code>, and
<code>date_hospitalisation_end</code> columns) to be recognised as dates
by R. The function <code>ymd</code> is used to recognise that the text
has dates written in the order of year, month, and day (e.g. 2025-02-01
or 2025 Feb 01 or 2025 February 1). ⚠️ <span style="background-color: #c6f3a6;">Change this if the dates are written
in a different way in your data</span>, e.g. to <code>dmy()</code> if
written in day, month, year (e.g. 01-02-2025 or 1 Feb 2025)</p></li>
<li><p>Fixes logical inconsistent dates: removed symptom onset dates if
they are after notification dates. ⚠️ <span style="background-color: #c6f3a6;">Inspect and edit data if you can, or
change the rule to fit the circumstances of your data</span></p></li>
<li><p>Creates a new date column, <code>date_combined</code>, to
maximise date completeness, by using the <code>coalesce()</code>
function that prioritises symptom onset date, and substitutes with
notification date if onset date is not available. It also creates a
<code>date_source</code> column to label if the value in the
<code>date_combined</code> column is the onset date or the notification
date.</p></li>
<li>
<p>Creates six new week columns:</p>
<ul>
<li>
<code>epiweek_symptom_start_num</code>,
<code>epiweek_notification_num</code>, and
<code>epiweek_combined_num</code>: These are week representations of the
onset date, notification date, and <code>date_combined</code> columns,
and are represented with the year and the week number, e.g. “2025 W10”.
It uses the <code>yearweek</code> function in which you state which day
the week starts (default 1 for Monday). These are not the default
columns used in epicurves but these can be switched to.</li>
</ul>
</li>
</ol>
<ul>
<li>
<code>epiweek_symptom_start</code>,
<code>epiweek_notification</code>, and <code>epiweek_combined</code>:
This will create corresponding columns with the date representing the
start of the week, e.g. “2025-03-03”. Note the selected date will depend
on the start day provided in the <code>yearweek</code> function.</li>
</ul>
</div>
<div class="section level4">
<h4 id="create_age_group-chunk">
<code>create_age_group</code> chunk<a class="anchor" aria-label="anchor" href="#create_age_group-chunk"></a>
</h4>
<p>This chunk creates a categorical variable for age groups, as
typically analysed for the disease.</p>
</div>
<div class="section level4">
<h4 id="standardise_values-chunk">
<code>standardise_values</code> chunk<a class="anchor" aria-label="anchor" href="#standardise_values-chunk"></a>
</h4>
<p>Edit the code as needed to make sure values are standardised and
correct. The checks you did in the <code>browse_data</code> chunk will
inform this section.</p>
<p>Two examples are provided to start with:</p>
<ul>
<li>Correct geographical values: The template shows the correction of
the adm2_residence column, first by standardizing the capitalization,
and then specifying which typos should be corrected to which
values.</li>
<li>Changing all “Unknown” and “” values to NA (recognised as missing by
R), across all character columns. This is so that these values are not
included in the denominator for analyses looking at percentage
distributions. ⚠️<span style="background-color: #c6f3a6;">Consider
changing or removing this if you want to handle unknown values
differently</span>
</li>
</ul>
<p>This template does not include code for all possible errors as this
will depend on your data, so you may need to write your own code/consult
someone who can write code in R to make sure your linelist data is fully
ready for analysis.</p>
</div>
<div class="section level4">
<h4 id="create_vars-chunk">
<code>create_vars</code> chunk<a class="anchor" aria-label="anchor" href="#create_vars-chunk"></a>
</h4>
<p>This chunk creates other columns used in analysis, and converts
categorical columns into a factor class so that all categories are
displayed in the correct order in tables later in the analysis. You can
edit this section for more columns.</p>
<p>New columns are:</p>
<ul>
<li>
<code>died</code>: binary (TRUE/FALSE) column labeling if a case
died or not.</li>
</ul>
<p>These columns are changed into factors. <strong>Note that values not
specified as valid categories in the code will be converted to
NA</strong>:</p>
<ul>
<li><code>patient_origin_status</code></li>
<li><code>malnut_adm</code></li>
<li><code>malaria_rdt</code></li>
<li><code>vacci_status_nm</code></li>
<li><code>vacci_card_nm</code></li>
<li><code>latex_result</code></li>
<li><code>culture_result</code></li>
<li><code>pcr_result</code></li>
<li><code>outcome</code></li>
<li><code>date_source</code></li>
</ul>
<p>Because both <code>culture_result</code> and <code>pcr_result</code>
have the same categories, the list of possible categories is defined
separately in an object <code>levels_culture</code>. This object is then
used for converting both columns into a factor class.</p>
</div>
<div class="section level4">
<h4 id="duplicates-chunk">
<code>duplicates</code> chunk<a class="anchor" aria-label="anchor" href="#duplicates-chunk"></a>
</h4>
<p>This chunk removes duplicate cases, presenting two options. You can
edit to use whichever unique identifiers you think relevant.</p>
<ul>
<li>Option 1 simply keeps the first occurrence of a duplicated case
based on case_number, sex and age_group. In the default template, the
deduplication removes repeat rows for an individual with the same
case_id, sex_id, and age_group.</li>
<li>Option 2 gives you the ability to create a TRUE/FALSE variable to
flag rows that are duplicated - giving you more flexibility around
browsing which ones to drop.</li>
</ul>
</div>
<div class="section level4">
<h4 id="remove_unused_data-chunk">
<code>remove_unused_data</code> chunk<a class="anchor" aria-label="anchor" href="#remove_unused_data-chunk"></a>
</h4>
<p>This step filters out data that are not appropriate to include in the
analysis, for instance:</p>
<ul>
<li><p>Data with onset after the reporting week: This removes cases that
are not feasible for this report</p></li>
<li><p>Other ineligible/anomalous data: E.g. you might want to remove
rows with missing essential data. Use this section to make other edits
as needed (please do not change column names or formats).</p></li>
</ul>
</div>
<div class="section level4">
<h4 id="save_cleaned_data-chunk">
<code>save_cleaned_data</code> chunk<a class="anchor" aria-label="anchor" href="#save_cleaned_data-chunk"></a>
</h4>
<p>You can save your cleaned dataset as an RDS to keep the correct
class/format for all columns. The template code automatically names your
file “linelist_cleaned_DATE”, where DATE is the current date. Uncomment
this code to use it.</p>
</div>
</div>
<div class="section level3">
<h3 id="analysis">Analysis<a class="anchor" aria-label="anchor" href="#analysis"></a>
</h3>
<div class="section level4">
<h4 id="recommendations-text">Recommendations text<a class="anchor" aria-label="anchor" href="#recommendations-text"></a>
</h4>
<p>⚠️ <span style="background-color: #FFC04D;">You will need to edit
this section either in the code or final output</span>.</p>
<p>This is a placeholder section for you to add comments in consultation
with the appropriate team/expertise.</p>
</div>
<div class="section level4">
<h4 id="summary-text">Summary text<a class="anchor" aria-label="anchor" href="#summary-text"></a>
</h4>
<p>At the start of the epi description, there are some short bullet
points describing the number of cases and key epi points.</p>
<p>⚠️ <span style="background-color: #FFC04D;">Make edits as needed,
particularly on the laboratory-confirmation</span>.</p>
</div>
<div class="section level4">
<h4 id="epicurve-chunk">
<code>epicurve</code> chunk<a class="anchor" aria-label="anchor" href="#epicurve-chunk"></a>
</h4>
<p>This chunk starts by creating the objects <code>all_weeks</code> and
<code>all_weeks_date</code> with all weeks, spanning from the earliest
<code>epiweek_combined</code> value to the <code>reporting_date</code>.
This is used across epicurves in this report to define the range in the
x axis.</p>
<p>Then the epicurve is created using the coalesced column
<code>epiweek_combined</code>. The source of the date is indicated by
the fill colour of the bars, based on the <code>date_source</code>
column. Note that the title of this epicurve specifies onset date, so
this analysis and code assumes that the <code>epiweek_combined</code>
column is indeed mostly onset date and only sometimes approximated by
notification date. ⚠️ <span style="background-color: #c6f3a6;">Change
the week column used if not appropriate</span>, e.g. if there is high
missingness in onset date.</p>
<p>Change the <code>fig.height</code> chunk option for smaller or larger
figures, and change the <code>breaks</code> argument in the
<code>scale_x_date()</code> function to specify the time difference
between the x axis date labels. For example, you can specify
<code>breaks = "1 week"</code> or <code>breaks = "2 months"</code>.</p>
</div>
<div class="section level4">
<h4 id="age-and-sex-distribution">Age and sex distribution<a class="anchor" aria-label="anchor" href="#age-and-sex-distribution"></a>
</h4>
<p>This section produces:</p>
<ul>
<li>Bullet points at the top to summarise key points about age and sex
distribution</li>
<li>In the <code>total_props_agegroup_sex</code> chunk, a table showing
age distribution overall and by sex</li>
<li>In the <code>age_pyramid</code> chunk: a age-sex pyramids using the
<code>age_pyramid()</code> function, which produces a ggplot object so
can be further edited with <a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a> code if needed (e.g
themes, labels, and scales).</li>
</ul>
</div>
<div class="section level4">
<h4 id="symptoms-and-malnutrition">Symptoms and malnutrition<a class="anchor" aria-label="anchor" href="#symptoms-and-malnutrition"></a>
</h4>
<p>This section produces, in the <code>symptoms</code> chunk, a table
showing the distribution of cases with fever, neck stiffness, vomiting,
altered consciousness, and purpura, as well as the distribution of
malnutrition - overall and by age group. Note that the symptom columns
are binary (Yes/No), so the function <code>tbl_summary()</code> only
shows the percentage of “Yes” responses (and the number of missing
values excluded from the denominator, if there are any).</p>
<p>⚠️ <span style="background-color: #c6f3a6;">You may need to adjust
the code if the unknown/missing values should be included in the
denominator</span>. If so, you can change the cleaning code in the
<code>standardise_values</code> chunk to not change “Unknown” to missing
(NA).</p>
</div>
<div class="section level4">
<h4 id="combined-count-attack-rate-and-case-fatality-ratio-tables">Combined count, attack rate, and case fatality ratio tables<a class="anchor" aria-label="anchor" href="#combined-count-attack-rate-and-case-fatality-ratio-tables"></a>
</h4>
<p>This section calculates total case counts, cases in the last 14 days
(calculated for the 14 days prior to reporting date), deaths, and the
CFR. Both attack rate tables link to the populations table imported or
produced in the <code>read_population_data</code> chunk.</p>
<ul>
<li>The <code>attack_rate_by_agegroup</code> chunk creates a table by
broad age group using the <code>age_group</code> column</li>
<li>The <code>attack_rate_by_adm2</code> chunk creates a table by unique
value for <code>adm2_residence</code>.</li>
</ul>
</div>
<div class="section level4">
<h4 id="vaccination-laboratory-results-and-outcomes">Vaccination, laboratory results, and outcomes<a class="anchor" aria-label="anchor" href="#vaccination-laboratory-results-and-outcomes"></a>
</h4>
<p>Across four chunks, four tables are created with
<code>tbl_summary()</code> on vaccine history, laboratory results, and
outcomes. They use the same formatting as all other
<code>tbl_summary()</code> outputs.</p>
</div>
<div class="section level4">
<h4 id="geographic-distribution---tables">Geographic distribution - tables<a class="anchor" aria-label="anchor" href="#geographic-distribution---tables"></a>
</h4>
<p>Two chunks produce the following:</p>
<ul>
<li>
<code>describe_by_adm2</code> chunk: A table with geographical
breakdowns, for the adm2 level, by age group.</li>
<li>
<code>epicurve_by_adm2</code> chunk: This epicurve uses the same
code as the first main epicurve, with the addition of a
<code>facet_wrap()</code> function to split the code into several mini
plots per <code>adm2</code> value. You may want to edit the figure
height and width within the chunk so that it fits on the page. As with
the main epicurve, you may also want to make sure you use the right week
column, as this analysis and code assumes that the
<code>epiweek_combined</code> column is mostly onset date and only
sometimes approximated by notification date. ⚠️ <span style="background-color: #c6f3a6;">Change the week column used if not
appropriate</span>, e.g. if there is high missingness in onset
date.</li>
</ul>
<p>Note that the meaning of adm2, e.g. District vs Region, should be set
in the <code>definitions</code> chunk so that the titles and labels
within these tables and figures are correct.</p>
</div>
<div class="section level4">
<h4 id="geographic-distribution---maps">Geographic distribution - maps<a class="anchor" aria-label="anchor" href="#geographic-distribution---maps"></a>
</h4>
<p>The report produces three maps to show:</p>
<ul>
<li>Attack rates by adm2</li>
<li>Total cases by adm2</li>
<li>Cases in last 14 days by adm2</li>
</ul>
<p>The map production is split up into several chunks:</p>
<ul>
<li>
<code>read_shapefiles</code>: To create maps, you need to have a
shapefile of the area (note that a shapefile typically consists of
several files, of which one ends in .shp). This chunk gives you the
option of generating a fake shape file with the <code>gen_polygon</code>
function. Otherwise, you can read in the shapefile. Often, the MSF GIS
unit can provide shapefiles and advice on how to use them.Your shapefile
can be a polygon or points. Polygons do not need to be contiguous. The
names of the polygons or points MUST match the names in your linelist.
Finally, your coordinate reference system needs to be WGS84.</li>
<li>
<code>chloropleth_map_prep</code>: This chunk builds on the detailed
attack rate table produced in the <code>attack_rate_by_adm2</code>
chunk, by converting counts and attack rates into categories suitable
for mapping. The <code>find_breaks()</code> function is used to
dynamically define the boundaries of the groupings. Edit the
<code>breaks = X</code> and <code>snap = X</code> argument to change how
many and how wide the subgroups are. For example, if there are 5000
total cases, you may want four categories (X=4) that snap to the closest
500 (snap=500, for example for categories 0, 1-1000, 1001-2000,
2001-3000, and 3001+). This chunk also links to the <code>map</code>
object created in the <code>read_shapefiles</code> chunk to bring in the
geometries for mapping. ⚠️ <span style="background-color: #c6f3a6;">You
will likely need to edit this chunk to change the categories that appear
on the map/legend</span>.</li>
<li>
<code>chloropleth_map</code> chunks: Three chunks create one map
each.</li>
</ul>
</div>
<div class="section level4">
<h4 id="geographic-detail">Geographic detail<a class="anchor" aria-label="anchor" href="#geographic-detail"></a>
</h4>
<p>The <code>describe_by_adm2_adm3</code> chunk creates a table showing
the distribution of cases by adm2 and adm3. It has the potential to be a
long table so it is at the end of the report.</p>
<p>The meanings of adm2 and adm3 are set at the top in the
<code>definitions</code> chunk, which as default are sets to mean
<strong>district</strong> and <strong>area</strong> respectively. Go
back and change this chunk if the table titles are incorrect.</p>
</div>
</div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

      </div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Alexander Spina, Zhian N. Kamvar, Dirk Schumacher, Kate Doyle, Chris Jarvis, Lukas Richter, Paula Blomquist, Medecins Sans Frontieres Operational Centre Amsterdam.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

      </footer>
</div>






  </body>
</html>
